{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/screener/ScreenerFilter.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Slider } from '@/components/ui/slider'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport { Badge } from '@/components/ui/badge'\nimport { X, Filter, ChevronDown, ChevronUp } from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { useScreenerStore } from '@/stores/screenerStore'\nimport type { ScreenerRequest } from '@/lib/types/screener'\n\nconst MARKET_CAP_RANGES = [\n  { label: 'Micro Cap (<$300M)', min: 0, max: 300000000 },\n  { label: 'Small Cap ($300M-$2B)', min: 300000000, max: 2000000000 },\n  { label: 'Mid Cap ($2B-$10B)', min: 2000000000, max: 10000000000 },\n  { label: 'Large Cap ($10B-$200B)', min: 10000000000, max: 200000000000 },\n  { label: 'Mega Cap (>$200B)', min: 200000000000, max: Infinity },\n]\n\nconst PRESETS = [\n  { key: 'high_dividend', name: 'High Dividend', description: 'Yield > 4%, Cap > $1B' },\n  { key: 'growth_stocks', name: 'Growth Stocks', description: 'P/E < 30, Cap > $500M' },\n  { key: 'value_stocks', name: 'Value Stocks', description: 'P/E < 15, P/B < 1.5' },\n  { key: 'momentum', name: 'Momentum', description: 'RSI < 30, Above 50-day MA' },\n  { key: 'small_cap_growth', name: 'Small Cap Growth', description: 'Cap $100M-$2B' },\n]\n\ninterface FilterSectionProps {\n  title: string\n  children: React.ReactNode\n  defaultOpen?: boolean\n}\n\nfunction FilterSection({ title, children, defaultOpen = true }: FilterSectionProps) {\n  const [isOpen, setIsOpen] = useState(defaultOpen)\n\n  return (\n    <div className=\"border-b pb-4 last:border-0\">\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"flex items-center justify-between w-full py-2 text-left font-semibold hover:text-primary transition-colors\"\n      >\n        <span>{title}</span>\n        {isOpen ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n      </button>\n      {isOpen && <div className=\"pt-2 space-y-3\">{children}</div>}\n    </div>\n  )\n}\n\nexport function ScreenerFilter() {\n  const {\n    filters,\n    setFilter,\n    removeFilter,\n    clearFilters,\n    runScreener,\n    loading,\n    selected_presets,\n  } = useScreenerStore()\n\n  const [localFilters, setLocalFilters] = useState<Partial<ScreenerRequest>>(filters)\n\n  const updateFilter = useCallback((key: keyof ScreenerRequest, value: any) => {\n    setLocalFilters((prev) => ({ ...prev, [key]: value }))\n  }, [])\n\n  const applyFilters = useCallback(() => {\n    Object.entries(localFilters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        setFilter(key as keyof ScreenerRequest, value)\n      }\n    })\n    runScreener()\n  }, [localFilters, setFilter, runScreener])\n\n  const activeFilterCount = Object.values(filters).filter(\n    (v) => v !== undefined && v !== null && v !== ''\n  ).length\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Filter className=\"w-4 h-4\" />\n              Filters\n              {activeFilterCount > 0 && (\n                <Badge variant=\"secondary\">{activeFilterCount}</Badge>\n              )}\n            </CardTitle>\n            <CardDescription>Screen stocks by criteria</CardDescription>\n          </div>\n          <Button variant=\"ghost\" size=\"sm\" onClick={clearFilters}>\n            Clear All\n          </Button>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4 overflow-y-auto max-h-[calc(100vh-200px)]\">\n        {/* Quick Presets */}\n        <div>\n          <Label className=\"text-sm font-semibold mb-2 block\">Quick Presets</Label>\n          <div className=\"flex flex-wrap gap-2\">\n            {PRESETS.map((preset) => (\n              <Badge\n                key={preset.key}\n                variant={selected_presets.includes(preset.key) ? 'default' : 'outline'}\n                className=\"cursor-pointer hover:opacity-80 transition-opacity\"\n                title={preset.description}\n              >\n                {preset.name}\n              </Badge>\n            ))}\n          </div>\n        </div>\n\n        {/* Market Cap */}\n        <FilterSection title=\"Market Cap\">\n          <div className=\"space-y-2\">\n            <div className=\"flex gap-2\">\n              <Input\n                type=\"number\"\n                placeholder=\"Min\"\n                value={localFilters.market_cap_min || ''}\n                onChange={(e) => updateFilter('market_cap_min', e.target.value ? Number(e.target.value) : undefined)}\n                aria-label=\"Minimum market cap\"\n              />\n              <Input\n                type=\"number\"\n                placeholder=\"Max\"\n                value={localFilters.market_cap_max || ''}\n                onChange={(e) => updateFilter('market_cap_max', e.target.value ? Number(e.target.value) : undefined)}\n                aria-label=\"Maximum market cap\"\n              />\n            </div>\n            <div className=\"flex flex-wrap gap-1\">\n              {MARKET_CAP_RANGES.slice(0, 3).map((range) => (\n                <Button\n                  key={range.label}\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"h-7 text-xs\"\n                  onClick={() => {\n                    updateFilter('market_cap_min', range.min)\n                    updateFilter('market_cap_max', range.max)\n                  }}\n                >\n                  {range.label.split('(')[0].trim()}\n                </Button>\n              ))}\n            </div>\n          </div>\n        </FilterSection>\n\n        {/* Price */}\n        <FilterSection title=\"Price\">\n          <div className=\"flex gap-2\">\n            <Input\n              type=\"number\"\n              placeholder=\"Min\"\n              value={localFilters.price_min || ''}\n              onChange={(e) => updateFilter('price_min', e.target.value ? Number(e.target.value) : undefined)}\n              aria-label=\"Minimum price\"\n            />\n            <Input\n              type=\"number\"\n              placeholder=\"Max\"\n              value={localFilters.price_max || ''}\n              onChange={(e) => updateFilter('price_max', e.target.value ? Number(e.target.value) : undefined)}\n              aria-label=\"Maximum price\"\n            />\n          </div>\n        </FilterSection>\n\n        {/* Volume */}\n        <FilterSection title=\"Volume\">\n          <div className=\"space-y-2\">\n            <div className=\"flex gap-2\">\n              <Input\n                type=\"number\"\n                placeholder=\"Min Volume\"\n                value={localFilters.volume_min || ''}\n                onChange={(e) => updateFilter('volume_min', e.target.value ? Number(e.target.value) : undefined)}\n              />\n              <Input\n                type=\"number\"\n                placeholder=\"Avg Volume\"\n                value={localFilters.volume_avg_min || ''}\n                onChange={(e) => updateFilter('volume_avg_min', e.target.value ? Number(e.target.value) : undefined)}\n              />\n            </div>\n          </div>\n        </FilterSection>\n\n        {/* Valuation */}\n        <FilterSection title=\"Valuation (P/E)\">\n          <div className=\"flex gap-2\">\n            <Input\n              type=\"number\"\n              placeholder=\"Min P/E\"\n              value={localFilters.pe_min || ''}\n              onChange={(e) => updateFilter('pe_min', e.target.value ? Number(e.target.value) : undefined)}\n            />\n            <Input\n              type=\"number\"\n              placeholder=\"Max P/E\"\n              value={localFilters.pe_max || ''}\n              onChange={(e) => updateFilter('pe_max', e.target.value ? Number(e.target.value) : undefined)}\n            />\n          </div>\n        </FilterSection>\n\n        {/* P/B Ratio */}\n        <FilterSection title=\"P/B Ratio\">\n          <div className=\"flex gap-2\">\n            <Input\n              type=\"number\"\n              placeholder=\"Min P/B\"\n              value={localFilters.pb_min || ''}\n              onChange={(e) => updateFilter('pb_min', e.target.value ? Number(e.target.value) : undefined)}\n            />\n            <Input\n              type=\"number\"\n              placeholder=\"Max P/B\"\n              value={localFilters.pb_max || ''}\n              onChange={(e) => updateFilter('pb_max', e.target.value ? Number(e.target.value) : undefined)}\n            />\n          </div>\n        </FilterSection>\n\n        {/* Dividend Yield */}\n        <FilterSection title=\"Dividend Yield\">\n          <div className=\"space-y-2\">\n            <Label>Minimum Yield: {localFilters.dividend_yield_min || 0}%</Label>\n            <Slider\n              value={[localFilters.dividend_yield_min || 0]}\n              onValueChange={([value]) => updateFilter('dividend_yield_min', value)}\n              max={10}\n              step={0.5}\n              className=\"w-full\"\n            />\n            <div className=\"flex justify-between text-xs text-muted-foreground\">\n              <span>0%</span>\n              <span>5%</span>\n              <span>10%</span>\n            </div>\n          </div>\n        </FilterSection>\n\n        {/* Technical Indicators */}\n        <FilterSection title=\"Technical Indicators\" defaultOpen={false}>\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <Label>RSI Range</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  type=\"number\"\n                  placeholder=\"Min\"\n                  min={0}\n                  max={100}\n                  value={localFilters.rsi_min || ''}\n                  onChange={(e) => updateFilter('rsi_min', e.target.value ? Number(e.target.value) : undefined)}\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"Max\"\n                  min={0}\n                  max={100}\n                  value={localFilters.rsi_max || ''}\n                  onChange={(e) => updateFilter('rsi_max', e.target.value ? Number(e.target.value) : undefined)}\n                />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id=\"above_ma_20\"\n                  checked={localFilters.above_ma_20 || false}\n                  onCheckedChange={(checked) => updateFilter('above_ma_20', checked)}\n                />\n                <Label htmlFor=\"above_ma_20\" className=\"text-sm cursor-pointer\">\n                  Above 20-day MA\n                </Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id=\"above_ma_50\"\n                  checked={localFilters.above_ma_50 || false}\n                  onCheckedChange={(checked) => updateFilter('above_ma_50', checked)}\n                />\n                <Label htmlFor=\"above_ma_50\" className=\"text-sm cursor-pointer\">\n                  Above 50-day MA\n                </Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id=\"above_ma_200\"\n                  checked={localFilters.above_ma_200 || false}\n                  onCheckedChange={(checked) => updateFilter('above_ma_200', checked)}\n                />\n                <Label htmlFor=\"above_ma_200\" className=\"text-sm cursor-pointer\">\n                  Above 200-day MA\n                </Label>\n              </div>\n            </div>\n          </div>\n        </FilterSection>\n\n        {/* Sector */}\n        <FilterSection title=\"Sector\" defaultOpen={false}>\n          <Input\n            placeholder=\"Enter sector...\"\n            value={localFilters.sector || ''}\n            onChange={(e) => updateFilter('sector', e.target.value)}\n          />\n        </FilterSection>\n\n        {/* Apply Button */}\n        <div className=\"pt-4 space-y-2\">\n          <Button onClick={applyFilters} className=\"w-full\" disabled={loading}>\n            {loading ? 'Screening...' : 'Apply Filters'}\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 762, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/screener/ScreenerResults.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport { Badge } from '@/components/ui/badge'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport {\n  ArrowUpDown,\n  ArrowUp,\n  ArrowDown,\n  Download,\n  ExternalLink,\n  TrendingUp,\n  TrendingDown,\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { formatCurrency, formatNumber } from '@/lib/utils/formatters'\nimport { useScreenerStore } from '@/stores/screenerStore'\nimport type { ScreenerResult, SortField, SortDirection } from '@/lib/types/screener'\n\ninterface SortButtonProps {\n  label: string\n  field: SortField\n  currentField: SortField\n  direction: SortDirection\n  onSort: (field: SortField, direction: SortDirection) => void\n}\n\nfunction SortButton({ label, field, currentField, direction, onSort }: SortButtonProps) {\n  const isActive = currentField === field\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"sm\"\n      className={cn('h-8 px-2 font-normal', isActive && 'bg-muted')}\n      onClick={() => onSort(field, isActive && direction === 'asc' ? 'desc' : 'asc')}\n    >\n      {label}\n      {isActive && direction === 'asc' && <ArrowUp className=\"ml-1 w-3 h-3\" />}\n      {isActive && direction === 'desc' && <ArrowDown className=\"ml-1 w-3 h-3\" />}\n      {!isActive && <ArrowUpDown className=\"ml-1 w-3 h-3 opacity-50\" />}\n    </Button>\n  )\n}\n\nexport function ScreenerResults() {\n  const {\n    results,\n    loading,\n    error,\n    total_count,\n    total_screened,\n    elapsed_seconds,\n    last_updated,\n    sort_field,\n    sort_direction,\n    setSorting,\n    exportResults,\n    limit,\n  } = useScreenerStore()\n\n  const [selectedRow, setSelectedRow] = useState<string | null>(null)\n\n  const sortedResults = useMemo(() => {\n    if (!results || results.length === 0) return []\n\n    return [...results].sort((a, b) => {\n      const aValue = a[sort_field]\n      const bValue = b[sort_field]\n\n      if (aValue === undefined || aValue === null) return 1\n      if (bValue === undefined || bValue === null) return -1\n\n      if (typeof aValue === 'string' && typeof bValue === 'string') {\n        return direction === 'asc' \n          ? aValue.localeCompare(bValue)\n          : bValue.localeCompare(aValue)\n      }\n\n      if (typeof aValue === 'number' && typeof bValue === 'number') {\n        return direction === 'asc' ? aValue - bValue : bValue - aValue\n      }\n\n      return 0\n    })\n  }, [results, sort_field, sort_direction])\n\n  const direction = sort_direction\n\n  if (loading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader>\n          <Skeleton className=\"h-6 w-32\" />\n          <Skeleton className=\"h-4 w-48\" />\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-2\">\n            {[1, 2, 3, 4, 5].map((i) => (\n              <Skeleton key={i} className=\"h-12 w-full\" />\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (error) {\n    return (\n      <Card className=\"h-full\">\n        <CardContent className=\"flex items-center justify-center h-full\">\n          <div className=\"text-center text-destructive\">\n            <p className=\"font-semibold\">Error loading results</p>\n            <p className=\"text-sm\">{error}</p>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (results.length === 0) {\n    return (\n      <Card className=\"h-full\">\n        <CardContent className=\"flex items-center justify-center h-full\">\n          <div className=\"text-center text-muted-foreground\">\n            <p className=\"font-semibold\">No results found</p>\n            <p className=\"text-sm\">Try adjusting your filters</p>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card className=\"h-full flex flex-col\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle>Screener Results</CardTitle>\n            <CardDescription>\n              {total_count} results found from {total_screened} screened\n              {elapsed_seconds > 0 && ` (${elapsed_seconds}s)`}\n            </CardDescription>\n          </div>\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"outline\" size=\"sm\">\n                <Download className=\"w-4 h-4 mr-2\" />\n                Export\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\">\n              <DropdownMenuItem onClick={() => exportResults('csv')}>\n                Export as CSV\n              </DropdownMenuItem>\n              <DropdownMenuItem onClick={() => exportResults('json')}>\n                Export as JSON\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n      </CardHeader>\n      <CardContent className=\"flex-1 overflow-auto\">\n        <div className=\"rounded-md border\">\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-muted/50\">\n                <TableHead className=\"w-[100px]\">\n                  <SortButton\n                    label=\"Symbol\"\n                    field=\"symbol\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead>\n                  <SortButton\n                    label=\"Name\"\n                    field=\"name\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-right\">\n                  <SortButton\n                    label=\"Price\"\n                    field=\"current_price\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-right\">\n                  <SortButton\n                    label=\"Change\"\n                    field=\"change_percent\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-right\">\n                  <SortButton\n                    label=\"Volume\"\n                    field=\"volume\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-right\">\n                  <SortButton\n                    label=\"Market Cap\"\n                    field=\"market_cap\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-right\">\n                  <SortButton\n                    label=\"P/E\"\n                    field=\"pe_ratio\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-right\">\n                  <SortButton\n                    label=\"Div Yield\"\n                    field=\"dividend_yield\"\n                    currentField={sort_field}\n                    direction={direction}\n                    onSort={setSorting}\n                  />\n                </TableHead>\n                <TableHead className=\"text-center\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {sortedResults.map((result) => (\n                <TableRow\n                  key={result.id}\n                  className={cn(\n                    'cursor-pointer transition-colors',\n                    selectedRow === result.id && 'bg-muted'\n                  )}\n                  onClick={() => setSelectedRow(selectedRow === result.id ? null : result.id)}\n                >\n                  <TableCell className=\"font-medium\">\n                    {result.symbol}\n                  </TableCell>\n                  <TableCell className=\"max-w-[200px] truncate\" title={result.name}>\n                    {result.name}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {formatCurrency(result.current_price)}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className={cn(\n                      'flex items-center justify-end gap-1',\n                      result.change_percent >= 0 ? 'text-green-600' : 'text-red-600'\n                    )}>\n                      {result.change_percent >= 0 ? (\n                        <TrendingUp className=\"w-3 h-3\" />\n                      ) : (\n                        <TrendingDown className=\"w-3 h-3\" />\n                      )}\n                      {result.change_percent?.toFixed(2)}%\n                    </div>\n                  </TableCell>\n                  <TableCell className=\"text-right text-muted-foreground\">\n                    {formatNumber(result.volume)}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {formatCurrency(result.market_cap / 1000000, 0)}M\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {result.pe_ratio !== undefined && result.pe_ratio !== null\n                      ? result.pe_ratio.toFixed(2)\n                      : '-'}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {result.dividend_yield !== undefined && result.dividend_yield !== null\n                      ? `${result.dividend_yield.toFixed(2)}%`\n                      : '-'}\n                  </TableCell>\n                  <TableCell className=\"text-center\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"h-8 w-8 p-0\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        window.open(`/assets/${result.symbol}`, '_blank')\n                      }}\n                    >\n                      <ExternalLink className=\"w-3 h-3\" />\n                    </Button>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </div>\n        \n        {results.length >= limit && (\n          <div className=\"mt-4 text-center text-sm text-muted-foreground\">\n            Showing {limit} of {total_count} results. Adjust filters to see more.\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1453, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/screener/PresetList.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { Plus, Trash2, Edit2, Upload, FolderOpen, Loader2 } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog'\nimport { useScreenerPresets } from '@/stores/screenerPresetsStore'\nimport { useScreenerStore } from '@/stores/screenerStore'\nimport type { UserScreenerPreset, ScreenerRequest } from '@/lib/types/screener'\n\nfunction formatDate(dateString: string): string {\n  const date = new Date(dateString)\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffMins = Math.floor(diffMs / 60000)\n  const diffHours = Math.floor(diffMs / 3600000)\n  const diffDays = Math.floor(diffMs / 86400000)\n\n  if (diffMins < 1) return 'Just now'\n  if (diffMins < 60) return `${diffMins}m ago`\n  if (diffHours < 24) return `${diffHours}h ago`\n  if (diffDays < 7) return `${diffDays}d ago`\n  return date.toLocaleDateString()\n}\n\nfunction countFilters(filters: Partial<ScreenerRequest>): number {\n  return Object.values(filters).filter(\n    (v) => v !== undefined && v !== null && v !== ''\n  ).length\n}\n\ninterface SavePresetDialogProps {\n  onSave?: () => void\n}\n\nfunction SavePresetDialog({ onSave }: SavePresetDialogProps) {\n  const [open, setOpen] = useState(false)\n  const [name, setName] = useState('')\n  const { savePreset, loading, error } = useScreenerPresets()\n  const { filters } = useScreenerStore()\n\n  const handleSave = async () => {\n    if (!name.trim()) return\n    try {\n      await savePreset(name.trim(), filters)\n      setOpen(false)\n      setName('')\n      onSave?.()\n    } catch (e) {\n      // Error is handled by the store\n    }\n  }\n\n  const filterCount = countFilters(filters)\n  const isValid = name.trim() && filterCount > 0\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Save Preset\n        </Button>\n      </DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Save Screener Preset</DialogTitle>\n          <DialogDescription>\n            Save your current filter criteria as a named preset for quick access later.\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <label className=\"text-sm font-medium\">Preset Name</label>\n            <Input\n              placeholder=\"e.g., Tech Growth Stocks\"\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              disabled={loading}\n            />\n          </div>\n          {error && (\n            <p className=\"text-sm text-destructive\">{error}</p>\n          )}\n          {filterCount > 0 ? (\n            <p className=\"text-sm text-muted-foreground\">\n              This preset will save {filterCount} filter{filterCount !== 1 ? 's' : ''}.\n            </p>\n          ) : (\n            <p className=\"text-sm text-muted-foreground\">\n              No filters applied. Add some filters before saving.\n            </p>\n          )}\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={loading}>\n            Cancel\n          </Button>\n          <Button onClick={handleSave} disabled={!isValid || loading}>\n            {loading ? (\n              <>\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              'Save Preset'\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\ninterface RenamePresetDialogProps {\n  preset: UserScreenerPreset\n  onRename?: () => void\n}\n\nfunction RenamePresetDialog({ preset, onRename }: RenamePresetDialogProps) {\n  const [open, setOpen] = useState(false)\n  const [name, setName] = useState(preset.name)\n  const { updatePreset, loading, error } = useScreenerPresets()\n\n  const handleRename = async () => {\n    if (!name.trim() || name.trim() === preset.name) {\n      setOpen(false)\n      return\n    }\n    try {\n      await updatePreset(preset.id, { name: name.trim() })\n      setOpen(false)\n      onRename?.()\n    } catch (e) {\n      // Error is handled by the store\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\n          <Edit2 className=\"h-4 w-4\" />\n        </Button>\n      </DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Rename Preset</DialogTitle>\n          <DialogDescription>\n            Give your preset a new name.\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <Input\n            placeholder=\"Preset name\"\n            value={name}\n            onChange={(e) => setName(e.target.value)}\n            disabled={loading}\n          />\n          {error && (\n            <p className=\"text-sm text-destructive\">{error}</p>\n          )}\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={loading}>\n            Cancel\n          </Button>\n          <Button onClick={handleRename} disabled={!name.trim() || loading}>\n            {loading ? (\n              <>\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              'Rename'\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\ninterface PresetListProps {\n  onSelectPreset?: (filters: Partial<ScreenerRequest>) => void\n}\n\nexport function PresetList({ onSelectPreset }: PresetListProps) {\n  const { presets, loading, fetchPresets, deletePreset } = useScreenerPresets()\n  const { filters, applyPreset } = useScreenerStore()\n  const [deletingId, setDeletingId] = useState<string | null>(null)\n\n  const handleLoadPreset = (preset: UserScreenerPreset) => {\n    applyPreset({\n      key: preset.id,\n      name: preset.name,\n      description: '',\n      filters: preset.filters,\n    })\n    onSelectPreset?.(preset.filters)\n  }\n\n  const handleDeletePreset = async (id: string) => {\n    if (confirm('Are you sure you want to delete this preset?')) {\n      setDeletingId(id)\n      try {\n        await deletePreset(id)\n      } finally {\n        setDeletingId(null)\n      }\n    }\n  }\n\n  // Fetch presets on mount\n  const hasFetched = presets.length > 0 || !loading\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg\">Saved Screeners</CardTitle>\n          <SavePresetDialog onSave={fetchPresets} />\n        </div>\n      </CardHeader>\n      <CardContent>\n        {loading && !hasFetched ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n          </div>\n        ) : presets.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <FolderOpen className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n            <p className=\"text-sm\">No saved presets</p>\n            <p className=\"text-xs mt-1\">\n              Save your current filters as a preset for quick access\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {presets.map((preset) => (\n              <div\n                key={preset.id}\n                className=\"flex items-center justify-between p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors\"\n              >\n                <div className=\"flex-1 min-w-0 mr-3\">\n                  <p className=\"font-medium truncate\">{preset.name}</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {countFilters(preset.filters)} filters â€¢ {formatDate(preset.updated_at)}\n                  </p>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleLoadPreset(preset)}\n                    disabled={deletingId === preset.id}\n                  >\n                    <Upload className=\"h-4 w-4 mr-1\" />\n                    Load\n                  </Button>\n                  <RenamePresetDialog preset={preset} onRename={fetchPresets} />\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-8 w-8 text-destructive hover:text-destructive\"\n                    onClick={() => handleDeletePreset(preset.id)}\n                    disabled={deletingId === preset.id}\n                  >\n                    {deletingId === preset.id ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <Trash2 className=\"h-4 w-4\" />\n                    )}\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AASA;AACA;AAjBA;;;;;;;;;;AAoBA,SAAS,WAAW,UAAkB;IACpC,MAAM,OAAO,IAAI,KAAK;IACtB,MAAM,MAAM,IAAI;IAChB,MAAM,SAAS,IAAI,OAAO,KAAK,KAAK,OAAO;IAC3C,MAAM,WAAW,KAAK,KAAK,CAAC,SAAS;IACrC,MAAM,YAAY,KAAK,KAAK,CAAC,SAAS;IACtC,MAAM,WAAW,KAAK,KAAK,CAAC,SAAS;IAErC,IAAI,WAAW,GAAG,OAAO;IACzB,IAAI,WAAW,IAAI,OAAO,GAAG,SAAS,KAAK,CAAC;IAC5C,IAAI,YAAY,IAAI,OAAO,GAAG,UAAU,KAAK,CAAC;IAC9C,IAAI,WAAW,GAAG,OAAO,GAAG,SAAS,KAAK,CAAC;IAC3C,OAAO,KAAK,kBAAkB;AAChC;AAEA,SAAS,aAAa,OAAiC;IACrD,OAAO,OAAO,MAAM,CAAC,SAAS,MAAM,CAClC,CAAC,IAAM,MAAM,aAAa,MAAM,QAAQ,MAAM,IAC9C,MAAM;AACV;AAMA,SAAS,iBAAiB,EAAE,MAAM,EAAyB;IACzD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qOAAQ,EAAC;IACjC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qOAAQ,EAAC;IACjC,MAAM,EAAE,UAAU,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,IAAA,+KAAkB;IACzD,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,sKAAgB;IAEpC,MAAM,aAAa;QACjB,IAAI,CAAC,KAAK,IAAI,IAAI;QAClB,IAAI;YACF,MAAM,WAAW,KAAK,IAAI,IAAI;YAC9B,QAAQ;YACR,QAAQ;YACR;QACF,EAAE,OAAO,GAAG;QACV,gCAAgC;QAClC;IACF;IAEA,MAAM,cAAc,aAAa;IACjC,MAAM,UAAU,KAAK,IAAI,MAAM,cAAc;IAE7C,qBACE,kQAAC,gKAAM;QAAC,MAAM;QAAM,cAAc;;0BAChC,kQAAC,uKAAa;gBAAC,OAAO;0BACpB,cAAA,kQAAC,gKAAM;oBAAC,SAAQ;oBAAU,MAAK;;sCAC7B,kQAAC,qOAAI;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;;;;;;0BAIrC,kQAAC,uKAAa;;kCACZ,kQAAC,sKAAY;;0CACX,kQAAC,qKAAW;0CAAC;;;;;;0CACb,kQAAC,2KAAiB;0CAAC;;;;;;;;;;;;kCAIrB,kQAAC;wBAAI,WAAU;;0CACb,kQAAC;gCAAI,WAAU;;kDACb,kQAAC;wCAAM,WAAU;kDAAsB;;;;;;kDACvC,kQAAC,8JAAK;wCACJ,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;wCACvC,UAAU;;;;;;;;;;;;4BAGb,uBACC,kQAAC;gCAAE,WAAU;0CAA4B;;;;;;4BAE1C,cAAc,kBACb,kQAAC;gCAAE,WAAU;;oCAAgC;oCACpB;oCAAY;oCAAQ,gBAAgB,IAAI,MAAM;oCAAG;;;;;;qDAG1E,kQAAC;gCAAE,WAAU;0CAAgC;;;;;;;;;;;;kCAKjD,kQAAC,sKAAY;;0CACX,kQAAC,gKAAM;gCAAC,SAAQ;gCAAU,SAAS,IAAM,QAAQ;gCAAQ,UAAU;0CAAS;;;;;;0CAG5E,kQAAC,gKAAM;gCAAC,SAAS;gCAAY,UAAU,CAAC,WAAW;0CAChD,wBACC;;sDACE,kQAAC,uPAAO;4CAAC,WAAU;;;;;;wCAA8B;;mDAInD;;;;;;;;;;;;;;;;;;;;;;;;AAOd;AAOA,SAAS,mBAAmB,EAAE,MAAM,EAAE,QAAQ,EAA2B;IACvE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qOAAQ,EAAC;IACjC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qOAAQ,EAAC,OAAO,IAAI;IAC5C,MAAM,EAAE,YAAY,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,IAAA,+KAAkB;IAE3D,MAAM,eAAe;QACnB,IAAI,CAAC,KAAK,IAAI,MAAM,KAAK,IAAI,OAAO,OAAO,IAAI,EAAE;YAC/C,QAAQ;YACR;QACF;QACA,IAAI;YACF,MAAM,aAAa,OAAO,EAAE,EAAE;gBAAE,MAAM,KAAK,IAAI;YAAG;YAClD,QAAQ;YACR;QACF,EAAE,OAAO,GAAG;QACV,gCAAgC;QAClC;IACF;IAEA,qBACE,kQAAC,gKAAM;QAAC,MAAM;QAAM,cAAc;;0BAChC,kQAAC,uKAAa;gBAAC,OAAO;0BACpB,cAAA,kQAAC,gKAAM;oBAAC,SAAQ;oBAAQ,MAAK;oBAAO,WAAU;8BAC5C,cAAA,kQAAC,sOAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGrB,kQAAC,uKAAa;;kCACZ,kQAAC,sKAAY;;0CACX,kQAAC,qKAAW;0CAAC;;;;;;0CACb,kQAAC,2KAAiB;0CAAC;;;;;;;;;;;;kCAIrB,kQAAC;wBAAI,WAAU;;0CACb,kQAAC,8JAAK;gCACJ,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gCACvC,UAAU;;;;;;4BAEX,uBACC,kQAAC;gCAAE,WAAU;0CAA4B;;;;;;;;;;;;kCAG7C,kQAAC,sKAAY;;0CACX,kQAAC,gKAAM;gCAAC,SAAQ;gCAAU,SAAS,IAAM,QAAQ;gCAAQ,UAAU;0CAAS;;;;;;0CAG5E,kQAAC,gKAAM;gCAAC,SAAS;gCAAc,UAAU,CAAC,KAAK,IAAI,MAAM;0CACtD,wBACC;;sDACE,kQAAC,uPAAO;4CAAC,WAAU;;;;;;wCAA8B;;mDAInD;;;;;;;;;;;;;;;;;;;;;;;;AAOd;AAMO,SAAS,WAAW,EAAE,cAAc,EAAmB;IAC5D,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,IAAA,+KAAkB;IAC3E,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,GAAG,IAAA,sKAAgB;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,qOAAQ,EAAgB;IAE5D,MAAM,mBAAmB,CAAC;QACxB,YAAY;YACV,KAAK,OAAO,EAAE;YACd,MAAM,OAAO,IAAI;YACjB,aAAa;YACb,SAAS,OAAO,OAAO;QACzB;QACA,iBAAiB,OAAO,OAAO;IACjC;IAEA,MAAM,qBAAqB,OAAO;QAChC,IAAI,QAAQ,iDAAiD;YAC3D,cAAc;YACd,IAAI;gBACF,MAAM,aAAa;YACrB,SAAU;gBACR,cAAc;YAChB;QACF;IACF;IAEA,yBAAyB;IACzB,MAAM,aAAa,QAAQ,MAAM,GAAG,KAAK,CAAC;IAE1C,qBACE,kQAAC,4JAAI;;0BACH,kQAAC,kKAAU;gBAAC,WAAU;0BACpB,cAAA,kQAAC;oBAAI,WAAU;;sCACb,kQAAC,iKAAS;4BAAC,WAAU;sCAAU;;;;;;sCAC/B,kQAAC;4BAAiB,QAAQ;;;;;;;;;;;;;;;;;0BAG9B,kQAAC,mKAAW;0BACT,WAAW,CAAC,2BACX,kQAAC;oBAAI,WAAU;8BACb,cAAA,kQAAC,uPAAO;wBAAC,WAAU;;;;;;;;;;2BAEnB,QAAQ,MAAM,KAAK,kBACrB,kQAAC;oBAAI,WAAU;;sCACb,kQAAC,2PAAU;4BAAC,WAAU;;;;;;sCACtB,kQAAC;4BAAE,WAAU;sCAAU;;;;;;sCACvB,kQAAC;4BAAE,WAAU;sCAAe;;;;;;;;;;;yCAK9B,kQAAC;oBAAI,WAAU;8BACZ,QAAQ,GAAG,CAAC,CAAC,uBACZ,kQAAC;4BAEC,WAAU;;8CAEV,kQAAC;oCAAI,WAAU;;sDACb,kQAAC;4CAAE,WAAU;sDAAwB,OAAO,IAAI;;;;;;sDAChD,kQAAC;4CAAE,WAAU;;gDACV,aAAa,OAAO,OAAO;gDAAE;gDAAY,WAAW,OAAO,UAAU;;;;;;;;;;;;;8CAG1E,kQAAC;oCAAI,WAAU;;sDACb,kQAAC,gKAAM;4CACL,SAAQ;4CACR,MAAK;4CACL,SAAS,IAAM,iBAAiB;4CAChC,UAAU,eAAe,OAAO,EAAE;;8DAElC,kQAAC,2OAAM;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGrC,kQAAC;4CAAmB,QAAQ;4CAAQ,UAAU;;;;;;sDAC9C,kQAAC,gKAAM;4CACL,SAAQ;4CACR,MAAK;4CACL,WAAU;4CACV,SAAS,IAAM,mBAAmB,OAAO,EAAE;4CAC3C,UAAU,eAAe,OAAO,EAAE;sDAEjC,eAAe,OAAO,EAAE,iBACvB,kQAAC,uPAAO;gDAAC,WAAU;;;;;qEAEnB,kQAAC,+OAAM;gDAAC,WAAU;;;;;;;;;;;;;;;;;;2BA9BnB,OAAO,EAAE;;;;;;;;;;;;;;;;;;;;;AAyC9B"}}]
}