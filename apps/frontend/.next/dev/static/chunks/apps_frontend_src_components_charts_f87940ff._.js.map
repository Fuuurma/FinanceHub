{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/TechnicalIndicatorsPanel.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useRef, useMemo } from 'react'\nimport {\n  createChart,\n  IChartApi,\n  ColorType,\n  Time,\n  LineSeries,\n  HistogramSeries,\n} from 'lightweight-charts'\nimport { useTheme } from 'next-themes'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip'\nimport { HelpCircle, TrendingUp, TrendingDown, Minus, Info } from 'lucide-react'\nimport type { OHLCVData } from '@/components/charts/TradingViewChart'\nimport {\n  calculateRSI,\n  calculateMACD,\n  formatIndicatorValue,\n  getRSISignal,\n  getMACDSignal,\n  INDICATOR_DESCRIPTIONS,\n} from '@/lib/utils/technical-indicators'\n\ninterface TechnicalIndicatorsPanelProps {\n  data: OHLCVData[]\n  showRSI?: boolean\n  showMACD?: boolean\n  rsiPeriod?: number\n  rsiOverbought?: number\n  rsiOversold?: number\n  macdFast?: number\n  macdSlow?: number\n  macdSignal?: number\n  height?: number\n  onIndicatorValueChange?: (indicator: string, value: number | null) => void\n}\n\nexport function TechnicalIndicatorsPanel({\n  data,\n  showRSI = true,\n  showMACD = true,\n  rsiPeriod = 14,\n  rsiOverbought = 70,\n  rsiOversold = 30,\n  macdFast = 12,\n  macdSlow = 26,\n  macdSignal = 9,\n  height = 200,\n  onIndicatorValueChange,\n}: TechnicalIndicatorsPanelProps) {\n  const rsiContainerRef = useRef<HTMLDivElement>(null)\n  const macdContainerRef = useRef<HTMLDivElement>(null)\n  const rsiChartRef = useRef<IChartApi | null>(null)\n  const macdChartRef = useRef<IChartApi | null>(null)\n  const { theme } = useTheme()\n\n  const isDark = theme === 'dark'\n\n  const chartColors = useMemo(() => ({\n    background: isDark ? '#0f172a' : '#ffffff',\n    text: isDark ? '#94a3b8' : '#64748b',\n    grid: isDark ? '#1e293b' : '#e2e8f0',\n    upColor: '#22c55e',\n    downColor: '#ef4444',\n    macdColor: '#3b82f6',\n    signalColor: '#f59e0b',\n    histogramUp: 'rgba(34, 197, 94, 0.5)',\n    histogramDown: 'rgba(239, 68, 68, 0.5)',\n    overbought: '#ef4444',\n    oversold: '#22c55e',\n    middle: isDark ? '#64748b' : '#9ca3af',\n  }), [isDark])\n\n  const closes = data.map(d => d.close)\n  const times = data.map(d => d.date as Time)\n\n  const rsiData = useMemo(() => calculateRSI(closes, rsiPeriod), [closes, rsiPeriod])\n  const macdData = useMemo(\n    () => calculateMACD(closes, macdFast, macdSlow, macdSignal),\n    [closes, macdFast, macdSlow, macdSignal]\n  )\n\n  const latestRSI = rsiData[rsiData.length - 1]\n  const latestMACD = macdData.macd[macdData.macd.length - 1]\n  const latestSignal = macdData.signal[macdData.signal.length - 1]\n\n  useEffect(() => {\n    if (!showRSI || !rsiContainerRef.current || !data.length) return\n\n    if (rsiChartRef.current) {\n      rsiChartRef.current.remove()\n    }\n\n    const chart = createChart(rsiContainerRef.current, {\n      width: rsiContainerRef.current.clientWidth,\n      height: height - 40,\n      layout: {\n        background: { type: ColorType.Solid, color: chartColors.background },\n        textColor: chartColors.text,\n      },\n      grid: {\n        vertLines: { color: chartColors.grid, style: 2 },\n        horzLines: { color: chartColors.grid, style: 2 },\n      },\n      rightPriceScale: {\n        borderVisible: false,\n        scaleMargins: { top: 0.1, bottom: 0.1 },\n      },\n      timeScale: {\n        visible: false,\n      },\n      handleScroll: {\n        vertTouchDrag: true,\n      },\n      handleScale: {\n        axisPressedMouseMove: false,\n        mouseWheel: false,\n        pinch: false,\n      },\n    })\n\n    rsiChartRef.current = chart\n\n    const lineSeries = chart.addSeries(LineSeries, {\n      color: '#8b5cf6',\n      lineWidth: 2,\n      priceFormat: {\n        type: 'price',\n        precision: 0,\n        minMove: 1,\n      },\n    })\n\n    const rsiValidData = rsiData\n      .map((value, index) => (isNaN(value) ? null : { time: times[index], value }))\n      .filter((item): item is { time: Time; value: number } => item !== null)\n\n    lineSeries.setData(rsiValidData)\n\n    chart.priceScale('').applyOptions({\n      autoScale: true,\n    })\n\n    const handleResize = () => {\n      if (rsiContainerRef.current && rsiChartRef.current) {\n        rsiChartRef.current.applyOptions({\n          width: rsiContainerRef.current.clientWidth,\n        })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      chart.remove()\n    }\n  }, [showRSI, data, rsiPeriod, chartColors, height, rsiData, times])\n\n  useEffect(() => {\n    if (!showMACD || !macdContainerRef.current || !data.length) return\n\n    if (macdChartRef.current) {\n      macdChartRef.current.remove()\n    }\n\n    const chart = createChart(macdContainerRef.current, {\n      width: macdContainerRef.current.clientWidth,\n      height: height - 40,\n      layout: {\n        background: { type: ColorType.Solid, color: chartColors.background },\n        textColor: chartColors.text,\n      },\n      grid: {\n        vertLines: { color: chartColors.grid, style: 2 },\n        horzLines: { color: chartColors.grid, style: 2 },\n      },\n      rightPriceScale: {\n        borderVisible: false,\n        scaleMargins: { top: 0.1, bottom: 0.1 },\n      },\n      timeScale: {\n        visible: false,\n      },\n      handleScroll: {\n        vertTouchDrag: true,\n      },\n      handleScale: {\n        axisPressedMouseMove: false,\n        mouseWheel: false,\n        pinch: false,\n      },\n    })\n\n    macdChartRef.current = chart\n\n    const macdLine = chart.addSeries(LineSeries, {\n      color: chartColors.macdColor,\n      lineWidth: 2,\n    })\n\n    const signalLine = chart.addSeries(LineSeries, {\n      color: chartColors.signalColor,\n      lineWidth: 2,\n    })\n\n    const histogramSeries = chart.addSeries(HistogramSeries, {\n      priceFormat: {\n        type: 'price',\n        precision: 2,\n        minMove: 0.01,\n      },\n      priceScaleId: '',\n    })\n\n    const macdValidData = macdData.macd\n      .map((value, index) => (isNaN(value) ? null : { time: times[index], value }))\n      .filter((item): item is { time: Time; value: number } => item !== null)\n\n    const signalValidData = macdData.signal\n      .map((value, index) => (isNaN(value) ? null : { time: times[index], value }))\n      .filter((item): item is { time: Time; value: number } => item !== null)\n\n    const histogramValidData = macdData.histogram\n      .map((value, index) => {\n        if (isNaN(value)) return null\n        return {\n          time: times[index],\n          value,\n          color: value >= 0 ? chartColors.upColor : chartColors.downColor,\n        }\n      })\n      .filter((item): item is { time: Time; value: number; color: string } => item !== null)\n\n    macdLine.setData(macdValidData)\n    signalLine.setData(signalValidData)\n    histogramSeries.setData(histogramValidData)\n\n    histogramSeries.priceScale().applyOptions({\n      scaleMargins: { top: 0.7, bottom: 0 },\n      borderVisible: false,\n    })\n\n    const handleResize = () => {\n      if (macdContainerRef.current && macdChartRef.current) {\n        macdChartRef.current.applyOptions({\n          width: macdContainerRef.current.clientWidth,\n        })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      chart.remove()\n    }\n  }, [showMACD, data, macdFast, macdSlow, macdSignal, chartColors, height, macdData, times])\n\n  const rsiSignal = getRSISignal(latestRSI, rsiOverbought, rsiOversold)\n  const macdSignalType = getMACDSignal(latestMACD, latestSignal)\n\n  if (!showRSI && !showMACD) {\n    return null\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Tabs defaultValue={showRSI ? 'rsi' : 'macd'} className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2\" style={{ maxWidth: 300 }}>\n          {showRSI && (\n            <TabsTrigger value=\"rsi\" className=\"flex items-center gap-2\">\n              RSI\n              {latestRSI && (\n                <Badge\n                  variant={rsiSignal === 'overbought' ? 'destructive' : rsiSignal === 'oversold' ? 'default' : 'secondary'}\n                  className={rsiSignal === 'oversold' ? 'bg-green-500' : ''}\n                >\n                  {rsiSignal === 'overbought' ? 'OB' : rsiSignal === 'oversold' ? 'OS' : 'N'}\n                </Badge>\n              )}\n            </TabsTrigger>\n          )}\n          {showMACD && (\n            <TabsTrigger value=\"macd\" className=\"flex items-center gap-2\">\n              MACD\n              {latestMACD && latestSignal && (\n                <Badge\n                  variant={macdSignalType === 'bullish' ? 'default' : macdSignalType === 'bearish' ? 'destructive' : 'secondary'}\n                  className={macdSignalType === 'bullish' ? 'bg-green-500' : ''}\n                >\n                  {macdSignalType === 'bullish' ? '↑' : macdSignalType === 'bearish' ? '↓' : '→'}\n                </Badge>\n              )}\n            </TabsTrigger>\n          )}\n        </TabsList>\n\n        {showRSI && (\n          <TabsContent value=\"rsi\" className=\"mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <CardTitle className=\"text-sm font-medium\">\n                      Relative Strength Index (RSI)\n                    </CardTitle>\n                    <TooltipProvider>\n                      <Tooltip>\n                        <TooltipTrigger asChild>\n                          <HelpCircle className=\"h-4 w-4 text-muted-foreground cursor-help\" />\n                        </TooltipTrigger>\n                        <TooltipContent className=\"max-w-sm\">\n                          <p className=\"font-medium mb-1\">{INDICATOR_DESCRIPTIONS.rsi.fullName}</p>\n                          <p className=\"text-sm text-muted-foreground mb-2\">\n                            {INDICATOR_DESCRIPTIONS.rsi.description}\n                          </p>\n                          <p className=\"text-sm\">\n                            <span className=\"text-red-500 font-medium\">Overbought (≥{rsiOverbought}):</span> May indicate price is too high and could reverse down.\n                          </p>\n                          <p className=\"text-sm\">\n                            <span className=\"text-green-500 font-medium\">Oversold (≤{rsiOversold}):</span> May indicate price is too low and could reverse up.\n                          </p>\n                        </TooltipContent>\n                      </Tooltip>\n                    </TooltipProvider>\n                  </div>\n                  <div className=\"flex items-center gap-4 text-sm\">\n                    <div className=\"flex items-center gap-1\">\n                      <span className=\"text-muted-foreground\">RSI({rsiPeriod}):</span>\n                      {latestRSI !== undefined && !isNaN(latestRSI) ? (\n                        <span className={`font-mono font-bold ${\n                          rsiSignal === 'overbought' ? 'text-red-500' :\n                          rsiSignal === 'oversold' ? 'text-green-500' : ''\n                        }`}>\n                          {formatIndicatorValue(latestRSI)}\n                        </span>\n                      ) : (\n                        <span className=\"font-mono\">--</span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex gap-4 text-xs text-muted-foreground mb-2\">\n                  <span className=\"flex items-center gap-1\">\n                    <span className=\"w-2 h-2 rounded-full bg-red-500\" />\n                    Overbought ({rsiOverbought}+)\n                  </span>\n                  <span className=\"flex items-center gap-1\">\n                    <span className=\"w-2 h-2 rounded-full bg-green-500\" />\n                    Oversold ({rsiOversold}-)\n                  </span>\n                </div>\n                <div ref={rsiContainerRef} className=\"w-full\" style={{ height: height - 40 }} />\n              </CardContent>\n            </Card>\n          </TabsContent>\n        )}\n\n        {showMACD && (\n          <TabsContent value=\"macd\" className=\"mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <CardTitle className=\"text-sm font-medium\">\n                      MACD ({macdFast},{macdSlow},{macdSignal})\n                    </CardTitle>\n                    <TooltipProvider>\n                      <Tooltip>\n                        <TooltipTrigger asChild>\n                          <HelpCircle className=\"h-4 w-4 text-muted-foreground cursor-help\" />\n                        </TooltipTrigger>\n                        <TooltipContent className=\"max-w-sm\">\n                          <p className=\"font-medium mb-1\">{INDICATOR_DESCRIPTIONS.macd.fullName}</p>\n                          <p className=\"text-sm text-muted-foreground mb-2\">\n                            {INDICATOR_DESCRIPTIONS.macd.description}\n                          </p>\n                          <div className=\"space-y-1 text-sm\">\n                            <p>\n                              <span className=\"text-blue-500 font-medium\">MACD Line:</span> {macdFast}-EMA minus {macdSlow}-EMA\n                            </p>\n                            <p>\n                              <span className=\"text-amber-500 font-medium\">Signal Line:</span> {macdSignal}-period EMA of MACD\n                            </p>\n                            <p>\n                              <span className=\"font-medium\">Histogram:</span> MACD minus Signal\n                            </p>\n                          </div>\n                        </TooltipContent>\n                      </Tooltip>\n                    </TooltipProvider>\n                  </div>\n                  <div className=\"flex items-center gap-4 text-sm\">\n                    <div className=\"flex items-center gap-1\">\n                      <span className=\"w-3 h-0.5 bg-blue-500\" />\n                      <span className=\"text-muted-foreground\">MACD:</span>\n                      {latestMACD !== undefined && !isNaN(latestMACD) ? (\n                        <span className={`font-mono ${\n                          macdSignalType === 'bullish' ? 'text-green-500' :\n                          macdSignalType === 'bearish' ? 'text-red-500' : ''\n                        }`}>\n                          {formatIndicatorValue(latestMACD)}\n                        </span>\n                      ) : (\n                        <span className=\"font-mono\">--</span>\n                      )}\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                      <span className=\"w-3 h-0.5 bg-amber-500\" />\n                      <span className=\"text-muted-foreground\">Signal:</span>\n                      {latestSignal !== undefined && !isNaN(latestSignal) ? (\n                        <span className=\"font-mono\">{formatIndicatorValue(latestSignal)}</span>\n                      ) : (\n                        <span className=\"font-mono\">--</span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex gap-4 text-xs text-muted-foreground mb-2\">\n                  <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-0.5 bg-blue-500\" />\n                    MACD ({macdFast},{macdSlow})\n                  </span>\n                  <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-0.5 bg-amber-500\" />\n                    Signal ({macdSignal})\n                  </span>\n                  <span className=\"flex items-center gap-1\">\n                    <span className=\"w-2 h-2 bg-green-500/50\" />\n                    Histogram\n                  </span>\n                </div>\n                <div ref={macdContainerRef} className=\"w-full\" style={{ height: height - 40 }} />\n              </CardContent>\n            </Card>\n          </TabsContent>\n        )}\n      </Tabs>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 989, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/TradingViewChart.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react'\nimport {\n  createChart,\n  IChartApi,\n  ISeriesApi,\n  ColorType,\n  CrosshairMode,\n  Time,\n  MouseEventParams,\n} from 'lightweight-charts'\nimport { useTheme } from 'next-themes'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { assetsApi } from '@/lib/api/assets'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { RefreshCw, AlertTriangle, TrendingUp, TrendingDown } from 'lucide-react'\nimport { TechnicalIndicatorsPanel } from './TechnicalIndicatorsPanel'\nimport { IndicatorConfig, calculateAllIndicators, INDICATOR_DESCRIPTIONS } from '@/lib/utils/technical-indicators'\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip'\nimport { HelpCircle } from 'lucide-react'\n\nexport type ChartType = 'candlestick' | 'line' | 'area' | 'bar' | 'histogram'\nexport type Timeframe = '1m' | '5m' | '15m' | '1h' | '4h' | '1d' | '1w' | '1M'\n\ninterface TradingViewChartProps {\n  symbol: string\n  chartType?: ChartType\n  timeframe?: Timeframe\n  height?: number\n  showVolume?: boolean\n  showIndicators?: string[]\n  indicatorConfig?: IndicatorConfig\n  onTimeframeChange?: (tf: Timeframe) => void\n  onSymbolChange?: (symbol: string) => void\n  onIndicatorChange?: (indicator: string, enabled: boolean) => void\n}\n\nexport interface OHLCVData {\n  date: string\n  open: number\n  high: number\n  low: number\n  close: number\n  volume?: number\n}\n\ninterface CrosshairData {\n  time: string | null\n  open: number | null\n  high: number | null\n  low: number | null\n  close: number | null\n  volume: number | null\n  sma20?: number | null\n  sma50?: number | null\n  sma200?: number | null\n  ema12?: number | null\n  ema26?: number | null\n  rsi?: number | null\n  macd?: number | null\n  macdSignal?: number | null\n  bollingerUpper?: number | null\n  bollingerMiddle?: number | null\n  bollingerLower?: number | null\n}\n\nexport function TradingViewChart({\n  symbol,\n  chartType = 'candlestick',\n  timeframe = '1d',\n  height = 400,\n  showVolume = true,\n  showIndicators = [],\n  indicatorConfig = {},\n  onTimeframeChange,\n  onSymbolChange,\n  onIndicatorChange,\n}: TradingViewChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n  const { theme } = useTheme()\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [currentData, setCurrentData] = useState<OHLCVData[]>([])\n  const [crosshairData, setCrosshairData] = useState<CrosshairData>({\n    time: null,\n    open: null,\n    high: null,\n    low: null,\n    close: null,\n    volume: null,\n  })\n  const [retryCount, setRetryCount] = useState(0)\n  const [isMobile, setIsMobile] = useState(false)\n\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768)\n    }\n    checkMobile()\n    window.addEventListener('resize', checkMobile)\n    return () => window.removeEventListener('resize', checkMobile)\n  }, [])\n\n  const responsiveHeight = isMobile ? Math.min(height * 0.7, 350) : height\n\n  const isDark = theme === 'dark'\n\n  const chartColors = useMemo(() => ({\n    background: isDark ? '#0f172a' : '#ffffff',\n    text: isDark ? '#94a3b8' : '#64748b',\n    grid: isDark ? '#1e293b' : '#e2e8f0',\n    upColor: '#22c55e',\n    downColor: '#ef4444',\n    wickUpColor: '#22c55e',\n    wickDownColor: '#ef4444',\n    volumeUp: isDark ? 'rgba(34, 197, 94, 0.3)' : 'rgba(34, 197, 94, 0.2)',\n    volumeDown: isDark ? 'rgba(239, 68, 68, 0.3)' : 'rgba(239, 68, 68, 0.2)',\n    crosshairLine: isDark ? 'rgba(148, 163, 184, 0.3)' : 'rgba(100, 116, 139, 0.3)',\n    sma20Color: '#3b82f6',\n    sma50Color: '#22c55e',\n    sma200Color: '#f59e0b',\n    ema12Color: '#8b5cf6',\n    ema26Color: '#ec4899',\n    bollingerUpperColor: '#94a3b8',\n    bollingerMiddleColor: '#64748b',\n    bollingerLowerColor: '#94a3b8',\n  }), [isDark])\n\n  const showRSI = showIndicators.includes('rsi')\n  const showMACD = showIndicators.includes('macd')\n  const showSMA20 = showIndicators.includes('sma20')\n  const showSMA50 = showIndicators.includes('sma50')\n  const showSMA200 = showIndicators.includes('sma200')\n  const showEMA12 = showIndicators.includes('ema12')\n  const showEMA26 = showIndicators.includes('ema26')\n  const showBollinger = showIndicators.includes('bollinger')\n\n  const indicatorResults = useMemo(() => {\n    if (currentData.length === 0) return null\n    const config: IndicatorConfig = {\n      sma20: showSMA20,\n      sma50: showSMA50,\n      sma200: showSMA200,\n      ema12: showEMA12,\n      ema26: showEMA26,\n      rsi: showRSI,\n      macd: showMACD,\n      bollinger: showBollinger,\n      rsiPeriod: indicatorConfig.rsiPeriod,\n      rsiOverbought: indicatorConfig.rsiOverbought,\n      rsiOversold: indicatorConfig.rsiOversold,\n      macdFast: indicatorConfig.macdFast,\n      macdSlow: indicatorConfig.macdSlow,\n      macdSignal: indicatorConfig.macdSignal,\n      bollingerPeriod: indicatorConfig.bollingerPeriod,\n      bollingerStdDev: indicatorConfig.bollingerStdDev,\n    }\n    return calculateAllIndicators(currentData, config)\n  }, [currentData, showSMA20, showSMA50, showSMA200, showEMA12, showEMA26, showRSI, showMACD, showBollinger, indicatorConfig])\n\n  const loadData = useCallback(async () => {\n    if (!chartContainerRef.current) return\n\n    setLoading(true)\n    setError(null)\n\n    try {\n      const interval = timeframe === '1d' ? '1d' : timeframe === '1w' ? '1wk' : timeframe === '1M' ? '1mo' : '1d'\n      const history = await assetsApi.getHistorical(symbol, undefined, undefined, interval)\n\n      if (!history || history.length === 0) {\n        setError('No data available for this symbol')\n        setLoading(false)\n        return\n      }\n\n      const ohlcvData: OHLCVData[] = history.map((d) => ({\n        date: d.timestamp instanceof Date ? d.timestamp.toISOString() : new Date(d.timestamp).toISOString(),\n        open: d.open,\n        high: d.high,\n        low: d.low,\n        close: d.close,\n        volume: d.volume,\n      }))\n\n      setCurrentData(ohlcvData)\n      setRetryCount(0)\n\n      if (chartRef.current) {\n        chartRef.current.remove()\n      }\n\n      const chart = createChart(chartContainerRef.current, {\n        width: chartContainerRef.current.clientWidth,\n        height: responsiveHeight - (showRSI || showMACD ? 250 : 0) - 60,\n        layout: {\n          background: { type: ColorType.Solid, color: chartColors.background },\n          textColor: chartColors.text,\n        },\n        grid: {\n          vertLines: { color: chartColors.grid, style: 2 },\n          horzLines: { color: chartColors.grid, style: 2 },\n        },\n        crosshair: {\n          mode: CrosshairMode.Normal,\n          vertLine: {\n            width: 1,\n            color: chartColors.crosshairLine,\n            style: 2,\n          },\n          horzLine: {\n            width: 1,\n            color: chartColors.crosshairLine,\n            style: 2,\n          },\n        },\n        rightPriceScale: {\n          borderColor: chartColors.grid,\n          borderVisible: true,\n          scaleMargins: {\n            top: showVolume ? 0.1 : 0,\n            bottom: showVolume ? 0.15 : 0,\n          },\n        },\n        timeScale: {\n          borderColor: chartColors.grid,\n          timeVisible: true,\n          secondsVisible: false,\n          barSpacing: 6,\n          minBarSpacing: 2,\n        },\n        handleScroll: {\n          vertTouchDrag: true,\n        },\n        handleScale: {\n          axisPressedMouseMove: true,\n          mouseWheel: true,\n          pinch: true,\n        },\n      })\n\n      chartRef.current = chart\n\n      const chartAny = chart as unknown as any\n\n      let mainSeries: ISeriesApi<any>\n\n      if (chartType === 'candlestick') {\n        mainSeries = chartAny.addCandlestickSeries({\n          upColor: chartColors.upColor,\n          downColor: chartColors.downColor,\n          borderVisible: false,\n          wickUpColor: chartColors.wickUpColor,\n          wickDownColor: chartColors.wickDownColor,\n        })\n\n        mainSeries.setData(\n          ohlcvData.map((d) => ({\n            time: d.date as Time,\n            open: d.open,\n            high: d.high,\n            low: d.low,\n            close: d.close,\n          }))\n        )\n      } else if (chartType === 'line') {\n        mainSeries = chartAny.addLineSeries({\n          color: '#3b82f6',\n          lineWidth: 2,\n          priceFormat: {\n            type: 'price',\n            precision: 2,\n            minMove: 0.01,\n          },\n        })\n\n        mainSeries.setData(\n          ohlcvData.map((d) => ({\n            time: d.date as Time,\n            value: d.close,\n          }))\n        )\n      } else if (chartType === 'area') {\n        mainSeries = chartAny.addAreaSeries({\n          topColor: 'rgba(59, 130, 246, 0.5)',\n          bottomColor: 'rgba(59, 130, 246, 0.0)',\n          lineColor: '#3b82f6',\n          lineWidth: 2,\n        })\n\n        mainSeries.setData(\n          ohlcvData.map((d) => ({\n            time: d.date as Time,\n            value: d.close,\n          }))\n        )\n      } else if (chartType === 'bar') {\n        mainSeries = chartAny.addBarSeries({\n          upColor: chartColors.upColor,\n          downColor: chartColors.downColor,\n        })\n\n        mainSeries.setData(\n          ohlcvData.map((d) => ({\n            time: d.date as Time,\n            open: d.open,\n            high: d.high,\n            low: d.low,\n            close: d.close,\n          }))\n        )\n      } else {\n        mainSeries = chartAny.addHistogramSeries({\n          priceFormat: {\n            type: 'volume',\n            precision: 0,\n            separator: ',',\n          },\n          priceScaleId: '',\n        })\n\n        mainSeries.setData(\n          ohlcvData.map((d) => ({\n            time: d.date as Time,\n            value: d.volume || 0,\n            color: d.close >= d.open ? chartColors.upColor : chartColors.downColor,\n          }))\n        )\n      }\n\n      if (showVolume && chartType !== 'histogram' && ohlcvData.some((d) => d.volume !== undefined)) {\n        const volumeSeries = chartAny.addHistogramSeries({\n          priceFormat: {\n            type: 'volume',\n            precision: 0,\n            separator: ',',\n          },\n          priceScaleId: 'volume',\n        })\n\n        volumeSeries.priceScale().applyOptions({\n          scaleMargins: {\n            top: 0.85,\n            bottom: 0,\n          },\n          borderVisible: false,\n        })\n\n        volumeSeries.setData(\n          ohlcvData.map((d) => ({\n            time: d.date as Time,\n            value: d.volume || 0,\n            color: d.close >= d.open ? chartColors.volumeUp : chartColors.volumeDown,\n          }))\n        )\n      }\n\n      if (indicatorResults) {\n        const times = ohlcvData.map(d => d.date as Time)\n\n        if (indicatorResults.sma20) {\n          const sma20Series = chartAny.addLineSeries({\n            color: chartColors.sma20Color,\n            lineWidth: 1,\n          })\n          sma20Series.setData(\n            indicatorResults.sma20.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n        }\n\n        if (indicatorResults.sma50) {\n          const sma50Series = chartAny.addLineSeries({\n            color: chartColors.sma50Color,\n            lineWidth: 1,\n          })\n          sma50Series.setData(\n            indicatorResults.sma50.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n        }\n\n        if (indicatorResults.sma200) {\n          const sma200Series = chartAny.addLineSeries({\n            color: chartColors.sma200Color,\n            lineWidth: 1,\n          })\n          sma200Series.setData(\n            indicatorResults.sma200.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n        }\n\n        if (indicatorResults.ema12) {\n          const ema12Series = chartAny.addLineSeries({\n            color: chartColors.ema12Color,\n            lineWidth: 1,\n          })\n          ema12Series.setData(\n            indicatorResults.ema12.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n        }\n\n        if (indicatorResults.ema26) {\n          const ema26Series = chartAny.addLineSeries({\n            color: chartColors.ema26Color,\n            lineWidth: 1,\n          })\n          ema26Series.setData(\n            indicatorResults.ema26.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n        }\n\n        if (indicatorResults.bollinger) {\n          const bb = indicatorResults.bollinger\n          const upperSeries = chartAny.addLineSeries({\n            color: chartColors.bollingerUpperColor,\n            lineWidth: 1,\n          })\n          upperSeries.setData(\n            bb.upper.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n\n          const middleSeries = chartAny.addLineSeries({\n            color: chartColors.bollingerMiddleColor,\n            lineWidth: 1,\n          })\n          middleSeries.setData(\n            bb.middle.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n\n          const lowerSeries = chartAny.addLineSeries({\n            color: chartColors.bollingerLowerColor,\n            lineWidth: 1,\n          })\n          lowerSeries.setData(\n            bb.lower.map((value, i) =>\n              isNaN(value) ? null : { time: times[i], value }\n            ).filter((v): v is { time: Time; value: number } => v !== null)\n          )\n        }\n      }\n\n      chart.timeScale().fitContent()\n\n      chart.subscribeCrosshairMove((param: MouseEventParams) => {\n        if (param.time && param.seriesData.size > 0) {\n          const time = param.time as string\n          const ohlcv = ohlcvData.find((d) => d.date === time)\n          if (ohlcv) {\n            const idx = ohlcvData.findIndex(d => d.date === time)\n            setCrosshairData({\n              time,\n              open: ohlcv.open,\n              high: ohlcv.high,\n              low: ohlcv.low,\n              close: ohlcv.close,\n              volume: ohlcv.volume || null,\n              sma20: indicatorResults?.sma20?.[idx] ?? null,\n              sma50: indicatorResults?.sma50?.[idx] ?? null,\n              sma200: indicatorResults?.sma200?.[idx] ?? null,\n              ema12: indicatorResults?.ema12?.[idx] ?? null,\n              ema26: indicatorResults?.ema26?.[idx] ?? null,\n              rsi: indicatorResults?.rsi?.[idx] ?? null,\n              macd: indicatorResults?.macd?.macd?.[idx] ?? null,\n              macdSignal: indicatorResults?.macd?.signal?.[idx] ?? null,\n              bollingerUpper: indicatorResults?.bollinger?.upper?.[idx] ?? null,\n              bollingerMiddle: indicatorResults?.bollinger?.middle?.[idx] ?? null,\n              bollingerLower: indicatorResults?.bollinger?.lower?.[idx] ?? null,\n            })\n          }\n        } else {\n          const lastIdx = ohlcvData.length - 1\n          if (lastIdx >= 0) {\n            setCrosshairData({\n              time: ohlcvData[lastIdx].date,\n              open: ohlcvData[lastIdx].open,\n              high: ohlcvData[lastIdx].high,\n              low: ohlcvData[lastIdx].low,\n              close: ohlcvData[lastIdx].close,\n              volume: ohlcvData[lastIdx].volume || null,\n              sma20: indicatorResults?.sma20?.[lastIdx] ?? null,\n              sma50: indicatorResults?.sma50?.[lastIdx] ?? null,\n              sma200: indicatorResults?.sma200?.[lastIdx] ?? null,\n              ema12: indicatorResults?.ema12?.[lastIdx] ?? null,\n              ema26: indicatorResults?.ema26?.[lastIdx] ?? null,\n              rsi: indicatorResults?.rsi?.[lastIdx] ?? null,\n              macd: indicatorResults?.macd?.macd?.[lastIdx] ?? null,\n              macdSignal: indicatorResults?.macd?.signal?.[lastIdx] ?? null,\n              bollingerUpper: indicatorResults?.bollinger?.upper?.[lastIdx] ?? null,\n              bollingerMiddle: indicatorResults?.bollinger?.middle?.[lastIdx] ?? null,\n              bollingerLower: indicatorResults?.bollinger?.lower?.[lastIdx] ?? null,\n            })\n          }\n        }\n      })\n\n      const handleResize = () => {\n        if (chartContainerRef.current && chartRef.current) {\n          chartRef.current.applyOptions({\n            width: chartContainerRef.current.clientWidth,\n          })\n        }\n      }\n\n      window.addEventListener('resize', handleResize)\n\n      setLoading(false)\n    } catch (err) {\n      console.error('Failed to load chart data:', err)\n      setError(err instanceof Error ? err.message : 'Failed to load chart data')\n      setLoading(false)\n    }\n  }, [symbol, chartType, timeframe, height, showVolume, showIndicators, indicatorConfig, chartColors, indicatorResults])\n\n  useEffect(() => {\n    loadData()\n  }, [loadData])\n\n  const handleRetry = () => {\n    setRetryCount((prev) => prev + 1)\n    loadData()\n  }\n\n  const latestData = currentData[currentData.length - 1]\n  const previousClose = currentData[currentData.length - 2]?.close\n  const priceChange = latestData && previousClose ? latestData.close - previousClose : null\n  const priceChangePercent = priceChange && previousClose ? (priceChange / previousClose) * 100 : null\n\n  const formatValue = (value: number | null | undefined) => {\n    if (value === null || value === undefined || isNaN(value)) return '--'\n    return value.toFixed(2)\n  }\n\n  const activeIndicatorsCount = showIndicators.filter(ind =>\n    ['sma20', 'sma50', 'sma200', 'ema12', 'ema26', 'rsi', 'macd', 'bollinger'].includes(ind)\n  ).length\n\n  if (loading) {\n    return (\n      <div className=\"w-full rounded-lg border bg-card\" style={{ height: responsiveHeight }}>\n        <div className=\"p-4 border-b space-y-3\">\n          <Skeleton className=\"h-6 w-32\" />\n          <div className=\"flex gap-4 flex-wrap\">\n            <Skeleton className=\"h-4 w-16 sm:w-20\" />\n            <Skeleton className=\"h-4 w-16 sm:w-20\" />\n            <Skeleton className=\"h-4 w-16 sm:w-20\" />\n            <Skeleton className=\"h-4 w-16 sm:w-20\" />\n          </div>\n        </div>\n        <Skeleton className=\"w-full h-[calc(100%-80px)] rounded-none\" />\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"w-full rounded-lg border bg-card flex flex-col items-center justify-center\" style={{ height }}>\n        <AlertTriangle className=\"h-12 w-12 text-destructive mb-4\" />\n        <p className=\"text-destructive font-medium mb-2\">Failed to load chart data</p>\n        <p className=\"text-sm text-muted-foreground mb-4\">{error}</p>\n        <Button onClick={handleRetry} variant=\"outline\" size=\"sm\">\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          Retry\n        </Button>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"w-full rounded-lg border bg-card overflow-hidden\">\n      <div className=\"p-3 border-b bg-muted/30\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <span className=\"font-bold text-lg\">{symbol}</span>\n            <Badge variant={priceChangePercent !== null && priceChangePercent >= 0 ? 'default' : 'destructive'} className={priceChangePercent !== null && priceChangePercent >= 0 ? 'bg-green-500' : ''}>\n              {priceChangePercent !== null ? (\n                <>\n                  {priceChangePercent >= 0 ? <TrendingUp className=\"h-3 w-3 mr-1\" /> : <TrendingDown className=\"h-3 w-3 mr-1\" />}\n                  {priceChangePercent >= 0 ? '+' : ''}{priceChangePercent.toFixed(2)}%\n                </>\n              ) : '--'}\n            </Badge>\n            {activeIndicatorsCount > 0 && (\n              <Badge variant=\"outline\" className=\"text-xs\">\n                {activeIndicatorsCount} indicator{activeIndicatorsCount > 1 ? 's' : ''}\n              </Badge>\n            )}\n          </div>\n          <div className=\"flex items-center gap-3 text-sm flex-wrap\">\n            <div className=\"flex items-center gap-1\">\n              <span className=\"text-muted-foreground\">O:</span>\n              <span className=\"font-mono\">{formatValue(crosshairData.open)}</span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <span className=\"text-muted-foreground\">H:</span>\n              <span className=\"font-mono text-green-500\">{formatValue(crosshairData.high)}</span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <span className=\"text-muted-foreground\">L:</span>\n              <span className=\"font-mono text-red-500\">{formatValue(crosshairData.low)}</span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <span className=\"text-muted-foreground\">C:</span>\n              <span className=\"font-mono\">{formatValue(crosshairData.close)}</span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <span className=\"text-muted-foreground\">Vol:</span>\n              <span className=\"font-mono\">\n                {crosshairData.volume ? (crosshairData.volume / 1000000).toFixed(2) + 'M' : '--'}\n              </span>\n            </div>\n\n            {showSMA20 && crosshairData.sma20 !== null && (\n              <TooltipProvider>\n                <Tooltip>\n                  <TooltipTrigger asChild>\n                    <div className=\"flex items-center gap-1 cursor-help\">\n                      <span className=\"w-2 h-0.5 bg-blue-500\" />\n                      <span className=\"font-mono text-blue-500\">{formatValue(crosshairData.sma20)}</span>\n                    </div>\n                  </TooltipTrigger>\n                  <TooltipContent>\n                    <p className=\"font-medium\">{INDICATOR_DESCRIPTIONS.sma20.name}</p>\n                    <p className=\"text-xs text-muted-foreground\">{INDICATOR_DESCRIPTIONS.sma20.description}</p>\n                  </TooltipContent>\n                </Tooltip>\n              </TooltipProvider>\n            )}\n\n            {showSMA50 && crosshairData.sma50 !== null && (\n              <div className=\"flex items-center gap-1\">\n                <span className=\"w-2 h-0.5 bg-green-500\" />\n                <span className=\"font-mono text-green-500\">{formatValue(crosshairData.sma50)}</span>\n              </div>\n            )}\n\n            {showBollinger && crosshairData.bollingerUpper !== null && (\n              <div className=\"flex items-center gap-1\">\n                <span className=\"font-mono text-gray-400\">{formatValue(crosshairData.bollingerLower)}</span>\n                <span className=\"text-muted-foreground\">-</span>\n                <span className=\"font-mono text-gray-400\">{formatValue(crosshairData.bollingerUpper)}</span>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      <div ref={chartContainerRef} className=\"w-full\" style={{ height: height - (showRSI || showMACD ? 250 : 0) - 60 }} />\n      {(showRSI || showMACD) && indicatorResults && (\n        <TechnicalIndicatorsPanel\n          data={currentData}\n          showRSI={showRSI}\n          showMACD={showMACD}\n          rsiPeriod={indicatorConfig.rsiPeriod}\n          rsiOverbought={indicatorConfig.rsiOverbought}\n          rsiOversold={indicatorConfig.rsiOversold}\n          macdFast={indicatorConfig.macdFast}\n          macdSlow={indicatorConfig.macdSlow}\n          macdSignal={indicatorConfig.macdSignal}\n          height={220}\n        />\n      )}\n      <div className=\"p-2 border-t bg-muted/20 text-xs text-center text-muted-foreground\">\n        {currentData.length} data points • {timeframe} timeframe • Data by Polygon.io\n        {activeIndicatorsCount > 0 && (\n          <span className=\"ml-2\">\n            • Active: {showIndicators.filter(i => ['sma20', 'sma50', 'sma200', 'ema12', 'ema26', 'rsi', 'macd', 'bollinger'].includes(i)).join(', ')}\n          </span>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2092, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/ScreenReaderChart.tsx"],"sourcesContent":["'use client'\n\nimport { cn } from '@/lib/utils'\n\ninterface ScreenReaderData {\n  label: string\n  value: string | number\n  description?: string\n}\n\ninterface ScreenReaderTableProps {\n  title: string\n  description?: string\n  data: ScreenReaderData[][]\n  caption?: string\n  className?: string\n}\n\nexport function ScreenReaderTable({\n  title,\n  description,\n  data,\n  caption,\n  className,\n}: ScreenReaderTableProps) {\n  if (!data || data.length === 0) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"region\"\n      aria-label={title}\n      aria-description={description}\n      className={cn('sr-only', className)}\n      tabIndex={-1}\n    >\n      <table>\n        {caption && <caption className=\"sr-only\">{caption}</caption>}\n        <thead>\n          {data[0] && (\n            <tr>\n              {data[0].map((cell, index) => (\n                <th key={index} scope=\"col\">\n                  {cell.label}\n                </th>\n              ))}\n            </tr>\n          )}\n        </thead>\n        <tbody>\n          {data.slice(1).map((row, rowIndex) => (\n            <tr key={rowIndex}>\n              {row.map((cell, cellIndex) => (\n                <td key={cellIndex}>\n                  {cell.description ? (\n                    <span aria-label={`${cell.label}, ${cell.description}, ${cell.value}`}>\n                      {cell.value}\n                    </span>\n                  ) : (\n                    cell.value\n                  )}\n                </td>\n              ))}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  )\n}\n\ninterface ScreenReaderSummaryProps {\n  title: string\n  summary: {\n    label: string\n    value: string | number\n  }[]\n}\n\nexport function ScreenReaderSummary({ title, summary }: ScreenReaderSummaryProps) {\n  if (!summary || summary.length === 0) {\n    return null\n  }\n\n  return (\n    <div role=\"region\" aria-label={title} className=\"sr-only\" tabIndex={-1}>\n      <h3>{title}</h3>\n      <ul>\n        {summary.map((item, index) => (\n          <li key={index}>\n            {item.label}: {item.value}\n          </li>\n        ))}\n      </ul>\n    </div>\n  )\n}\n\ninterface ChartScreenReaderProps {\n  chartTitle: string\n  chartDescription: string\n  currentValue?: string | number\n  change?: string | number\n  changePercent?: string | number\n  timeframe?: string\n  data?: ScreenReaderData[][]\n  summary?: {\n    label: string\n    value: string | number\n  }[]\n}\n\nexport function ChartScreenReader({\n  chartTitle,\n  chartDescription,\n  currentValue,\n  change,\n  changePercent,\n  timeframe,\n  data,\n  summary,\n}: ChartScreenReaderProps) {\n  const parts: string[] = []\n\n  if (currentValue !== undefined) {\n    parts.push(`Current value: ${currentValue}`)\n  }\n  if (change !== undefined) {\n    parts.push(`Change: ${change}`)\n  }\n  if (changePercent !== undefined) {\n    parts.push(`Change percent: ${changePercent}`)\n  }\n  if (timeframe) {\n    parts.push(`Timeframe: ${timeframe}`)\n  }\n\n  return (\n    <div className=\"sr-only\">\n      <h2>{chartTitle}</h2>\n      <p>{chartDescription}</p>\n      {parts.length > 0 && (\n        <section aria-label=\"Current values\">\n          <ul>\n            {parts.map((part, index) => (\n              <li key={index}>{part}</li>\n            ))}\n          </ul>\n        </section>\n      )}\n      {summary && <ScreenReaderSummary title=\"Summary statistics\" summary={summary} />}\n      {data && <ScreenReaderTable title=\"Chart data\" data={data} />}\n    </div>\n  )\n}\n\nexport default ScreenReaderTable\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AAFA;;;AAkBO,SAAS,kBAAkB,EAChC,KAAK,EACL,WAAW,EACX,IAAI,EACJ,OAAO,EACP,SAAS,EACc;IACvB,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,GAAG;QAC9B,OAAO;IACT;IAEA,qBACE,iNAAC;QACC,MAAK;QACL,cAAY;QACZ,oBAAkB;QAClB,WAAW,IAAA,gJAAE,EAAC,WAAW;QACzB,UAAU,CAAC;kBAEX,cAAA,iNAAC;;gBACE,yBAAW,iNAAC;oBAAQ,WAAU;8BAAW;;;;;;8BAC1C,iNAAC;8BACE,IAAI,CAAC,EAAE,kBACN,iNAAC;kCACE,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,sBAClB,iNAAC;gCAAe,OAAM;0CACnB,KAAK,KAAK;+BADJ;;;;;;;;;;;;;;;8BAOjB,iNAAC;8BACE,KAAK,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,KAAK,yBACvB,iNAAC;sCACE,IAAI,GAAG,CAAC,CAAC,MAAM,0BACd,iNAAC;8CACE,KAAK,WAAW,iBACf,iNAAC;wCAAK,cAAY,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,KAAK,WAAW,CAAC,EAAE,EAAE,KAAK,KAAK,EAAE;kDAClE,KAAK,KAAK;;;;;+CAGb,KAAK,KAAK;mCANL;;;;;2BAFJ;;;;;;;;;;;;;;;;;;;;;AAkBrB;KApDgB;AA8DT,SAAS,oBAAoB,EAAE,KAAK,EAAE,OAAO,EAA4B;IAC9E,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,GAAG;QACpC,OAAO;IACT;IAEA,qBACE,iNAAC;QAAI,MAAK;QAAS,cAAY;QAAO,WAAU;QAAU,UAAU,CAAC;;0BACnE,iNAAC;0BAAI;;;;;;0BACL,iNAAC;0BACE,QAAQ,GAAG,CAAC,CAAC,MAAM,sBAClB,iNAAC;;4BACE,KAAK,KAAK;4BAAC;4BAAG,KAAK,KAAK;;uBADlB;;;;;;;;;;;;;;;;AAOnB;MAjBgB;AAiCT,SAAS,kBAAkB,EAChC,UAAU,EACV,gBAAgB,EAChB,YAAY,EACZ,MAAM,EACN,aAAa,EACb,SAAS,EACT,IAAI,EACJ,OAAO,EACgB;IACvB,MAAM,QAAkB,EAAE;IAE1B,IAAI,iBAAiB,WAAW;QAC9B,MAAM,IAAI,CAAC,CAAC,eAAe,EAAE,cAAc;IAC7C;IACA,IAAI,WAAW,WAAW;QACxB,MAAM,IAAI,CAAC,CAAC,QAAQ,EAAE,QAAQ;IAChC;IACA,IAAI,kBAAkB,WAAW;QAC/B,MAAM,IAAI,CAAC,CAAC,gBAAgB,EAAE,eAAe;IAC/C;IACA,IAAI,WAAW;QACb,MAAM,IAAI,CAAC,CAAC,WAAW,EAAE,WAAW;IACtC;IAEA,qBACE,iNAAC;QAAI,WAAU;;0BACb,iNAAC;0BAAI;;;;;;0BACL,iNAAC;0BAAG;;;;;;YACH,MAAM,MAAM,GAAG,mBACd,iNAAC;gBAAQ,cAAW;0BAClB,cAAA,iNAAC;8BACE,MAAM,GAAG,CAAC,CAAC,MAAM,sBAChB,iNAAC;sCAAgB;2BAAR;;;;;;;;;;;;;;;YAKhB,yBAAW,iNAAC;gBAAoB,OAAM;gBAAqB,SAAS;;;;;;YACpE,sBAAQ,iNAAC;gBAAkB,OAAM;gBAAa,MAAM;;;;;;;;;;;;AAG3D;MA1CgB;uCA4CD"}},
    {"offset": {"line": 2315, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/ChartControls.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, KeyboardEvent } from 'react'\nimport { Button } from '@/components/ui/button'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuCheckboxItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport { Input } from '@/components/ui/input'\nimport {\n  BarChart3,\n  LineChart,\n  TrendingUp,\n  GripHorizontal,\n  CandlestickChart,\n  Activity,\n  Settings2,\n  Search,\n  Plus,\n  X,\n  Star,\n  Clock,\n  Settings,\n} from 'lucide-react'\nimport type { ChartType, Timeframe } from './TradingViewChart'\nimport { IndicatorConfig } from '@/lib/utils/technical-indicators'\n\ninterface ChartControlsProps {\n  symbol: string\n  currentTimeframe: Timeframe\n  currentType: ChartType\n  showVolume?: boolean\n  showIndicators?: string[]\n  indicatorConfig?: IndicatorConfig\n  availableIndicators?: string[]\n  activeIndicators?: string[]\n  onSymbolChange?: (symbol: string) => void\n  onTimeframeChange?: (tf: Timeframe) => void\n  onTypeChange?: (type: ChartType) => void\n  onVolumeToggle?: (show: boolean) => void\n  onIndicatorToggle?: (indicator: string, show: boolean) => void\n  onIndicatorConfigChange?: (config: IndicatorConfig) => void\n  onOpenIndicatorSettings?: () => void\n}\n\nconst TIMEFRAMES: { value: Timeframe; label: string; hotkey: string }[] = [\n  { value: '1m', label: '1m', hotkey: '1' },\n  { value: '5m', label: '5m', hotkey: '2' },\n  { value: '15m', label: '15m', hotkey: '3' },\n  { value: '1h', label: '1H', hotkey: '4' },\n  { value: '4h', label: '4H', hotkey: '5' },\n  { value: '1d', label: '1D', hotkey: '6' },\n  { value: '1w', label: '1W', hotkey: '7' },\n  { value: '1M', label: '1M', hotkey: '8' },\n]\n\nconst CHART_TYPES: { value: ChartType; label: string; icon: React.ReactNode; hotkey: string }[] = [\n  { value: 'candlestick', label: 'Candlestick', icon: <CandlestickChart className=\"h-4 w-4\" />, hotkey: 'c' },\n  { value: 'line', label: 'Line', icon: <LineChart className=\"h-4 w-4\" />, hotkey: 'l' },\n  { value: 'area', label: 'Area', icon: <TrendingUp className=\"h-4 w-4\" />, hotkey: 'a' },\n  { value: 'bar', label: 'Bar', icon: <GripHorizontal className=\"h-4 w-4\" />, hotkey: 'b' },\n]\n\nconst AVAILABLE_INDICATORS = [\n  { id: 'sma20', label: 'SMA 20', category: 'Moving Averages' },\n  { id: 'sma50', label: 'SMA 50', category: 'Moving Averages' },\n  { id: 'sma200', label: 'SMA 200', category: 'Moving Averages' },\n  { id: 'ema12', label: 'EMA 12', category: 'Moving Averages' },\n  { id: 'ema26', label: 'EMA 26', category: 'Moving Averages' },\n  { id: 'rsi', label: 'RSI 14', category: 'Oscillators' },\n  { id: 'macd', label: 'MACD', category: 'Oscillators' },\n  { id: 'bollinger', label: 'Bollinger Bands', category: 'Volatility' },\n]\n\nconst POPULAR_SYMBOLS = ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'TSLA', 'META', 'NVDA', 'JPM', 'BTC', 'ETH']\n\nconst RECENT_SYMBOLS_KEY = 'financehub_recent_symbols'\n\nexport function ChartControls({\n  symbol,\n  currentTimeframe,\n  currentType,\n  showVolume = true,\n  showIndicators = [],\n  indicatorConfig = {},\n  availableIndicators = [],\n  activeIndicators = [],\n  onSymbolChange,\n  onTimeframeChange,\n  onTypeChange,\n  onVolumeToggle,\n  onIndicatorToggle,\n  onIndicatorConfigChange,\n  onOpenIndicatorSettings,\n}: ChartControlsProps) {\n  const [symbolInput, setSymbolInput] = useState(symbol)\n  const [recentSymbols, setRecentSymbols] = useState<string[]>([])\n  const [isSearching, setIsSearching] = useState(false)\n\n  useEffect(() => {\n    const saved = localStorage.getItem(RECENT_SYMBOLS_KEY)\n    if (saved) {\n      try {\n        setRecentSymbols(JSON.parse(saved))\n      } catch {\n        setRecentSymbols([])\n      }\n    }\n  }, [])\n\n  const handleSymbolSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    if (symbolInput.trim()) {\n      const newSymbol = symbolInput.toUpperCase().trim()\n      onSymbolChange?.(newSymbol)\n      addToRecent(newSymbol)\n      setSymbolInput(newSymbol)\n      setIsSearching(false)\n    }\n  }\n\n  const handleSymbolSelect = (sym: string) => {\n    onSymbolChange?.(sym)\n    addToRecent(sym)\n    setSymbolInput(sym)\n    setIsSearching(false)\n  }\n\n  const addToRecent = (sym: string) => {\n    setRecentSymbols((prev) => {\n      const filtered = prev.filter((s) => s !== sym)\n      const updated = [sym, ...filtered].slice(0, 10)\n      localStorage.setItem(RECENT_SYMBOLS_KEY, JSON.stringify(updated))\n      return updated\n    })\n  }\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      setIsSearching(false)\n    }\n  }\n\n  useEffect(() => {\n    const handleKeyPress = (e: KeyboardEvent) => {\n      if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) return\n\n      if (e.key >= '1' && e.key <= '8') {\n        const tf = TIMEFRAMES.find((t) => t.hotkey === e.key)\n        if (tf) onTimeframeChange?.(tf.value)\n      }\n\n      if (e.key === 'c' || e.key === 'C') onTypeChange?.('candlestick')\n      if (e.key === 'l' || e.key === 'L') onTypeChange?.('line')\n      if (e.key === 'a' || e.key === 'A') onTypeChange?.('area')\n      if (e.key === 'b' || e.key === 'B') onTypeChange?.('bar')\n    }\n\n    window.addEventListener('keydown', handleKeyPress as any)\n    return () => window.removeEventListener('keydown', handleKeyPress as any)\n  }, [onTimeframeChange, onTypeChange])\n\n  const currentTypeInfo = CHART_TYPES.find((t) => t.value === currentType)\n\n  const groupedIndicators = AVAILABLE_INDICATORS.reduce((acc, indicator) => {\n    if (!acc[indicator.category]) acc[indicator.category] = []\n    acc[indicator.category].push(indicator)\n    return acc\n  }, {} as Record<string, typeof AVAILABLE_INDICATORS>)\n\n  const hasActiveIndicators = activeIndicators.length > 0\n\n  return (\n    <div className=\"flex flex-wrap items-center gap-2 p-3 border rounded-lg bg-card shadow-sm\">\n      <div className=\"relative\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() => setIsSearching(!isSearching)}\n          className=\"h-8\"\n        >\n          <Search className=\"h-4 w-4\" />\n        </Button>\n        {isSearching && (\n          <div className=\"absolute top-full left-0 mt-1 z-50 w-64 bg-popover border rounded-lg shadow-lg p-2\">\n            <form onSubmit={handleSymbolSubmit} className=\"flex gap-1 mb-2\">\n              <Input\n                type=\"text\"\n                placeholder=\"Enter symbol...\"\n                value={symbolInput}\n                onChange={(e) => setSymbolInput(e.target.value.toUpperCase())}\n                onKeyDown={handleKeyDown}\n                className=\"h-8 text-sm font-mono\"\n                autoFocus\n              />\n              <Button type=\"submit\" size=\"sm\" variant=\"secondary\">\n                Go\n              </Button>\n            </form>\n            {recentSymbols.length > 0 && (\n              <>\n                <div className=\"flex items-center gap-1 text-xs text-muted-foreground mb-1 px-1\">\n                  <Clock className=\"h-3 w-3\" />\n                  Recent\n                </div>\n                <div className=\"flex flex-wrap gap-1 mb-2\">\n                  {recentSymbols.slice(0, 5).map((sym) => (\n                    <Button\n                      key={sym}\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"h-6 text-xs font-mono\"\n                      onClick={() => handleSymbolSelect(sym)}\n                    >\n                      {sym}\n                    </Button>\n                  ))}\n                </div>\n              </>\n            )}\n            <div className=\"flex items-center gap-1 text-xs text-muted-foreground mb-1 px-1\">\n              <Star className=\"h-3 w-3\" />\n              Popular\n            </div>\n            <div className=\"flex flex-wrap gap-1\">\n              {POPULAR_SYMBOLS.map((sym) => (\n                <Button\n                  key={sym}\n                  variant={symbol === sym ? 'default' : 'ghost'}\n                  size=\"sm\"\n                  className=\"h-6 text-xs font-mono\"\n                  onClick={() => handleSymbolSelect(sym)}\n                >\n                  {sym}\n                </Button>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n\n      <form onSubmit={handleSymbolSubmit} className=\"flex items-center gap-1\">\n        <Input\n          type=\"text\"\n          placeholder=\"Symbol\"\n          value={symbolInput}\n          onChange={(e) => setSymbolInput(e.target.value.toUpperCase())}\n          className=\"w-20 h-8 text-sm font-mono\"\n        />\n        <Button type=\"submit\" size=\"sm\" variant=\"secondary\">\n          <Plus className=\"h-4 w-4\" />\n        </Button>\n      </form>\n\n      <div className=\"h-6 w-px bg-border\" />\n\n      <div className=\"flex items-center gap-0.5 bg-muted rounded-md p-0.5\">\n        {TIMEFRAMES.map((tf) => (\n          <Button\n            key={tf.value}\n            variant={currentTimeframe === tf.value ? 'default' : 'ghost'}\n            size=\"sm\"\n            className=\"h-7 px-2 text-xs font-medium\"\n            onClick={() => onTimeframeChange?.(tf.value)}\n            title={`Press ${tf.hotkey}`}\n          >\n            {tf.label}\n          </Button>\n        ))}\n      </div>\n\n      <div className=\"h-6 w-px bg-border\" />\n\n      <Select\n        value={currentType}\n        onValueChange={(value) => onTypeChange?.(value as ChartType)}\n      >\n        <SelectTrigger className=\"h-8 w-36\">\n          <SelectValue>\n            <div className=\"flex items-center gap-2\">\n              {currentTypeInfo?.icon}\n              <span className=\"text-xs\">{currentTypeInfo?.label}</span>\n            </div>\n          </SelectValue>\n        </SelectTrigger>\n        <SelectContent>\n          {CHART_TYPES.map((type) => (\n            <SelectItem key={type.value} value={type.value}>\n              <div className=\"flex items-center gap-2\">\n                {type.icon}\n                <span>{type.label}</span>\n                <span className=\"text-xs text-muted-foreground ml-2\">({type.hotkey})</span>\n              </div>\n            </SelectItem>\n          ))}\n        </SelectContent>\n      </Select>\n\n      <div className=\"h-6 w-px bg-border\" />\n\n      <Button\n        variant={showVolume ? 'default' : 'outline'}\n        size=\"sm\"\n        className=\"h-8 px-3\"\n        onClick={() => onVolumeToggle?.(!showVolume)}\n      >\n        <Activity className=\"h-4 w-4 mr-1\" />\n        <span className=\"text-xs\">Vol</span>\n      </Button>\n\n      <div className=\"h-6 w-px bg-border\" />\n\n      {hasActiveIndicators && (\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"h-8\"\n          onClick={onOpenIndicatorSettings}\n        >\n          <Settings className=\"h-4 w-4 mr-1\" />\n          <span className=\"text-xs\">Indicators</span>\n          <span className=\"ml-1 px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full\">\n            {activeIndicators.length}\n          </span>\n        </Button>\n      )}\n\n      {AVAILABLE_INDICATORS.length > 0 && (\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant={hasActiveIndicators ? 'default' : 'outline'} size=\"sm\" className=\"h-8\">\n              <Settings2 className=\"h-4 w-4 mr-1\" />\n              <span className=\"text-xs\">Indicators</span>\n              {activeIndicators.length > 0 && (\n                <span className=\"ml-1 px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full\">\n                  {activeIndicators.length}\n                </span>\n              )}\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\" className=\"w-56\">\n            <DropdownMenuLabel className=\"flex items-center justify-between\">\n              Technical Indicators\n              {activeIndicators.length > 0 && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-6 text-xs\"\n                  onClick={() => {\n                    activeIndicators.forEach((ind) => onIndicatorToggle?.(ind, false))\n                  }}\n                >\n                  Clear all\n                </Button>\n              )}\n            </DropdownMenuLabel>\n            <DropdownMenuSeparator />\n            {Object.entries(groupedIndicators).map(([category, indicators]) => (\n              <div key={category}>\n                <div className=\"px-2 py-1.5 text-xs font-medium text-muted-foreground\">\n                  {category}\n                </div>\n                {indicators.map((indicator) => (\n                  <DropdownMenuCheckboxItem\n                    key={indicator.id}\n                    checked={activeIndicators.includes(indicator.id)}\n                    onCheckedChange={(checked) =>\n                      onIndicatorToggle?.(indicator.id, checked as boolean)\n                    }\n                  >\n                    {indicator.label}\n                  </DropdownMenuCheckboxItem>\n                ))}\n                <DropdownMenuSeparator />\n              </div>\n            ))}\n          </DropdownMenuContent>\n        </DropdownMenu>\n      )}\n\n      <div className=\"ml-auto flex items-center gap-2\">\n        <span className=\"text-sm font-bold font-mono text-foreground\">{symbol}</span>\n        {recentSymbols.includes(symbol) && (\n          <span className=\"text-xs text-muted-foreground hidden sm:inline\">recent</span>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3108, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/TechnicalIndicators.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Switch } from '@/components/ui/switch'\nimport {\n  TrendingUp,\n  Activity,\n  Zap,\n  Plus,\n  X,\n  ChevronDown,\n  ChevronUp,\n  Settings2,\n} from 'lucide-react'\nimport { INDICATOR_CATEGORIES, INDICATOR_LABELS } from '@/lib/constants/indicators'\nimport { DEFAULT_INDICATORS } from '@/lib/types/indicators'\nimport type { IndicatorConfig, IndicatorType } from '@/lib/types/indicators'\nimport { cn } from '@/lib/utils'\n\ninterface TechnicalIndicatorsProps {\n  symbol: string\n  selectedIndicators: IndicatorConfig[]\n  onIndicatorsChange: (indicators: IndicatorConfig[]) => void\n  className?: string\n}\n\nexport function TechnicalIndicators({\n  symbol,\n  selectedIndicators,\n  onIndicatorsChange,\n  className,\n}: TechnicalIndicatorsProps) {\n  const [activeCategory, setActiveCategory] = useState<keyof typeof INDICATOR_CATEGORIES>('trend')\n  const [expandedIndicators, setExpandedIndicators] = useState<Set<string>>(new Set())\n  const [configuringIndicator, setConfiguringIndicator] = useState<IndicatorConfig | null>(null)\n\n  const availableIndicators = (Object.entries(INDICATOR_CATEGORIES).find(\n    ([key]) => key === activeCategory\n  )?.[1].indicators || []) as IndicatorType[]\n\n  const handleToggleIndicator = (indicatorType: IndicatorType) => {\n    const existingIndex = selectedIndicators.findIndex((ind) => ind.type === indicatorType)\n\n    if (existingIndex >= 0) {\n      // Remove indicator\n      const newIndicators = selectedIndicators.filter((ind) => ind.type !== indicatorType)\n      onIndicatorsChange(newIndicators)\n    } else {\n      // Add indicator with default config\n      const defaultConfig: IndicatorConfig = DEFAULT_INDICATORS[indicatorType]\n      onIndicatorsChange([...selectedIndicators, defaultConfig])\n      setConfiguringIndicator(defaultConfig)\n    }\n  }\n\n  const handleUpdateConfig = (indicator: IndicatorConfig) => {\n    const newIndicators = selectedIndicators.map((ind) =>\n      ind.type === indicator.type ? indicator : ind\n    )\n    onIndicatorsChange(newIndicators)\n    setConfiguringIndicator(null)\n  }\n\n  const handleToggleVisibility = (type: IndicatorType) => {\n    const newIndicators = selectedIndicators.map((ind) =>\n      ind.type === type ? { ...ind, visible: !ind.visible } : ind\n    )\n    onIndicatorsChange(newIndicators)\n  }\n\n  const getCategoryIcon = (category: string) => {\n    switch (category) {\n      case 'trend':\n        return <TrendingUp className=\"h-4 w-4\" />\n      case 'momentum':\n        return <Activity className=\"h-4 w-4\" />\n      case 'volatility':\n        return <Zap className=\"h-4 w-4\" />\n      default:\n        return <Settings2 className=\"h-4 w-4\" />\n    }\n  }\n\n  return (\n    <div className={cn('space-y-4', className)}>\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Activity className=\"h-5 w-5\" />\n            Technical Indicators\n            <Badge variant=\"secondary\">{selectedIndicators.length} active</Badge>\n          </CardTitle>\n          <CardDescription>\n            Add technical indicators to the chart\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Tabs value={activeCategory} onValueChange={(v) => setActiveCategory(v as keyof typeof INDICATOR_CATEGORIES)}>\n            <TabsList className=\"grid w-full grid-cols-4\">\n              {Object.entries(INDICATOR_CATEGORIES).map(([key, { label, indicators }]) => (\n                <TabsTrigger key={key} value={key} className=\"gap-2\">\n                  {getCategoryIcon(key)}\n                  {label}\n                </TabsTrigger>\n              ))}\n            </TabsList>\n\n            {Object.entries(INDICATOR_CATEGORIES).map(([key, { label, indicators }]) => (\n              <TabsContent key={key} value={key} className=\"space-y-2 mt-4\">\n                {indicators.map((indicatorType) => {\n                  const isSelected = selectedIndicators.some((ind) => ind.type === indicatorType)\n                  const config = selectedIndicators.find((ind) => ind.type === indicatorType)\n                  const isExpanded = expandedIndicators.has(indicatorType)\n\n                  return (\n                    <div\n                      key={indicatorType}\n                      className=\"border rounded-lg overflow-hidden\"\n                    >\n                      <div\n                        className=\"flex items-center justify-between p-3 hover:bg-muted/50 cursor-pointer\"\n                        onClick={() => {\n                          const newExpanded = new Set(expandedIndicators)\n                          if (isExpanded) {\n                            newExpanded.delete(indicatorType)\n                          } else {\n                            newExpanded.add(indicatorType)\n                          }\n                          setExpandedIndicators(newExpanded)\n                        }}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <Button\n                            variant={isSelected ? 'default' : 'outline'}\n                            size=\"sm\"\n                            onClick={(e) => {\n                              e.stopPropagation()\n                              handleToggleIndicator(indicatorType)\n                            }}\n                          >\n                            {isSelected ? (\n                              <X className=\"h-3 w-3\" />\n                            ) : (\n                              <Plus className=\"h-3 w-3\" />\n                            )}\n                          </Button>\n                          <span className=\"font-medium\">\n                            {INDICATOR_LABELS[indicatorType]}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          {isSelected && config && (\n                            <Switch\n                              checked={config.visible}\n                              onCheckedChange={() => handleToggleVisibility(indicatorType)}\n                              onClick={(e) => e.stopPropagation()}\n                            />\n                          )}\n                          {isExpanded ? (\n                            <ChevronUp className=\"h-4 w-4 text-muted-foreground\" />\n                          ) : (\n                            <ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\n                          )}\n                        </div>\n                      </div>\n\n                      {isExpanded && isSelected && config && (\n                        <div className=\"border-t p-4 space-y-4 bg-muted/30\">\n                          <div className=\"grid gap-4 md:grid-cols-2\">\n                            <div className=\"space-y-2\">\n                              <Label>Period</Label>\n                              <Input\n                                type=\"number\"\n                                value={config.params.period || 20}\n                                onChange={(e) =>\n                                  handleUpdateConfig({\n                                    ...config,\n                                    params: {\n                                      ...config.params,\n                                      period: parseFloat(e.target.value),\n                                    },\n                                  })\n                                }\n                                className=\"font-mono\"\n                              />\n                            </div>\n\n                            {config.type === 'bollinger' && (\n                              <>\n                                <div className=\"space-y-2\">\n                                  <Label>Standard Deviations</Label>\n                                  <Input\n                                    type=\"number\"\n                                    step=\"0.1\"\n                                    value={config.params.stdDev || 2}\n                                    onChange={(e) =>\n                                      handleUpdateConfig({\n                                        ...config,\n                                        params: {\n                                          ...config.params,\n                                          stdDev: parseFloat(e.target.value),\n                                        },\n                                      })\n                                    }\n                                    className=\"font-mono\"\n                                  />\n                                </div>\n                              </>\n                            )}\n\n                            {config.type === 'macd' && (\n                              <>\n                                <div className=\"space-y-2\">\n                                  <Label>Fast Period</Label>\n                                  <Input\n                                    type=\"number\"\n                                    value={config.params.fastPeriod || 12}\n                                    onChange={(e) =>\n                                      handleUpdateConfig({\n                                        ...config,\n                                        params: {\n                                          ...config.params,\n                                          fastPeriod: parseFloat(e.target.value),\n                                        },\n                                      })\n                                    }\n                                    className=\"font-mono\"\n                                  />\n                                </div>\n                                <div className=\"space-y-2\">\n                                  <Label>Slow Period</Label>\n                                  <Input\n                                    type=\"number\"\n                                    value={config.params.slowPeriod || 26}\n                                    onChange={(e) =>\n                                      handleUpdateConfig({\n                                        ...config,\n                                        params: {\n                                          ...config.params,\n                                          slowPeriod: parseFloat(e.target.value),\n                                        },\n                                      })\n                                    }\n                                    className=\"font-mono\"\n                                  />\n                                </div>\n                                <div className=\"space-y-2\">\n                                  <Label>Signal Period</Label>\n                                  <Input\n                                    type=\"number\"\n                                    value={config.params.signalPeriod || 9}\n                                    onChange={(e) =>\n                                      handleUpdateConfig({\n                                        ...config,\n                                        params: {\n                                          ...config.params,\n                                          signalPeriod: parseFloat(e.target.value),\n                                        },\n                                      })\n                                    }\n                                    className=\"font-mono\"\n                                  />\n                                </div>\n                              </>\n                            )}\n\n                            {config.type === 'stochastic' && (\n                              <>\n                                <div className=\"space-y-2\">\n                                  <Label>%K Period</Label>\n                                  <Input\n                                    type=\"number\"\n                                    value={config.params.kPeriod || 14}\n                                    onChange={(e) =>\n                                      handleUpdateConfig({\n                                        ...config,\n                                        params: {\n                                          ...config.params,\n                                          kPeriod: parseFloat(e.target.value),\n                                        },\n                                      })\n                                    }\n                                    className=\"font-mono\"\n                                  />\n                                </div>\n                                <div className=\"space-y-2\">\n                                  <Label>%D Period</Label>\n                                  <Input\n                                    type=\"number\"\n                                    value={config.params.dPeriod || 3}\n                                    onChange={(e) =>\n                                      handleUpdateConfig({\n                                        ...config,\n                                        params: {\n                                          ...config.params,\n                                          dPeriod: parseFloat(e.target.value),\n                                        },\n                                      })\n                                    }\n                                    className=\"font-mono\"\n                                  />\n                                </div>\n                              </>\n                            )}\n                          </div>\n\n                          <div className=\"space-y-2\">\n                            <Label>Color</Label>\n                            <div className=\"flex gap-2\">\n                              {['#3b82f6', '#8b5cf6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444', '#ec4899', '#14b8a6'].map((color) => (\n                                <button\n                                  key={color}\n                                  className={cn(\n                                    'w-8 h-8 rounded-md border-2 transition-all',\n                                    config.color === color\n                                      ? 'border-foreground scale-110'\n                                      : 'border-transparent hover:scale-105'\n                                  )}\n                                  style={{ backgroundColor: color }}\n                                  onClick={() =>\n                                    handleUpdateConfig({ ...config, color })\n                                  }\n                                />\n                              ))}\n                            </div>\n                          </div>\n\n                          <div className=\"flex items-center gap-2\">\n                            <Switch\n                              checked={config.secondary_yaxis || false}\n                              onCheckedChange={(checked) =>\n                                handleUpdateConfig({\n                                  ...config,\n                                  secondary_yaxis: checked,\n                                })\n                              }\n                            />\n                            <Label className=\"text-sm\">Secondary Y-Axis</Label>\n                          </div>\n\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleToggleIndicator(indicatorType)}\n                          >\n                            Remove Indicator\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  )\n                })}\n              </TabsContent>\n            ))}\n          </Tabs>\n\n          {selectedIndicators.length === 0 && (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Activity className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>No indicators selected</p>\n              <p className=\"text-sm\">Add indicators from the categories above</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3805, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/DrawingTools.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useRef, useCallback } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Switch } from '@/components/ui/switch'\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport {\n  Minus,\n  TrendingUp,\n  Square,\n  Type,\n  Activity,\n  Plus,\n  Trash2,\n  Save,\n  Undo,\n  Camera,\n  Share2,\n  Download,\n  Link,\n  Loader2,\n} from 'lucide-react'\nimport { DRAWING_TOOLS, FIBONACCI_LEVELS } from '@/lib/constants/indicators'\nimport { cn } from '@/lib/utils'\n\nexport type DrawingType =\n  | 'horizontal_line'\n  | 'vertical_line'\n  | 'trend_line'\n  | 'fibonacci'\n  | 'rectangle'\n  | 'text'\n\ninterface Drawing {\n  id: string\n  type: DrawingType\n  symbol: string\n  timeframe: string\n  startX: number\n  startY: number\n  endX?: number\n  endY?: number\n  color: string\n  width: number\n  style: 'solid' | 'dashed'\n  text?: string\n  fibonacciLevels?: number[]\n  visible: boolean\n  created_at: string\n}\n\ninterface DrawingToolsProps {\n  symbol: string\n  timeframe: string\n  drawings: Drawing[]\n  onDrawingsChange: (drawings: Drawing[]) => void\n  onToolSelect?: (tool: DrawingType | null) => void\n  selectedTool?: DrawingType | null\n  onScreenshot?: () => Promise<string>\n  onShare?: () => Promise<string>\n  className?: string\n}\n\nexport function DrawingTools({\n  symbol,\n  timeframe,\n  drawings,\n  onDrawingsChange,\n  onToolSelect,\n  selectedTool,\n  onScreenshot,\n  onShare,\n  className,\n}: DrawingToolsProps) {\n  const [activeTab, setActiveTab] = useState<'tools' | 'manage'>('tools')\n  const [isTakingScreenshot, setIsTakingScreenshot] = useState(false)\n  const [isSharing, setIsSharing] = useState(false)\n  const [shareUrl, setShareUrl] = useState<string | null>(null)\n  const [showShareModal, setShowShareModal] = useState(false)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  const handleSelectTool = (type: DrawingType) => {\n    if (selectedTool === type) {\n      onToolSelect?.(null)\n    } else {\n      onToolSelect?.(type)\n    }\n  }\n\n  const handleClearAll = () => {\n    if (confirm('Are you sure you want to clear all drawings?')) {\n      onDrawingsChange([])\n    }\n  }\n\n  const handleToggleVisibility = (drawingId: string) => {\n    const newDrawings = drawings.map((d) =>\n      d.id === drawingId ? { ...d, visible: !d.visible } : d\n    )\n    onDrawingsChange(newDrawings)\n  }\n\n  const handleDeleteDrawing = (drawingId: string) => {\n    const newDrawings = drawings.filter((d) => d.id !== drawingId)\n    onDrawingsChange(newDrawings)\n  }\n\n  const handleScreenshot = useCallback(async () => {\n    if (!onScreenshot) {\n      return\n    }\n\n    setIsTakingScreenshot(true)\n    try {\n      const dataUrl = await onScreenshot()\n      const link = document.createElement('a')\n      link.download = `chart-${symbol}-${Date.now()}.png`\n      link.href = dataUrl\n      link.click()\n    } catch (error) {\n      console.error('Failed to take screenshot:', error)\n    } finally {\n      setIsTakingScreenshot(false)\n    }\n  }, [onScreenshot, symbol])\n\n  const handleShare = useCallback(async () => {\n    if (!onShare) {\n      return\n    }\n\n    setIsSharing(true)\n    setShareUrl(null)\n    try {\n      const url = await onShare()\n      setShareUrl(url)\n      setShowShareModal(true)\n    } catch (error) {\n      console.error('Failed to share:', error)\n    } finally {\n      setIsSharing(false)\n    }\n  }, [onShare])\n\n  const copyShareUrl = useCallback(async () => {\n    if (shareUrl) {\n      await navigator.clipboard.writeText(shareUrl)\n    }\n  }, [shareUrl])\n\n  const getToolIcon = (type: DrawingType) => {\n    switch (type) {\n      case 'horizontal_line':\n        return <Minus className=\"h-4 w-4\" />\n      case 'vertical_line':\n        return <Minus className=\"h-4 w-4 rotate-90\" />\n      case 'trend_line':\n        return <TrendingUp className=\"h-4 w-4\" />\n      case 'fibonacci':\n        return <Activity className=\"h-4 w-4\" />\n      case 'rectangle':\n        return <Square className=\"h-4 w-4\" />\n      case 'text':\n        return <Type className=\"h-4 w-4\" />\n      default:\n        return <Minus className=\"h-4 w-4\" />\n    }\n  }\n\n  const getToolLabel = (type: DrawingType) => {\n    return DRAWING_TOOLS.find((t) => t.type === type)?.label || type\n  }\n\n  return (\n    <div className={cn('space-y-4', className)}>\n      <Card className=\"rounded-none border-1\">\n        <CardHeader className=\"border-b-1\">\n          <CardTitle className=\"flex items-center gap-2 font-black uppercase\">\n            <Type className=\"h-5 w-5\" />\n            Drawing Tools\n            <Badge variant=\"outline\" className=\"rounded-none font-mono text-xs\">{drawings.length} drawings</Badge>\n          </CardTitle>\n          <CardDescription className=\"font-mono text-xs\">\n            Draw support, resistance, and annotations on charts\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"p-4\">\n          <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as 'tools' | 'manage')}>\n            <TabsList className=\"rounded-none border-2 bg-transparent p-0 h-auto w-full justify-start mb-4\">\n              <TabsTrigger \n                value=\"tools\"\n                className=\"rounded-none border-2 border-b-0 data-[state=active]:bg-foreground data-[state=active]:text-background px-4 py-2 font-black uppercase text-xs\"\n              >\n                Tools\n              </TabsTrigger>\n              <TabsTrigger \n                value=\"manage\"\n                className=\"rounded-none border-2 border-b-0 data-[state=active]:bg-foreground data-[state=active]:text-background px-4 py-2 font-black uppercase text-xs\"\n              >\n                Manage\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"tools\" className=\"space-y-4 mt-0\">\n              <div className=\"grid grid-cols-2 gap-2\">\n                {DRAWING_TOOLS.map((tool) => (\n                  <Button\n                    key={tool.type}\n                    variant={selectedTool === tool.type ? 'default' : 'outline'}\n                    onClick={() => handleSelectTool(tool.type as DrawingType)}\n                    className={cn(\n                      'gap-2 justify-start rounded-none font-bold uppercase text-xs',\n                      selectedTool === tool.type \n                        ? 'bg-foreground text-background' \n                        : 'border-2'\n                    )}\n                  >\n                    {getToolIcon(tool.type as DrawingType)}\n                    <span className=\"text-sm\">{tool.label}</span>\n                  </Button>\n                ))}\n              </div>\n\n              {selectedTool && (\n                <Card className=\"rounded-none border-2 border-foreground bg-muted/30\">\n                  <CardHeader className=\"pb-3 border-b-2\">\n                    <CardTitle className=\"text-sm font-black uppercase\">\n                      Selected: {getToolLabel(selectedTool)}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3 p-4\">\n                    <div className=\"text-sm text-muted-foreground font-mono text-xs\">\n                      {selectedTool === 'horizontal_line' && 'Click to set price level'}\n                      {selectedTool === 'vertical_line' && 'Click to set time point'}\n                      {selectedTool === 'trend_line' && 'Drag to draw trend line'}\n                      {selectedTool === 'fibonacci' && 'Drag to draw Fibonacci retracement'}\n                      {selectedTool === 'rectangle' && 'Drag to create rectangle zone'}\n                      {selectedTool === 'text' && 'Click to add text annotation'}\n                    </div>\n\n                    <div className=\"flex gap-2\">\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => onToolSelect?.(null)} className=\"rounded-none border-2 font-bold uppercase text-xs\">\n                        Cancel\n                      </Button>\n                      <Button size=\"sm\" className=\"flex-1 rounded-none font-black uppercase text-xs\">\n                        <Save className=\"h-4 w-4 mr-2\" />\n                        Save Drawing\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              <div className=\"bg-primary/10 border-2 border-primary/30 p-3\">\n                <p className=\"text-xs text-foreground font-mono\">\n                  <strong>Tip:</strong> Select a drawing tool, then click and drag on the chart to create. Drawings are saved per symbol and timeframe.\n                </p>\n              </div>\n\n              <div className=\"border-t-2 pt-4\">\n                <Label className=\"text-xs font-bold uppercase text-muted-foreground mb-2 block\">\n                  Export & Share\n                </Label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleScreenshot}\n                    disabled={isTakingScreenshot || !onScreenshot}\n                    className=\"rounded-none border-2 font-bold uppercase text-xs\"\n                  >\n                    {isTakingScreenshot ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <Camera className=\"h-4 w-4\" />\n                    )}\n                    <span className=\"ml-2\">Screenshot</span>\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleShare}\n                    disabled={isSharing || !onShare}\n                    className=\"rounded-none border-2 font-bold uppercase text-xs\"\n                  >\n                    {isSharing ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <Share2 className=\"h-4 w-4\" />\n                    )}\n                    <span className=\"ml-2\">Share</span>\n                  </Button>\n                </div>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"manage\" className=\"space-y-4 mt-0\">\n              {drawings.length === 0 ? (\n                <div className=\"text-center py-8 text-muted-foreground border-2 border-dashed p-8\">\n                  <Type className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p className=\"font-black uppercase\">No drawings yet</p>\n                  <p className=\"text-sm font-mono text-muted-foreground\">Use drawing tools to create annotations</p>\n                </div>\n              ) : (\n                <>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={handleClearAll}\n                      className=\"rounded-none border-2 font-bold uppercase text-xs text-destructive hover:text-destructive\"\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                      Clear All\n                    </Button>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    {drawings.map((drawing) => (\n                      <div\n                        key={drawing.id}\n                        className=\"flex items-center justify-between p-3 border-2 rounded-none hover:bg-muted/50\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          {getToolIcon(drawing.type)}\n                          <div>\n                            <p className=\"font-bold uppercase text-sm\">\n                              {getToolLabel(drawing.type)}\n                            </p>\n                            <p className=\"text-xs font-mono text-muted-foreground\">\n                              {new Date(drawing.created_at).toLocaleString()}\n                            </p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <Switch\n                            checked={drawing.visible}\n                            onCheckedChange={() => handleToggleVisibility(drawing.id)}\n                            className=\"rounded-none\"\n                          />\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handleDeleteDrawing(drawing.id)}\n                            className=\"rounded-none\"\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </>\n              )}\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n\n      <Dialog open={showShareModal} onOpenChange={setShowShareModal}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Share2 className=\"h-5 w-5\" />\n              Share Chart\n            </DialogTitle>\n            <DialogDescription>\n              Share your chart with drawings and annotations.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {shareUrl ? (\n              <>\n                <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                  <Link className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                  <code className=\"text-sm flex-1 break-all\">{shareUrl}</code>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={copyShareUrl}>\n                    Copy\n                  </Button>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button variant=\"outline\" className=\"flex-1\" onClick={() => window.open(shareUrl, '_blank')}>\n                    <Download className=\"h-4 w-4 mr-2\" />\n                    Open Link\n                  </Button>\n                  <Button className=\"flex-1\" onClick={() => {\n                    if (navigator.share) {\n                      navigator.share({\n                        title: `Chart: ${symbol}`,\n                        text: 'Check out this chart on FinanceHub',\n                        url: shareUrl,\n                      })\n                    }\n                  }}>\n                    <Share2 className=\"h-4 w-4 mr-2\" />\n                    Share Via...\n                  </Button>\n                </div>\n              </>\n            ) : (\n              <div className=\"flex items-center justify-center py-8\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n              </div>\n            )}\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowShareModal(false)}>\n              Close\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4685, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/ComparisonChart.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  TrendingUp,\n  Plus,\n  X,\n  RefreshCw,\n  Minus,\n  Activity,\n} from 'lucide-react'\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Tooltip,\n  Legend,\n  Filler,\n} from 'chart.js/auto'\nimport { Line } from 'react-chartjs-2'\nimport { cn } from '@/lib/utils'\nimport type { TimeFrame } from '@/lib/types/indicators'\n\ninterface ComparisonData {\n  symbol: string\n  name: string\n  data: Array<{\n    timestamp: string\n    price: number\n    normalized: number\n    change: number\n  }>\n  currentPrice: number\n  change: number\n  changePercent: number\n  color: string\n}\n\ninterface ComparisonChartProps {\n  symbols: string[]\n  timeframe?: TimeFrame\n  normalize?: boolean\n  startDate?: Date\n  endDate?: Date\n  className?: string\n}\n\nconst TIMEFRAME_OPTIONS = [\n  { value: '1d', label: '1 Day' },\n  { value: '1w', label: '1 Week' },\n  { value: '1m', label: '1 Month' },\n  { value: '3m', label: '3 Months' },\n  { value: '6m', label: '6 Months' },\n  { value: '1y', label: '1 Year' },\n] as const\n\nconst PRESET_COMPARISONS = [\n  {\n    name: 'Tech Giants',\n    symbols: ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'META'],\n  },\n  {\n    name: 'Major Indices',\n    symbols: ['SPY', 'QQQ', 'IWM', 'DIA'],\n  },\n  {\n    name: 'Auto Makers',\n    symbols: ['TSLA', 'F', 'GM', 'RIVN', 'LCID'],\n  },\n  {\n    name: 'Banks',\n    symbols: ['JPM', 'BAC', 'WFC', 'C', 'GS'],\n  },\n]\n\nconst COLOR_PALETTE = [\n  '#3b82f6', // blue\n  '#22c55e', // green\n  '#f59e0b', // orange\n  '#ef4444', // red\n  '#8b5cf6', // purple\n  '#06b6d4', // cyan\n  '#ec4899', // pink\n  '#14b8a6', // teal\n]\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Tooltip,\n  Legend,\n  Filler\n)\n\nexport function ComparisonChart({\n  symbols: initialSymbols,\n  timeframe = '1m',\n  normalize = true,\n  startDate,\n  endDate,\n  className,\n}: ComparisonChartProps) {\n  const [symbols, setSymbols] = useState<string[]>(initialSymbols.slice(0, 4))\n  const [selectedTimeframe, setSelectedTimeframe] = useState<TimeFrame>(timeframe)\n  const [comparisonData, setComparisonData] = useState<ComparisonData[]>([])\n  const [loading, setLoading] = useState(false)\n  const [newSymbol, setNewSymbol] = useState('')\n  const [normalized, setNormalized] = useState(normalize)\n\n  const symbolColors = symbols.reduce((acc, symbol, index) => {\n    acc[symbol] = COLOR_PALETTE[index % COLOR_PALETTE.length]\n    return acc\n  }, {} as Record<string, string>)\n\n  useEffect(() => {\n    fetchComparisonData()\n  }, [symbols, selectedTimeframe, normalized])\n\n  const fetchComparisonData = async () => {\n    setLoading(true)\n    try {\n      // Mock data for now - in production, fetch from API\n      const now = new Date()\n      const days = getTimeframeDays(selectedTimeframe)\n      \n      const data: ComparisonData[] = await Promise.all(\n        symbols.map(async (symbol) => {\n          // Generate mock historical data\n          const basePrice = Math.random() * 1000 + 50\n          const dataPoints = []\n          let cumulativeChange = 0\n          \n          for (let i = days; i >= 0; i--) {\n            const date = new Date(now)\n            date.setDate(date.getDate() - i)\n            \n            const dailyChange = (Math.random() - 0.5) * 0.05\n            cumulativeChange += dailyChange\n            \n            const price = basePrice * (1 + cumulativeChange)\n            dataPoints.push({\n              timestamp: date.toISOString(),\n              price,\n              normalized: 0, // Will be calculated\n              change: cumulativeChange * 100,\n            })\n          }\n          \n          // Normalize to first data point\n          const firstPrice = dataPoints[0].price\n          dataPoints.forEach(point => {\n            point.normalized = ((point.price - firstPrice) / firstPrice) * 100\n          })\n          \n          const currentPrice = dataPoints[dataPoints.length - 1].price\n          const totalChange = dataPoints[dataPoints.length - 1].change\n          \n          return {\n            symbol,\n            name: symbol,\n            data: dataPoints,\n            currentPrice,\n            change: totalChange,\n            changePercent: totalChange,\n            color: symbolColors[symbol],\n          }\n        })\n      )\n      \n      setComparisonData(data)\n    } catch (error) {\n      console.error('Failed to fetch comparison data:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getTimeframeDays = (tf: TimeFrame): number => {\n    switch (tf) {\n      case '1d': return 1\n      case '1w': return 7\n      case '1m': return 30\n      case '3m': return 90\n      case '6m': return 180\n      case '1y': return 365\n      default: return 30\n    }\n  }\n\n  const handleAddSymbol = () => {\n    const symbol = newSymbol.toUpperCase().trim()\n    if (symbol && !symbols.includes(symbol) && symbols.length < 4) {\n      setSymbols([...symbols, symbol])\n      setNewSymbol('')\n    }\n  }\n\n  const handleRemoveSymbol = (symbol: string) => {\n    const newSymbols = symbols.filter((s) => s !== symbol)\n    setSymbols(newSymbols)\n  }\n\n  const handleApplyPreset = (presetSymbols: string[]) => {\n    setSymbols(presetSymbols.slice(0, 4))\n  }\n\n  const labels = comparisonData[0]?.data.map((point) => {\n    const date = new Date(point.timestamp)\n    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n  }) || []\n\n  const datasets = comparisonData.flatMap((data) => [\n    {\n      label: `${data.symbol} (Price)`,\n      data: data.data.map((point) =>\n        normalized ? point.normalized : point.price\n      ),\n      borderColor: data.color,\n      backgroundColor: data.color + '20',\n      tension: 0.4,\n      pointRadius: 0,\n      pointHoverRadius: 4,\n      borderWidth: 2,\n      fill: false,\n      yAxisID: 'y',\n    },\n  ])\n\n  const chartOptions: any = {\n    responsive: true,\n    maintainAspectRatio: false,\n    interaction: {\n      mode: 'index' as const,\n      intersect: false,\n    },\n    plugins: {\n      legend: {\n        display: true,\n        position: 'top' as const,\n        labels: {\n          boxWidth: 12,\n          padding: 15,\n          font: {\n            size: 11,\n          },\n        },\n      },\n      tooltip: {\n        backgroundColor: 'rgba(0, 0, 0, 0.8)',\n        titleColor: 'white',\n        bodyColor: 'white',\n        borderColor: 'rgba(255, 255, 255, 0.1)',\n        borderWidth: 1,\n        padding: 12,\n        cornerRadius: 8,\n        callbacks: {\n          label: (context: { datasetIndex: number; dataIndex: number }) => {\n            const dataset = comparisonData[context.datasetIndex]\n            const dataPoint = dataset?.data[context.dataIndex]\n            if (!dataset || !dataPoint) return ''\n            \n            const value = normalized\n              ? `${dataPoint.normalized.toFixed(2)}%`\n              : `$${dataPoint.price.toFixed(2)}`\n            \n            return `${dataset.symbol}: ${value} (${dataPoint.change >= 0 ? '+' : ''}${dataPoint.change.toFixed(2)}%)`\n          },\n        },\n      },\n    },\n    scales: {\n      x: {\n        grid: {\n          display: false,\n        },\n        ticks: {\n          color: 'rgba(148, 163, 184, 0.5)',\n          maxTicksLimit: 8,\n        },\n      },\n      y: {\n        type: 'linear' as const,\n        display: true,\n        position: 'left' as const,\n        grid: {\n          color: 'rgba(148, 163, 184, 0.1)',\n        },\n        ticks: {\n          color: 'rgba(148, 163, 184, 0.5)',\n          callback: (value: number) =>\n            normalized ? `${value.toFixed(0)}%` : `$${value.toFixed(2)}`,\n        },\n      },\n    },\n  }\n\n  const calculateCorrelation = (data1: number[], data2: number[]): number => {\n    const n = Math.min(data1.length, data2.length)\n    let sumX = 0,\n      sumY = 0,\n      sumXY = 0,\n      sumX2 = 0,\n      sumY2 = 0\n    \n    for (let i = 0; i < n; i++) {\n      sumX += data1[i]\n      sumY += data2[i]\n      sumXY += data1[i] * data2[i]\n      sumX2 += data1[i] * data1[i]\n      sumY2 += data2[i] * data2[i]\n    }\n    \n    const numerator = n * sumXY - sumX * sumY\n    const denominator = Math.sqrt(\n      (n * sumX2 - sumX * sumX) * (n * sumY2 - sumY * sumY)\n    )\n    \n    return denominator === 0 ? 0 : numerator / denominator\n  }\n\n  const correlations = comparisonData.flatMap((data1, i) =>\n    comparisonData.slice(i + 1).map((data2) => ({\n      pair: `${data1.symbol}-${data2.symbol}`,\n      value: calculateCorrelation(\n        data1.data.map((d) => d.price),\n        data2.data.map((d) => d.price)\n      ),\n    }))\n  )\n\n  return (\n    <div className={cn('space-y-4', className)}>\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Activity className=\"h-5 w-5\" />\n                Comparison Chart\n                <Badge variant=\"secondary\">{symbols.length} symbols</Badge>\n              </CardTitle>\n              <CardDescription>\n                Compare multiple symbols performance\n              </CardDescription>\n            </div>\n            <Button variant=\"outline\" size=\"sm\" onClick={fetchComparisonData} disabled={loading}>\n              <RefreshCw className={cn('h-4 w-4 mr-2', loading && 'animate-spin')} />\n              Refresh\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            <div className=\"flex gap-4 flex-wrap\">\n              <div className=\"flex-1 min-w-[200px]\">\n                <Label htmlFor=\"symbol\">Add Symbol</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"symbol\"\n                    value={newSymbol}\n                    onChange={(e) => setNewSymbol(e.target.value.toUpperCase())}\n                    placeholder=\"AAPL\"\n                    className=\"flex-1 font-mono uppercase\"\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') handleAddSymbol()\n                    }}\n                  />\n                  <Button\n                    size=\"sm\"\n                    onClick={handleAddSymbol}\n                    disabled={symbols.length >= 4 || !newSymbol.trim()}\n                  >\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex-1 min-w-[200px]\">\n                <Label>Normalization</Label>\n                <Select value={normalized ? 'true' : 'false'} onValueChange={(v) => setNormalized(v === 'true')}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"true\">Normalized (%)</SelectItem>\n                    <SelectItem value=\"false\">Absolute ($)</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"flex-1 min-w-[200px]\">\n                <Label>Timeframe</Label>\n                <Select value={selectedTimeframe} onValueChange={(v) => setSelectedTimeframe(v as TimeFrame)}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {TIMEFRAME_OPTIONS.map((option) => (\n                      <SelectItem key={option.value} value={option.value}>\n                        {option.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div>\n              <Label>Quick Presets</Label>\n              <div className=\"flex gap-2 flex-wrap mt-2\">\n                {PRESET_COMPARISONS.map((preset) => (\n                  <Button\n                    key={preset.name}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => handleApplyPreset(preset.symbols)}\n                  >\n                    {preset.name}\n                  </Button>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"flex gap-2 flex-wrap\">\n              {symbols.map((symbol) => {\n                const data = comparisonData.find((d) => d.symbol === symbol)\n                return (\n                  <Badge\n                    key={symbol}\n                    variant=\"outline\"\n                    className={cn(\n                      'px-3 py-1 text-sm cursor-pointer',\n                      data && data.change >= 0 ? 'border-green-500 text-green-700' : 'border-red-500 text-red-700'\n                    )}\n                    style={{\n                      borderColor: data?.color,\n                      backgroundColor: data?.color + '10',\n                    }}\n                  >\n                    <span className=\"font-mono font-semibold mr-2\">{symbol}</span>\n                    {data && (\n                      <span className=\"text-xs\">\n                        {data.change >= 0 ? '+' : ''}\n                        {data.changePercent.toFixed(2)}%\n                      </span>\n                    )}\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        handleRemoveSymbol(symbol)\n                      }}\n                      className=\"ml-2 hover:text-destructive\"\n                    >\n                      <X className=\"h-3 w-3\" />\n                    </button>\n                  </Badge>\n                )\n              })}\n            </div>\n\n            {comparisonData.length > 0 && (\n              <>\n                <div className=\"h-80\">\n                  <Line data={{ labels, datasets }} options={chartOptions} />\n                </div>\n\n                {correlations.length > 0 && (\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"text-sm\">Correlation Matrix</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-2\">\n                        {correlations.slice(0, 5).map((corr) => (\n                          <div\n                            key={corr.pair}\n                            className=\"flex items-center justify-between text-sm\"\n                          >\n                            <span className=\"font-mono\">{corr.pair.replace('-', ' vs ')}</span>\n                            <div className=\"flex items-center gap-2\">\n                              <div className=\"w-32 h-2 bg-muted rounded-full overflow-hidden\">\n                                <div\n                                  className={cn(\n                                    'h-full transition-all',\n                                    Math.abs(corr.value) > 0.7\n                                      ? 'bg-green-500'\n                                      : Math.abs(corr.value) > 0.4\n                                      ? 'bg-yellow-500'\n                                      : 'bg-red-500'\n                                  )}\n                                  style={{\n                                    width: `${Math.abs(corr.value) * 100}%`,\n                                    marginLeft: corr.value < 0 ? 'auto' : '0',\n                                  }}\n                                />\n                              </div>\n                              <span className=\"font-mono w-12 text-right\">\n                                {corr.value.toFixed(2)}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n              </>\n            )}\n\n            {comparisonData.length === 0 && !loading && (\n              <div className=\"text-center py-12 text-muted-foreground\">\n                <Activity className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                <p>No symbols to compare</p>\n                <p className=\"text-sm\">Add symbols above or select a preset</p>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5533, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/HoldingsPnLChart.tsx"],"sourcesContent":["'use client'\n\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Legend,\n} from 'recharts'\nimport type { PnLHistoryPoint } from '@/lib/types/holdings'\n\ninterface HoldingsPnLChartProps {\n  data: PnLHistoryPoint[]\n  loading?: boolean\n}\n\nexport function HoldingsPnLChart({ data, loading = false }: HoldingsPnLChartProps) {\n  if (loading) {\n    return (\n      <div className=\"h-[300px] w-full bg-muted animate-pulse rounded-lg\" />\n    )\n  }\n\n  if (data.length === 0) {\n    return (\n      <div className=\"h-[300px] w-full flex items-center justify-center bg-muted/50 rounded-lg\">\n        <p className=\"text-muted-foreground\">No P&L data available</p>\n      </div>\n    )\n  }\n\n  const formatCurrency = (value: number) =>\n    new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(value)\n\n  const formatDate = (dateStr: string) => {\n    const date = new Date(dateStr)\n    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n  }\n\n  interface TooltipPayloadItem {\n    name: string\n    value: number\n    color: string\n  }\n\n  interface TooltipProps {\n    active?: boolean\n    payload?: TooltipPayloadItem[]\n    label?: string\n  }\n\n  const CustomTooltip = ({ active, payload, label }: TooltipProps) => {\n    if (active && payload && payload.length) {\n      return (\n        <div className=\"bg-background border rounded-lg shadow-lg p-3\">\n          <p className=\"text-sm text-muted-foreground mb-2\">{label && formatDate(label)}</p>\n          {payload.map((entry, index) => (\n            <div key={index} className=\"flex items-center gap-2\">\n              <div\n                className=\"w-2 h-2 rounded-full\"\n                style={{ backgroundColor: entry.color }}\n              />\n              <span className=\"text-sm font-medium\">\n                {entry.name}: {formatCurrency(entry.value)}\n              </span>\n            </div>\n          ))}\n        </div>\n      )\n    }\n    return null\n  }\n\n  return (\n    <div className=\"h-[300px] w-full\">\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <AreaChart data={data} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>\n          <defs>\n            <linearGradient id=\"colorValue\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n              <stop offset=\"5%\" stopColor=\"#3B82F6\" stopOpacity={0.3} />\n              <stop offset=\"95%\" stopColor=\"#3B82F6\" stopOpacity={0} />\n            </linearGradient>\n            <linearGradient id=\"colorPnL\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n              <stop offset=\"5%\" stopColor=\"#10B981\" stopOpacity={0.3} />\n              <stop offset=\"95%\" stopColor=\"#10B981\" stopOpacity={0} />\n            </linearGradient>\n          </defs>\n          <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n          <XAxis\n            dataKey=\"date\"\n            tickFormatter={formatDate}\n            tick={{ fontSize: 12, fill: '#6B7280' }}\n            axisLine={{ stroke: '#E5E7EB' }}\n            tickLine={false}\n          />\n          <YAxis\n            tickFormatter={formatCurrency}\n            tick={{ fontSize: 12, fill: '#6B7280' }}\n            axisLine={false}\n            tickLine={false}\n            width={80}\n          />\n          <Tooltip content={<CustomTooltip />} />\n          <Legend\n            wrapperStyle={{ paddingTop: '20px' }}\n            formatter={(value) => <span className=\"text-sm\">{value}</span>}\n          />\n          <Area\n            type=\"monotone\"\n            dataKey=\"value\"\n            name=\"Portfolio Value\"\n            stroke=\"#3B82F6\"\n            strokeWidth={2}\n            fillOpacity={1}\n            fill=\"url(#colorValue)\"\n          />\n          <Area\n            type=\"monotone\"\n            dataKey=\"pnl\"\n            name=\"P&L\"\n            stroke=\"#10B981\"\n            strokeWidth={2}\n            fillOpacity={1}\n            fill=\"url(#colorPnL)\"\n          />\n        </AreaChart>\n      </ResponsiveContainer>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5845, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/HoldingsAllocationChart.tsx"],"sourcesContent":["'use client'\n\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend } from 'recharts'\nimport type { AssetAllocationItem } from '@/lib/types/holdings'\nimport { ASSET_CLASS_COLORS } from '@/lib/types/holdings'\nimport { cn } from '@/lib/utils'\n\ninterface HoldingsAllocationChartProps {\n  data: AssetAllocationItem[]\n  loading?: boolean\n  type?: 'pie' | 'donut'\n}\n\nexport function HoldingsAllocationChart({\n  data,\n  loading = false,\n  type = 'donut',\n}: HoldingsAllocationChartProps) {\n  if (loading) {\n    return (\n      <div className=\"h-[300px] w-full bg-muted animate-pulse rounded-lg\" />\n    )\n  }\n\n  if (data.length === 0) {\n    return (\n      <div className=\"h-[300px] w-full flex items-center justify-center bg-muted/50 rounded-lg\">\n        <p className=\"text-muted-foreground\">No allocation data available</p>\n      </div>\n    )\n  }\n\n  const formatCurrency = (value: number) =>\n    new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(value)\n\n  const RADIAN = Math.PI / 180\n  const renderCustomizedLabel = ({\n    cx,\n    cy,\n    midAngle,\n    innerRadius,\n    outerRadius,\n    percent,\n  }: {\n    cx: number\n    cy: number\n    midAngle: number\n    innerRadius: number\n    outerRadius: number\n    percent: number\n  }) => {\n    const radius = innerRadius + (outerRadius - innerRadius) * 0.5\n    const x = cx + radius * Math.cos(-midAngle * RADIAN)\n    const y = cy + radius * Math.sin(-midAngle * RADIAN)\n\n    if (percent < 0.05) return null\n\n    return (\n      <text\n        x={x}\n        y={y}\n        fill=\"white\"\n        textAnchor=\"middle\"\n        dominantBaseline=\"central\"\n        className=\"text-xs font-medium\"\n      >\n        {`${(percent * 100).toFixed(0)}%`}\n      </text>\n    )\n  }\n\n  interface TooltipPayloadItem {\n    payload: {\n      asset_class: string\n      value: number\n      percentage: number\n      holdings_count: number\n    }\n  }\n\n  interface TooltipProps {\n    active?: boolean\n    payload?: TooltipPayloadItem[]\n  }\n\n  const CustomTooltip = ({ active, payload }: TooltipProps) => {\n    if (active && payload && payload.length) {\n      const data = payload[0].payload\n      return (\n        <div className=\"bg-background border rounded-lg shadow-lg p-3\">\n          <p className=\"font-medium capitalize mb-1\">\n            {data.asset_class.replace('_', ' ')}\n          </p>\n          <div className=\"space-y-1\">\n            <p className=\"text-sm text-muted-foreground\">\n              Value: {formatCurrency(data.value)}\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              Percentage: {data.percentage.toFixed(1)}%\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              Holdings: {data.holdings_count}\n            </p>\n          </div>\n        </div>\n      )\n    }\n    return null\n  }\n\n  interface LegendProps {\n    payload: Array<{\n      color: string\n      value: string\n    }>\n  }\n\n  const renderLegend = (props: LegendProps) => {\n    const { payload } = props\n\n    return (\n      <ul className=\"flex flex-wrap justify-center gap-4 mt-4\">\n        {payload.map((entry, index) => (\n          <li key={`legend-${index}`} className=\"flex items-center gap-2\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: entry.color }}\n            />\n            <span className=\"text-sm capitalize\">\n              {entry.value.replace('_', ' ')}\n            </span>\n          </li>\n        ))}\n      </ul>\n    )\n  }\n\n  return (\n    <div className=\"h-[300px] w-full\">\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <PieChart>\n          <Pie\n            data={data}\n            cx=\"50%\"\n            cy=\"50%\"\n            labelLine={false}\n            label={renderCustomizedLabel}\n            outerRadius={type === 'donut' ? 100 : 120}\n            innerRadius={type === 'donut' ? 60 : 0}\n            fill=\"#8884d8\"\n            dataKey=\"value\"\n            nameKey=\"asset_class\"\n            paddingAngle={2}\n          >\n            {data.map((entry, index) => (\n              <Cell\n                key={`cell-${index}`}\n                fill={\n                  ASSET_CLASS_COLORS[\n                    entry.asset_class as keyof typeof ASSET_CLASS_COLORS\n                  ] || '#6B7280'\n                }\n              />\n            ))}\n          </Pie>\n          <Tooltip content={CustomTooltip as any} />\n          <Legend content={renderLegend as any} />\n        </PieChart>\n      </ResponsiveContainer>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6089, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/TopHoldingsChart.tsx"],"sourcesContent":["'use client'\n\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Cell,\n} from 'recharts'\nimport type { Holding } from '@/lib/types/holdings'\nimport type { PortfolioHolding } from '@/lib/types/portfolio'\nimport { ASSET_CLASS_COLORS } from '@/lib/types/holdings'\nimport { cn } from '@/lib/utils'\n\ntype HoldingItem = Holding | PortfolioHolding\n\ninterface TopHoldingsChartProps {\n  holdings: HoldingItem[]\n  loading?: boolean\n  topN?: number\n}\n\nfunction getAssetClass(holding: HoldingItem): string {\n  if ('asset_class' in holding) {\n    return holding.asset_class\n  }\n  return holding.asset_type || 'other'\n}\n\nexport function TopHoldingsChart({\n  holdings,\n  loading = false,\n  topN = 10,\n}: TopHoldingsChartProps) {\n  if (loading) {\n    return (\n      <div className=\"h-[400px] w-full bg-muted animate-pulse rounded-lg\" />\n    )\n  }\n\n  const topHoldings = [...holdings]\n    .sort((a, b) => b.current_value - a.current_value)\n    .slice(0, topN)\n\n  if (topHoldings.length === 0) {\n    return (\n      <div className=\"h-[400px] w-full flex items-center justify-center bg-muted/50 rounded-lg\">\n        <p className=\"text-muted-foreground\">No holdings data available</p>\n      </div>\n    )\n  }\n\n  const formatCurrency = (value: number) =>\n    new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(value)\n\n  const formatPercent = (value: number) => `${value.toFixed(1)}%`\n\n  interface TooltipProps {\n    active?: boolean\n    payload?: Array<{\n      payload: {\n        symbol: string\n        current_value: number\n        weight: number\n        unrealized_pnl: number\n        unrealized_pnl_percent: number\n      }\n    }>\n  }\n\n  const CustomTooltip = ({ active, payload }: TooltipProps) => {\n    if (active && payload && payload.length) {\n      const data = payload[0].payload\n      return (\n        <div className=\"bg-background border rounded-lg shadow-lg p-3\">\n          <p className=\"font-medium mb-2\">{data.symbol}</p>\n          <div className=\"space-y-1\">\n            <p className=\"text-sm text-muted-foreground\">\n              Value: {formatCurrency(data.current_value)}\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              Weight: {formatPercent(data.weight)}\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              P&L: {data.unrealized_pnl >= 0 ? '+' : ''}{formatCurrency(data.unrealized_pnl)}\n              {' '}\n              ({data.unrealized_pnl_percent >= 0 ? '+' : ''}{data.unrealized_pnl_percent.toFixed(2)}%)\n            </p>\n          </div>\n        </div>\n      )\n    }\n    return null\n  }\n\n  return (\n    <div className=\"h-[400px] w-full\">\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <BarChart\n          data={topHoldings}\n          layout=\"vertical\"\n          margin={{ top: 20, right: 30, left: 60, bottom: 5 }}\n        >\n          <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n          <XAxis\n            type=\"number\"\n            tickFormatter={formatCurrency}\n            tick={{ fontSize: 12, fill: '#6B7280' }}\n            axisLine={{ stroke: '#E5E7EB' }}\n            tickLine={false}\n          />\n          <YAxis\n            type=\"category\"\n            dataKey=\"symbol\"\n            tick={{ fontSize: 12, fill: '#6B7280' }}\n            axisLine={false}\n            tickLine={false}\n            width={60}\n          />\n          <Tooltip content={<CustomTooltip />} />\n          <Bar dataKey=\"current_value\" radius={[0, 4, 4, 0]}>\n            {topHoldings.map((holding, index) => (\n              <Cell\n                key={`cell-${index}`}\n                fill={\n                  ASSET_CLASS_COLORS[\n                    getAssetClass(holding) as keyof typeof ASSET_CLASS_COLORS\n                  ] || '#6B7280'\n                }\n              />\n            ))}\n          </Bar>\n        </BarChart>\n      </ResponsiveContainer>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAdA;;;;AAyBA,SAAS,cAAc,OAAoB;IACzC,IAAI,iBAAiB,SAAS;QAC5B,OAAO,QAAQ,WAAW;IAC5B;IACA,OAAO,QAAQ,UAAU,IAAI;AAC/B;AAEO,SAAS,iBAAiB,EAC/B,QAAQ,EACR,UAAU,KAAK,EACf,OAAO,EAAE,EACa;IACtB,IAAI,SAAS;QACX,qBACE,iNAAC;YAAI,WAAU;;;;;;IAEnB;IAEA,MAAM,cAAc;WAAI;KAAS,CAC9B,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,aAAa,GAAG,EAAE,aAAa,EAChD,KAAK,CAAC,GAAG;IAEZ,IAAI,YAAY,MAAM,KAAK,GAAG;QAC5B,qBACE,iNAAC;YAAI,WAAU;sBACb,cAAA,iNAAC;gBAAE,WAAU;0BAAwB;;;;;;;;;;;IAG3C;IAEA,MAAM,iBAAiB,CAAC,QACtB,IAAI,KAAK,YAAY,CAAC,SAAS;YAC7B,OAAO;YACP,UAAU;YACV,uBAAuB;YACvB,uBAAuB;QACzB,GAAG,MAAM,CAAC;IAEZ,MAAM,gBAAgB,CAAC,QAAkB,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC;IAe/D,MAAM,gBAAgB,CAAC,EAAE,MAAM,EAAE,OAAO,EAAgB;QACtD,IAAI,UAAU,WAAW,QAAQ,MAAM,EAAE;YACvC,MAAM,OAAO,OAAO,CAAC,EAAE,CAAC,OAAO;YAC/B,qBACE,iNAAC;gBAAI,WAAU;;kCACb,iNAAC;wBAAE,WAAU;kCAAoB,KAAK,MAAM;;;;;;kCAC5C,iNAAC;wBAAI,WAAU;;0CACb,iNAAC;gCAAE,WAAU;;oCAAgC;oCACnC,eAAe,KAAK,aAAa;;;;;;;0CAE3C,iNAAC;gCAAE,WAAU;;oCAAgC;oCAClC,cAAc,KAAK,MAAM;;;;;;;0CAEpC,iNAAC;gCAAE,WAAU;;oCAAgC;oCACrC,KAAK,cAAc,IAAI,IAAI,MAAM;oCAAI,eAAe,KAAK,cAAc;oCAC5E;oCAAI;oCACH,KAAK,sBAAsB,IAAI,IAAI,MAAM;oCAAI,KAAK,sBAAsB,CAAC,OAAO,CAAC;oCAAG;;;;;;;;;;;;;;;;;;;QAKhG;QACA,OAAO;IACT;IAEA,qBACE,iNAAC;QAAI,WAAU;kBACb,cAAA,iNAAC,wNAAmB;YAAC,OAAM;YAAO,QAAO;sBACvC,cAAA,iNAAC,8LAAQ;gBACP,MAAM;gBACN,QAAO;gBACP,QAAQ;oBAAE,KAAK;oBAAI,OAAO;oBAAI,MAAM;oBAAI,QAAQ;gBAAE;;kCAElD,iNAAC,4MAAa;wBAAC,iBAAgB;wBAAM,WAAU;;;;;;kCAC/C,iNAAC,4LAAK;wBACJ,MAAK;wBACL,eAAe;wBACf,MAAM;4BAAE,UAAU;4BAAI,MAAM;wBAAU;wBACtC,UAAU;4BAAE,QAAQ;wBAAU;wBAC9B,UAAU;;;;;;kCAEZ,iNAAC,4LAAK;wBACJ,MAAK;wBACL,SAAQ;wBACR,MAAM;4BAAE,UAAU;4BAAI,MAAM;wBAAU;wBACtC,UAAU;wBACV,UAAU;wBACV,OAAO;;;;;;kCAET,iNAAC,gMAAO;wBAAC,uBAAS,iNAAC;;;;;;;;;;kCACnB,iNAAC,wLAAG;wBAAC,SAAQ;wBAAgB,QAAQ;4BAAC;4BAAG;4BAAG;4BAAG;yBAAE;kCAC9C,YAAY,GAAG,CAAC,CAAC,SAAS,sBACzB,iNAAC,0LAAI;gCAEH,MACE,4KAAkB,CAChB,cAAc,SACf,IAAI;+BAJF,CAAC,KAAK,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;AAapC;KAhHgB"}},
    {"offset": {"line": 6333, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/MarketHeatmap.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo, useCallback } from 'react'\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport {\n  TrendingUp,\n  TrendingDown,\n  Clock,\n  ChevronUp,\n  ChevronDown,\n  RefreshCw,\n  Maximize2,\n  ZoomIn,\n  ZoomOut,\n  ArrowLeft,\n  X,\n  Download,\n  FileImage,\n  FileText,\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { Button } from '@/components/ui/button'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { useDownloadFile } from '@/hooks/useDownload'\n\nexport type Timeframe = '1D' | '1W' | '1M' | '3M' | 'YTD' | '1Y' | 'ALL'\n\nexport interface MarketSector {\n  id: string\n  name: string\n  change: number\n  changePercent: number\n  marketCap: number\n  volume: number\n  symbolCount: number\n  children?: MarketSymbol[]\n}\n\nexport interface MarketSymbol {\n  id: string\n  symbol: string\n  name: string\n  price: number\n  change: number\n  changePercent: number\n  marketCap: number\n  volume: number\n  sector: string\n}\n\nexport interface MarketHeatmapData {\n  sectors: MarketSector[]\n  lastUpdated: string\n}\n\ninterface MarketHeatmapProps {\n  data?: MarketHeatmapData\n  loading?: boolean\n  timeframe?: Timeframe\n  onTimeframeChange?: (timeframe: Timeframe) => void\n  onRefresh?: () => void\n  className?: string\n}\n\nconst TIMEFRAMES: Timeframe[] = ['1D', '1W', '1M', '3M', 'YTD', '1Y', 'ALL']\n\nfunction formatNumber(num: number): string {\n  if (num >= 1e12) return `${(num / 1e12).toFixed(2)}T`\n  if (num >= 1e9) return `${(num / 1e9).toFixed(2)}B`\n  if (num >= 1e6) return `${(num / 1e6).toFixed(2)}M`\n  if (num >= 1e3) return `${(num / 1e3).toFixed(2)}K`\n  return num.toFixed(2)\n}\n\nfunction formatPercent(value: number): string {\n  const sign = value >= 0 ? '+' : ''\n  return `${sign}${value.toFixed(2)}%`\n}\n\ninterface TreemapNodeProps {\n  node: MarketSector | MarketSymbol\n  level: number\n  totalSize: number\n  onNavigate: (node: MarketSector | MarketSymbol, level: number) => void\n  currentLevel: number\n}\n\nfunction TreemapNode({ node, level, totalSize, onNavigate, currentLevel }: TreemapNodeProps) {\n  const isPositive = node.change >= 0\n  const intensity = Math.min(Math.abs(node.changePercent) / 5, 1)\n  const baseColor = isPositive ? '22' : 'ef'\n  const alpha = Math.round(40 + intensity * 60).toString(16)\n  const bgColor = `#${baseColor}55${alpha}`\n\n  const size = Math.max((node.marketCap / totalSize) * 100, 5)\n\n  const isDrillable = 'children' in node && node.children && node.children.length > 0\n  const isSector = 'children' in node\n\n  const handleClick = () => {\n    if (isDrillable) {\n      onNavigate(node, level)\n    }\n  }\n\n  const displaySymbol = 'symbol' in node ? node.symbol : node.name.substring(0, 4).toUpperCase()\n  const displayName = 'symbol' in node ? node.name : node.name\n  const displayChange = formatPercent(node.changePercent)\n\n  return (\n    <Tooltip delayDuration={200}>\n      <TooltipTrigger asChild>\n        <div\n          className={cn(\n            'relative flex flex-col items-start justify-between p-3 cursor-pointer transition-all duration-200 hover:z-10 hover:scale-[1.02]',\n            isDrillable && 'cursor-pointer hover:ring-2 hover:ring-foreground',\n            currentLevel > level && currentLevel === level + 1 && node.id === 'back'\n          )}\n          style={{\n            backgroundColor: node.id === 'back' ? 'transparent' : bgColor,\n            border: node.id === 'back' ? '2px dashed hsl(var(--foreground) / 0.3)' : '1px solid hsl(var(--foreground) / 0.1)',\n            flexGrow: size,\n            minHeight: node.id === 'back' ? '40px' : '60px',\n          }}\n          onClick={handleClick}\n        >\n          {node.id === 'back' ? (\n            <div className=\"flex items-center gap-2 text-muted-foreground\">\n              <ArrowLeft className=\"h-4 w-4\" />\n              <span className=\"text-sm font-bold uppercase\">Back</span>\n            </div>\n          ) : (\n            <>\n              <div className=\"flex items-center justify-between w-full gap-1\">\n                <span className=\"font-black text-sm uppercase truncate max-w-[80%]\">\n                  {displaySymbol}\n                </span>\n                {isPositive ? (\n                  <TrendingUp className=\"h-3 w-3 text-green-500 shrink-0\" />\n                ) : (\n                  <TrendingDown className=\"h-3 w-3 text-red-500 shrink-0\" />\n                )}\n              </div>\n              <div className=\"flex items-center justify-between w-full gap-1\">\n                <span className={cn(\n                  'text-xs font-mono font-bold',\n                  isPositive ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'\n                )}>\n                  {displayChange}\n                </span>\n                <span className=\"text-[10px] text-muted-foreground font-mono truncate\">\n                  {formatNumber(node.marketCap)}\n                </span>\n              </div>\n              {'children' in node && (\n                <div className=\"absolute bottom-1 right-1\">\n                  <ChevronDown className=\"h-3 w-3 text-muted-foreground opacity-50\" />\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </TooltipTrigger>\n      <TooltipContent\n        side=\"top\"\n        align=\"start\"\n        className=\"bg-background border-2 border-foreground p-4 shadow-[4px_4px_0px_0px_var(--foreground)] rounded-none max-w-xs\"\n      >\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"font-black uppercase\">{displaySymbol}</span>\n            <span className={cn(\n              'font-mono font-bold px-2 py-0.5 text-xs',\n              isPositive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\n            )}>\n              {displayChange}\n            </span>\n          </div>\n          <p className=\"text-sm text-muted-foreground font-medium\">{displayName}</p>\n          <div className=\"grid grid-cols-2 gap-2 text-xs\">\n            <div>\n              <span className=\"text-muted-foreground\">Market Cap:</span>\n              <span className=\"font-mono font-bold ml-2\">${formatNumber(node.marketCap)}</span>\n            </div>\n            <div>\n              <span className=\"text-muted-foreground\">Volume:</span>\n              <span className=\"font-mono font-bold ml-2\">{formatNumber(node.volume)}</span>\n            </div>\n            {'children' in node && (\n              <>\n                <div>\n                  <span className=\"text-muted-foreground\">Symbols:</span>\n                  <span className=\"font-mono font-bold ml-2\">{node.symbolCount}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground\">Change:</span>\n                  <span className={cn(\n                    'font-mono font-bold ml-2',\n                    isPositive ? 'text-green-600' : 'text-red-600'\n                  )}>\n                    {isPositive ? '+' : ''}{node.change.toFixed(2)}\n                  </span>\n                </div>\n              </>\n            )}\n          </div>\n          {isDrillable && (\n            <p className=\"text-[10px] text-muted-foreground uppercase font-bold\">Click to drill down</p>\n          )}\n        </div>\n      </TooltipContent>\n    </Tooltip>\n  )\n}\n\nfunction TreemapLayout({\n  items,\n  onNavigate,\n  level,\n  currentLevel,\n}: {\n  items: (MarketSector | MarketSymbol)[]\n  onNavigate: (node: MarketSector | MarketSymbol, level: number) => void\n  level: number\n  currentLevel: number\n}) {\n  const totalSize = useMemo(() =>\n    items.reduce((sum, item) => sum + item.marketCap, 0),\n    [items]\n  )\n\n  const sectors = items.filter((item): item is MarketSector => 'children' in item)\n  const symbols = items.filter((item): item is MarketSymbol => !('children' in item))\n\n  if (currentLevel > level) {\n    const backNode: MarketSector = {\n      id: 'back',\n      name: 'Back',\n      change: 0,\n      changePercent: 0,\n      marketCap: 0,\n      volume: 0,\n      symbolCount: 0,\n    }\n    return (\n      <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-1\">\n        <TreemapNode\n          node={backNode}\n          level={level}\n          totalSize={totalSize}\n          onNavigate={onNavigate}\n          currentLevel={currentLevel}\n        />\n        {symbols.slice(0, 17).map((symbol) => (\n          <TreemapNode\n            key={symbol.id}\n            node={symbol}\n            level={level}\n            totalSize={totalSize}\n            onNavigate={onNavigate}\n            currentLevel={currentLevel}\n          />\n        ))}\n      </div>\n    )\n  }\n\n  if (sectors.length > 0) {\n    return (\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1\">\n        {sectors.map((sector) => (\n          <TreemapNode\n            key={sector.id}\n            node={sector}\n            level={level}\n            totalSize={totalSize}\n            onNavigate={onNavigate}\n            currentLevel={currentLevel}\n          />\n        ))}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-1\">\n      {symbols.slice(0, 24).map((symbol) => (\n        <TreemapNode\n          key={symbol.id}\n          node={symbol}\n          level={level}\n          totalSize={totalSize}\n          onNavigate={onNavigate}\n          currentLevel={currentLevel}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport function MarketHeatmap({\n  data,\n  loading = false,\n  timeframe = '1D',\n  onTimeframeChange,\n  onRefresh,\n  className,\n}: MarketHeatmapProps) {\n  const [currentLevel, setCurrentLevel] = useState(0)\n  const [selectedSector, setSelectedSector] = useState<MarketSector | null>(null)\n  const [isExporting, setIsExporting] = useState(false)\n  const { downloadCSV, downloadText } = useDownloadFile()\n\n  const handleNavigate = useCallback((node: MarketSector | MarketSymbol, level: number) => {\n    if ('children' in node && node.children && node.children.length > 0) {\n      setSelectedSector(node as MarketSector)\n      setCurrentLevel(level + 1)\n    }\n  }, [])\n\n  const handleBack = useCallback(() => {\n    setCurrentLevel(0)\n    setSelectedSector(null)\n  }, [])\n\n  const handleExportPNG = useCallback(async () => {\n    setIsExporting(true)\n    try {\n      const element = document.querySelector('.border-2.border-foreground.overflow-hidden') as HTMLElement\n      if (element && typeof window !== 'undefined') {\n        const html2canvasModule = await import('html2canvas')\n        const html2canvas = html2canvasModule.default\n        const canvas = await html2canvas(element, {\n          scale: 2,\n          backgroundColor: null,\n          logging: false,\n        })\n        \n        const filename = `market-heatmap-${timeframe}-${new Date().toISOString().slice(0, 10)}.png`\n        const dataUrl = canvas.toDataURL('image/png')\n        downloadText(dataUrl, filename, 'image/png')\n      }\n    } catch (err) {\n      console.error('Failed to export PNG:', err)\n    } finally {\n      setIsExporting(false)\n    }\n  }, [timeframe, downloadText])\n\n  const handleExportCSV = useCallback(() => {\n    if (!data) return\n    \n    const flattenData = (items: (MarketSector | MarketSymbol)[], level = 0): Record<string, any>[] => {\n      return items.flatMap(item => {\n        const base: Record<string, any> = {\n          name: item.name,\n          change: item.change,\n          changePercent: item.changePercent,\n          marketCap: item.marketCap,\n          volume: item.volume,\n          type: 'children' in item ? 'sector' : 'symbol',\n          level,\n        }\n        if ('children' in item && item.children) {\n          return [base, ...flattenData(item.children, level + 1)]\n        }\n        return [base]\n      })\n    }\n    \n    const csv = [\n      ['Name', 'Type', 'Change', 'Change %', 'Market Cap', 'Volume', 'Level'].join(','),\n      ...flattenData(currentLevel === 0 ? data.sectors : (selectedSector?.children || [])).map(row =>\n        [row.name, row.type, row.change, row.changePercent, row.marketCap, row.volume, row.level].join(',')\n      )\n    ].join('\\n')\n    \n    const filename = `market-heatmap-${timeframe}-${new Date().toISOString().slice(0, 10)}.csv`\n    downloadCSV(csv, filename)\n  }, [data, timeframe, currentLevel, selectedSector, downloadCSV])\n\n  const displayData = useMemo(() => {\n    if (!data) return null\n    if (currentLevel === 0) {\n      return data.sectors\n    }\n    return selectedSector?.children || []\n  }, [data, currentLevel, selectedSector])\n\n  const allPositive = displayData?.every(item => item.change >= 0)\n  const allNegative = displayData?.every(item => item.change < 0)\n\n  if (loading) {\n    return (\n      <Card className={cn('border-2 border-foreground', className)}>\n        <CardHeader className=\"border-b-2 border-foreground bg-muted/30\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-1\">\n              <Skeleton className=\"h-6 w-48\" />\n              <Skeleton className=\"h-4 w-32\" />\n            </div>\n            <div className=\"flex gap-2\">\n              <Skeleton className=\"h-8 w-16\" />\n              <Skeleton className=\"h-8 w-16\" />\n              <Skeleton className=\"h-8 w-16\" />\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent className=\"p-4\">\n          <div className=\"grid grid-cols-4 gap-4\">\n            {[...Array(8)].map((_, i) => (\n              <Skeleton key={i} className=\"h-24 w-full\" />\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card className={cn('border-2 border-foreground overflow-hidden', className)}>\n      <CardHeader className=\"border-b-2 border-foreground bg-muted/30 py-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            {currentLevel > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleBack}\n                className=\"h-8 px-2 border border-foreground/20 hover:bg-foreground hover:text-background\"\n              >\n                <ArrowLeft className=\"h-4 w-4 mr-1\" />\n                Back\n              </Button>\n            )}\n            <div>\n              <CardTitle className=\"text-lg font-black uppercase italic flex items-center gap-2\">\n                <TrendingUp className=\"h-5 w-5\" />\n                Market_Heatmap\n              </CardTitle>\n              <p className=\"text-xs font-mono text-muted-foreground\">\n                {currentLevel > 0 ? selectedSector?.name : 'S&P 500 Sectors'}\n              </p>\n            </div>\n          </div>\n\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex items-center border border-foreground/20\">\n                {TIMEFRAMES.map((tf) => (\n                  <Button\n                    key={tf}\n                    variant={timeframe === tf ? 'default' : 'ghost'}\n                    size=\"sm\"\n                    onClick={() => onTimeframeChange?.(tf)}\n                    className={cn(\n                      'h-8 px-3 text-xs font-black uppercase rounded-none border-r border-foreground/20 last:border-r-0',\n                      timeframe === tf && 'bg-foreground text-background'\n                    )}\n                  >\n                    {tf}\n                  </Button>\n                ))}\n              </div>\n\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={onRefresh}\n                className=\"h-8 w-8 border border-foreground/20\"\n              >\n                <RefreshCw className=\"h-4 w-4\" />\n              </Button>\n\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-8 w-8 border border-foreground/20\"\n                    disabled={isExporting}\n                  >\n                    <Download className=\"h-4 w-4\" />\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuItem onClick={handleExportPNG} disabled={isExporting}>\n                    <FileImage className=\"h-4 w-4 mr-2\" />\n                    Export as PNG\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={handleExportCSV} disabled={!data}>\n                    <FileText className=\"h-4 w-4 mr-2\" />\n                    Export as CSV\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"p-4 bg-muted/5\">\n        <TooltipProvider>\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between text-xs\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"font-black uppercase text-muted-foreground\">Legend:</span>\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"w-4 h-4 bg-green-500/50 border border-foreground/20\" />\n                    <span className=\"font-mono uppercase\">Gainers</span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"w-4 h-4 bg-red-500/50 border border-foreground/20\" />\n                    <span className=\"font-mono uppercase\">Losers</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-mono text-[10px] uppercase text-muted-foreground\">\n                  Size = Market Cap\n                </span>\n              </div>\n            </div>\n\n            {displayData && displayData.length > 0 ? (\n              <TreemapLayout\n                items={displayData}\n                onNavigate={handleNavigate}\n                level={0}\n                currentLevel={currentLevel}\n              />\n            ) : (\n              <div className=\"h-[400px] flex items-center justify-center bg-muted/30 border-2 border-dashed border-foreground/20\">\n                <div className=\"text-center\">\n                  <TrendingUp className=\"h-12 w-12 mx-auto text-muted-foreground/50 mb-2\" />\n                  <p className=\"font-black uppercase text-muted-foreground\">No Data Available</p>\n                  <p className=\"text-xs font-mono text-muted-foreground\">Select a timeframe to view market data</p>\n                </div>\n              </div>\n            )}\n          </div>\n        </TooltipProvider>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport function MarketHeatmapSkeleton() {\n  return (\n    <Card className=\"border-2 border-foreground\">\n      <CardHeader className=\"border-b-2 border-foreground bg-muted/30\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"space-y-1\">\n            <Skeleton className=\"h-6 w-48\" />\n            <Skeleton className=\"h-4 w-32\" />\n          </div>\n          <div className=\"flex gap-2\">\n            <Skeleton className=\"h-8 w-16\" />\n            <Skeleton className=\"h-8 w-16\" />\n            <Skeleton className=\"h-8 w-16\" />\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-4\">\n        <div className=\"grid grid-cols-4 gap-4\">\n          {[...Array(8)].map((_, i) => (\n            <Skeleton key={i} className=\"h-24 w-full\" />\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA;AACA;AACA;AACA;AACA;AAMA;AACA;;;AAhCA;;;;;;;;;;AAyEA,MAAM,aAA0B;IAAC;IAAM;IAAM;IAAM;IAAM;IAAO;IAAM;CAAM;AAE5E,SAAS,aAAa,GAAW;IAC/B,IAAI,OAAO,MAAM,OAAO,GAAG,CAAC,MAAM,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACrD,IAAI,OAAO,KAAK,OAAO,GAAG,CAAC,MAAM,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACnD,IAAI,OAAO,KAAK,OAAO,GAAG,CAAC,MAAM,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACnD,IAAI,OAAO,KAAK,OAAO,GAAG,CAAC,MAAM,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACnD,OAAO,IAAI,OAAO,CAAC;AACrB;AAEA,SAAS,cAAc,KAAa;IAClC,MAAM,OAAO,SAAS,IAAI,MAAM;IAChC,OAAO,GAAG,OAAO,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC;AACtC;AAUA,SAAS,YAAY,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,UAAU,EAAE,YAAY,EAAoB;IACzF,MAAM,aAAa,KAAK,MAAM,IAAI;IAClC,MAAM,YAAY,KAAK,GAAG,CAAC,KAAK,GAAG,CAAC,KAAK,aAAa,IAAI,GAAG;IAC7D,MAAM,YAAY,aAAa,OAAO;IACtC,MAAM,QAAQ,KAAK,KAAK,CAAC,KAAK,YAAY,IAAI,QAAQ,CAAC;IACvD,MAAM,UAAU,CAAC,CAAC,EAAE,UAAU,EAAE,EAAE,OAAO;IAEzC,MAAM,OAAO,KAAK,GAAG,CAAC,AAAC,KAAK,SAAS,GAAG,YAAa,KAAK;IAE1D,MAAM,cAAc,cAAc,QAAQ,KAAK,QAAQ,IAAI,KAAK,QAAQ,CAAC,MAAM,GAAG;IAClF,MAAM,WAAW,cAAc;IAE/B,MAAM,cAAc;QAClB,IAAI,aAAa;YACf,WAAW,MAAM;QACnB;IACF;IAEA,MAAM,gBAAgB,YAAY,OAAO,KAAK,MAAM,GAAG,KAAK,IAAI,CAAC,SAAS,CAAC,GAAG,GAAG,WAAW;IAC5F,MAAM,cAAc,YAAY,OAAO,KAAK,IAAI,GAAG,KAAK,IAAI;IAC5D,MAAM,gBAAgB,cAAc,KAAK,aAAa;IAEtD,qBACE,iNAAC,qKAAO;QAAC,eAAe;;0BACtB,iNAAC,4KAAc;gBAAC,OAAO;0BACrB,cAAA,iNAAC;oBACC,WAAW,IAAA,gJAAE,EACX,mIACA,eAAe,qDACf,eAAe,SAAS,iBAAiB,QAAQ,KAAK,KAAK,EAAE,KAAK;oBAEpE,OAAO;wBACL,iBAAiB,KAAK,EAAE,KAAK,SAAS,gBAAgB;wBACtD,QAAQ,KAAK,EAAE,KAAK,SAAS,4CAA4C;wBACzE,UAAU;wBACV,WAAW,KAAK,EAAE,KAAK,SAAS,SAAS;oBAC3C;oBACA,SAAS;8BAER,KAAK,EAAE,KAAK,uBACX,iNAAC;wBAAI,WAAU;;0CACb,iNAAC,2PAAS;gCAAC,WAAU;;;;;;0CACrB,iNAAC;gCAAK,WAAU;0CAA8B;;;;;;;;;;;6CAGhD;;0CACE,iNAAC;gCAAI,WAAU;;kDACb,iNAAC;wCAAK,WAAU;kDACb;;;;;;oCAEF,2BACC,iNAAC,8PAAU;wCAAC,WAAU;;;;;6DAEtB,iNAAC,oQAAY;wCAAC,WAAU;;;;;;;;;;;;0CAG5B,iNAAC;gCAAI,WAAU;;kDACb,iNAAC;wCAAK,WAAW,IAAA,gJAAE,EACjB,+BACA,aAAa,uCAAuC;kDAEnD;;;;;;kDAEH,iNAAC;wCAAK,WAAU;kDACb,aAAa,KAAK,SAAS;;;;;;;;;;;;4BAG/B,cAAc,sBACb,iNAAC;gCAAI,WAAU;0CACb,cAAA,iNAAC,iQAAW;oCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;0BAOnC,iNAAC,4KAAc;gBACb,MAAK;gBACL,OAAM;gBACN,WAAU;0BAEV,cAAA,iNAAC;oBAAI,WAAU;;sCACb,iNAAC;4BAAI,WAAU;;8CACb,iNAAC;oCAAK,WAAU;8CAAwB;;;;;;8CACxC,iNAAC;oCAAK,WAAW,IAAA,gJAAE,EACjB,2CACA,aAAa,gCAAgC;8CAE5C;;;;;;;;;;;;sCAGL,iNAAC;4BAAE,WAAU;sCAA6C;;;;;;sCAC1D,iNAAC;4BAAI,WAAU;;8CACb,iNAAC;;sDACC,iNAAC;4CAAK,WAAU;sDAAwB;;;;;;sDACxC,iNAAC;4CAAK,WAAU;;gDAA2B;gDAAE,aAAa,KAAK,SAAS;;;;;;;;;;;;;8CAE1E,iNAAC;;sDACC,iNAAC;4CAAK,WAAU;sDAAwB;;;;;;sDACxC,iNAAC;4CAAK,WAAU;sDAA4B,aAAa,KAAK,MAAM;;;;;;;;;;;;gCAErE,cAAc,sBACb;;sDACE,iNAAC;;8DACC,iNAAC;oDAAK,WAAU;8DAAwB;;;;;;8DACxC,iNAAC;oDAAK,WAAU;8DAA4B,KAAK,WAAW;;;;;;;;;;;;sDAE9D,iNAAC;;8DACC,iNAAC;oDAAK,WAAU;8DAAwB;;;;;;8DACxC,iNAAC;oDAAK,WAAW,IAAA,gJAAE,EACjB,4BACA,aAAa,mBAAmB;;wDAE/B,aAAa,MAAM;wDAAI,KAAK,MAAM,CAAC,OAAO,CAAC;;;;;;;;;;;;;;;;;;;;;wBAMrD,6BACC,iNAAC;4BAAE,WAAU;sCAAwD;;;;;;;;;;;;;;;;;;;;;;;AAMjF;KA9HS;AAgIT,SAAS,cAAc,EACrB,KAAK,EACL,UAAU,EACV,KAAK,EACL,YAAY,EAMb;;IACC,MAAM,YAAY,IAAA,4LAAO;4CAAC,IACxB,MAAM,MAAM;oDAAC,CAAC,KAAK,OAAS,MAAM,KAAK,SAAS;mDAAE;2CAClD;QAAC;KAAM;IAGT,MAAM,UAAU,MAAM,MAAM,CAAC,CAAC,OAA+B,cAAc;IAC3E,MAAM,UAAU,MAAM,MAAM,CAAC,CAAC,OAA+B,CAAC,CAAC,cAAc,IAAI;IAEjF,IAAI,eAAe,OAAO;QACxB,MAAM,WAAyB;YAC7B,IAAI;YACJ,MAAM;YACN,QAAQ;YACR,eAAe;YACf,WAAW;YACX,QAAQ;YACR,aAAa;QACf;QACA,qBACE,iNAAC;YAAI,WAAU;;8BACb,iNAAC;oBACC,MAAM;oBACN,OAAO;oBACP,WAAW;oBACX,YAAY;oBACZ,cAAc;;;;;;gBAEf,QAAQ,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,uBACzB,iNAAC;wBAEC,MAAM;wBACN,OAAO;wBACP,WAAW;wBACX,YAAY;wBACZ,cAAc;uBALT,OAAO,EAAE;;;;;;;;;;;IAUxB;IAEA,IAAI,QAAQ,MAAM,GAAG,GAAG;QACtB,qBACE,iNAAC;YAAI,WAAU;sBACZ,QAAQ,GAAG,CAAC,CAAC,uBACZ,iNAAC;oBAEC,MAAM;oBACN,OAAO;oBACP,WAAW;oBACX,YAAY;oBACZ,cAAc;mBALT,OAAO,EAAE;;;;;;;;;;IAUxB;IAEA,qBACE,iNAAC;QAAI,WAAU;kBACZ,QAAQ,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,uBACzB,iNAAC;gBAEC,MAAM;gBACN,OAAO;gBACP,WAAW;gBACX,YAAY;gBACZ,cAAc;eALT,OAAO,EAAE;;;;;;;;;;AAUxB;GAnFS;MAAA;AAqFF,SAAS,cAAc,EAC5B,IAAI,EACJ,UAAU,KAAK,EACf,YAAY,IAAI,EAChB,iBAAiB,EACjB,SAAS,EACT,SAAS,EACU;;IACnB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6LAAQ,EAAC;IACjD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,6LAAQ,EAAsB;IAC1E,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6LAAQ,EAAC;IAC/C,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,GAAG,IAAA,qKAAe;IAErD,MAAM,iBAAiB,IAAA,gMAAW;qDAAC,CAAC,MAAmC;YACrE,IAAI,cAAc,QAAQ,KAAK,QAAQ,IAAI,KAAK,QAAQ,CAAC,MAAM,GAAG,GAAG;gBACnE,kBAAkB;gBAClB,gBAAgB,QAAQ;YAC1B;QACF;oDAAG,EAAE;IAEL,MAAM,aAAa,IAAA,gMAAW;iDAAC;YAC7B,gBAAgB;YAChB,kBAAkB;QACpB;gDAAG,EAAE;IAEL,MAAM,kBAAkB,IAAA,gMAAW;sDAAC;YAClC,eAAe;YACf,IAAI;gBACF,MAAM,UAAU,SAAS,aAAa,CAAC;gBACvC,IAAI,WAAW,+CAAkB,aAAa;oBAC5C,MAAM,oBAAoB;oBAC1B,MAAM,cAAc,kBAAkB,OAAO;oBAC7C,MAAM,SAAS,MAAM,YAAY,SAAS;wBACxC,OAAO;wBACP,iBAAiB;wBACjB,SAAS;oBACX;oBAEA,MAAM,WAAW,CAAC,eAAe,EAAE,UAAU,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC;oBAC3F,MAAM,UAAU,OAAO,SAAS,CAAC;oBACjC,aAAa,SAAS,UAAU;gBAClC;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,yBAAyB;YACzC,SAAU;gBACR,eAAe;YACjB;QACF;qDAAG;QAAC;QAAW;KAAa;IAE5B,MAAM,kBAAkB,IAAA,gMAAW;sDAAC;YAClC,IAAI,CAAC,MAAM;YAEX,MAAM;0EAAc,CAAC,OAAwC,QAAQ,CAAC;oBACpE,OAAO,MAAM,OAAO;kFAAC,CAAA;4BACnB,MAAM,OAA4B;gCAChC,MAAM,KAAK,IAAI;gCACf,QAAQ,KAAK,MAAM;gCACnB,eAAe,KAAK,aAAa;gCACjC,WAAW,KAAK,SAAS;gCACzB,QAAQ,KAAK,MAAM;gCACnB,MAAM,cAAc,OAAO,WAAW;gCACtC;4BACF;4BACA,IAAI,cAAc,QAAQ,KAAK,QAAQ,EAAE;gCACvC,OAAO;oCAAC;uCAAS,YAAY,KAAK,QAAQ,EAAE,QAAQ;iCAAG;4BACzD;4BACA,OAAO;gCAAC;6BAAK;wBACf;;gBACF;;YAEA,MAAM,MAAM;gBACV;oBAAC;oBAAQ;oBAAQ;oBAAU;oBAAY;oBAAc;oBAAU;iBAAQ,CAAC,IAAI,CAAC;mBAC1E,YAAY,iBAAiB,IAAI,KAAK,OAAO,GAAI,gBAAgB,YAAY,EAAE,EAAG,GAAG;sEAAC,CAAA,MACvF;4BAAC,IAAI,IAAI;4BAAE,IAAI,IAAI;4BAAE,IAAI,MAAM;4BAAE,IAAI,aAAa;4BAAE,IAAI,SAAS;4BAAE,IAAI,MAAM;4BAAE,IAAI,KAAK;yBAAC,CAAC,IAAI,CAAC;;aAElG,CAAC,IAAI,CAAC;YAEP,MAAM,WAAW,CAAC,eAAe,EAAE,UAAU,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC;YAC3F,YAAY,KAAK;QACnB;qDAAG;QAAC;QAAM;QAAW;QAAc;QAAgB;KAAY;IAE/D,MAAM,cAAc,IAAA,4LAAO;8CAAC;YAC1B,IAAI,CAAC,MAAM,OAAO;YAClB,IAAI,iBAAiB,GAAG;gBACtB,OAAO,KAAK,OAAO;YACrB;YACA,OAAO,gBAAgB,YAAY,EAAE;QACvC;6CAAG;QAAC;QAAM;QAAc;KAAe;IAEvC,MAAM,cAAc,aAAa,MAAM,CAAA,OAAQ,KAAK,MAAM,IAAI;IAC9D,MAAM,cAAc,aAAa,MAAM,CAAA,OAAQ,KAAK,MAAM,GAAG;IAE7D,IAAI,SAAS;QACX,qBACE,iNAAC,+JAAI;YAAC,WAAW,IAAA,gJAAE,EAAC,8BAA8B;;8BAChD,iNAAC,qKAAU;oBAAC,WAAU;8BACpB,cAAA,iNAAC;wBAAI,WAAU;;0CACb,iNAAC;gCAAI,WAAU;;kDACb,iNAAC,uKAAQ;wCAAC,WAAU;;;;;;kDACpB,iNAAC,uKAAQ;wCAAC,WAAU;;;;;;;;;;;;0CAEtB,iNAAC;gCAAI,WAAU;;kDACb,iNAAC,uKAAQ;wCAAC,WAAU;;;;;;kDACpB,iNAAC,uKAAQ;wCAAC,WAAU;;;;;;kDACpB,iNAAC,uKAAQ;wCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;8BAI1B,iNAAC,sKAAW;oBAAC,WAAU;8BACrB,cAAA,iNAAC;wBAAI,WAAU;kCACZ;+BAAI,MAAM;yBAAG,CAAC,GAAG,CAAC,CAAC,GAAG,kBACrB,iNAAC,uKAAQ;gCAAS,WAAU;+BAAb;;;;;;;;;;;;;;;;;;;;;IAM3B;IAEA,qBACE,iNAAC,+JAAI;QAAC,WAAW,IAAA,gJAAE,EAAC,8CAA8C;;0BAChE,iNAAC,qKAAU;gBAAC,WAAU;0BACpB,cAAA,iNAAC;oBAAI,WAAU;;sCACb,iNAAC;4BAAI,WAAU;;gCACZ,eAAe,mBACd,iNAAC,mKAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,SAAS;oCACT,WAAU;;sDAEV,iNAAC,2PAAS;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAI1C,iNAAC;;sDACC,iNAAC,oKAAS;4CAAC,WAAU;;8DACnB,iNAAC,8PAAU;oDAAC,WAAU;;;;;;gDAAY;;;;;;;sDAGpC,iNAAC;4CAAE,WAAU;sDACV,eAAe,IAAI,gBAAgB,OAAO;;;;;;;;;;;;;;;;;;sCAK/C,iNAAC;4BAAI,WAAU;;8CACb,iNAAC;oCAAI,WAAU;8CACZ,WAAW,GAAG,CAAC,CAAC,mBACf,iNAAC,mKAAM;4CAEL,SAAS,cAAc,KAAK,YAAY;4CACxC,MAAK;4CACL,SAAS,IAAM,oBAAoB;4CACnC,WAAW,IAAA,gJAAE,EACX,oGACA,cAAc,MAAM;sDAGrB;2CATI;;;;;;;;;;8CAcX,iNAAC,mKAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,SAAS;oCACT,WAAU;8CAEV,cAAA,iNAAC,2PAAS;wCAAC,WAAU;;;;;;;;;;;8CAGvB,iNAAC,mLAAY;;sDACX,iNAAC,0LAAmB;4CAAC,OAAO;sDAC1B,cAAA,iNAAC,mKAAM;gDACL,SAAQ;gDACR,MAAK;gDACL,WAAU;gDACV,UAAU;0DAEV,cAAA,iNAAC,oPAAQ;oDAAC,WAAU;;;;;;;;;;;;;;;;sDAGxB,iNAAC,0LAAmB;4CAAC,OAAM;;8DACzB,iNAAC,uLAAgB;oDAAC,SAAS;oDAAiB,UAAU;;sEACpD,iNAAC,2PAAS;4DAAC,WAAU;;;;;;wDAAiB;;;;;;;8DAGxC,iNAAC,uLAAgB;oDAAC,SAAS;oDAAiB,UAAU,CAAC;;sEACrD,iNAAC,wPAAQ;4DAAC,WAAU;;;;;;wDAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BASnD,iNAAC,sKAAW;gBAAC,WAAU;0BACrB,cAAA,iNAAC,6KAAe;8BACd,cAAA,iNAAC;wBAAI,WAAU;;0CACb,iNAAC;gCAAI,WAAU;;kDACb,iNAAC;wCAAI,WAAU;kDACb,cAAA,iNAAC;4CAAI,WAAU;;8DACb,iNAAC;oDAAK,WAAU;8DAA6C;;;;;;8DAC7D,iNAAC;oDAAI,WAAU;;sEACb,iNAAC;4DAAI,WAAU;;;;;;sEACf,iNAAC;4DAAK,WAAU;sEAAsB;;;;;;;;;;;;8DAExC,iNAAC;oDAAI,WAAU;;sEACb,iNAAC;4DAAI,WAAU;;;;;;sEACf,iNAAC;4DAAK,WAAU;sEAAsB;;;;;;;;;;;;;;;;;;;;;;;kDAK5C,iNAAC;wCAAI,WAAU;kDACb,cAAA,iNAAC;4CAAK,WAAU;sDAAwD;;;;;;;;;;;;;;;;;4BAM3E,eAAe,YAAY,MAAM,GAAG,kBACnC,iNAAC;gCACC,OAAO;gCACP,YAAY;gCACZ,OAAO;gCACP,cAAc;;;;;qDAGhB,iNAAC;gCAAI,WAAU;0CACb,cAAA,iNAAC;oCAAI,WAAU;;sDACb,iNAAC,8PAAU;4CAAC,WAAU;;;;;;sDACtB,iNAAC;4CAAE,WAAU;sDAA6C;;;;;;sDAC1D,iNAAC;4CAAE,WAAU;sDAA0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASzE;IArPgB;;QAWwB,qKAAe;;;MAXvC;AAuPT,SAAS;IACd,qBACE,iNAAC,+JAAI;QAAC,WAAU;;0BACd,iNAAC,qKAAU;gBAAC,WAAU;0BACpB,cAAA,iNAAC;oBAAI,WAAU;;sCACb,iNAAC;4BAAI,WAAU;;8CACb,iNAAC,uKAAQ;oCAAC,WAAU;;;;;;8CACpB,iNAAC,uKAAQ;oCAAC,WAAU;;;;;;;;;;;;sCAEtB,iNAAC;4BAAI,WAAU;;8CACb,iNAAC,uKAAQ;oCAAC,WAAU;;;;;;8CACpB,iNAAC,uKAAQ;oCAAC,WAAU;;;;;;8CACpB,iNAAC,uKAAQ;oCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;0BAI1B,iNAAC,sKAAW;gBAAC,WAAU;0BACrB,cAAA,iNAAC;oBAAI,WAAU;8BACZ;2BAAI,MAAM;qBAAG,CAAC,GAAG,CAAC,CAAC,GAAG,kBACrB,iNAAC,uKAAQ;4BAAS,WAAU;2BAAb;;;;;;;;;;;;;;;;;;;;;AAM3B;MAzBgB"}},
    {"offset": {"line": 7524, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/CandlestickChart.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react'\nimport {\n  createChart,\n  IChartApi,\n  ISeriesApi,\n  ColorType,\n  CrosshairMode,\n  Time,\n  MouseEventParams,\n} from 'lightweight-charts'\nimport { useTheme } from 'next-themes'\nimport { Card } from '@/components/ui/card'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  Download,\n  RefreshCw,\n  TrendingUp,\n  TrendingDown,\n  Maximize2,\n  Minimize2,\n} from 'lucide-react'\nimport { useDownload } from '@/hooks/useDownload'\nimport { cn } from '@/lib/utils'\n\nexport type Timeframe = '1m' | '5m' | '15m' | '1h' | '4h' | '1d' | '1w' | '1M'\n\nexport interface CandlestickData {\n  time: Time\n  open: number\n  high: number\n  low: number\n  close: number\n  volume?: number\n}\n\ninterface CandlestickChartProps {\n  data?: CandlestickData[]\n  symbol?: string\n  timeframe?: Timeframe\n  height?: number\n  showVolume?: boolean\n  showToolbar?: boolean\n  className?: string\n}\n\nexport function CandlestickChart({\n  data: externalData,\n  symbol = 'BTC/USD',\n  timeframe: initialTimeframe = '1h',\n  height = 400,\n  showVolume = true,\n  showToolbar = true,\n  className,\n}: CandlestickChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n  const candlestickSeriesRef = useRef<ISeriesApi<'Candlestick'> | null>(null)\n  const volumeSeriesRef = useRef<ISeriesApi<'Histogram'> | null>(null)\n  \n  const { theme } = useTheme()\n  const { download } = useDownload()\n  \n  const [timeframe, setTimeframe] = useState<Timeframe>(initialTimeframe)\n  const [isLoading, setIsLoading] = useState(false)\n  const [isFullscreen, setIsFullscreen] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  const colors = useMemo(() => ({\n    background: theme === 'dark' ? '#0a0a0a' : '#ffffff',\n    grid: theme === 'dark' ? '#1a1a1a' : '#e5e5e5',\n    text: theme === 'dark' ? '#a0a0a0' : '#666666',\n    upColor: '#26a69a',\n    downColor: '#ef5350',\n    wickUpColor: '#26a69a',\n    wickDownColor: '#ef5350',\n    volumeUpColor: 'rgba(38, 166, 154, 0.5)',\n    volumeDownColor: 'rgba(239, 83, 80, 0.5)',\n  }), [theme])\n\n  const data = useMemo(() => {\n    if (externalData) return externalData\n    \n    const mockData: CandlestickData[] = []\n    let price = 50000 + Math.random() * 5000\n    const now = Date.now()\n    const interval = 60000\n    \n    for (let i = 0; i < 200; i++) {\n      const time = Math.floor((now - (200 - i) * interval) / 1000) as Time\n      const volatility = 0.02\n      \n      const open = price\n      const change = (Math.random() - 0.5) * volatility * price\n      const close = open + change\n      const high = Math.max(open, close) + Math.random() * volatility * price * 0.5\n      const low = Math.min(open, close) - Math.random() * volatility * price * 0.5\n      const volume = Math.floor(Math.random() * 1000000) + 100000\n      \n      mockData.push({\n        time,\n        open,\n        high,\n        low,\n        close,\n        volume,\n      })\n      \n      price = close\n    }\n    \n    return mockData\n  }, [externalData, symbol, timeframe])\n\n  useEffect(() => {\n    if (!chartContainerRef.current) return\n\n    const chart = createChart(chartContainerRef.current, {\n      width: chartContainerRef.current.clientWidth,\n      height: isFullscreen ? window.innerHeight - 100 : height,\n      layout: {\n        background: { type: ColorType.Solid, color: colors.background },\n        textColor: colors.text,\n      },\n      grid: {\n        vertLines: { color: colors.grid },\n        horzLines: { color: colors.grid },\n      },\n      crosshair: {\n        mode: CrosshairMode.Normal,\n      },\n      rightPriceScale: {\n        borderColor: colors.grid,\n      },\n      timeScale: {\n        borderColor: colors.grid,\n        timeVisible: true,\n        secondsVisible: false,\n      },\n    })\n\n    chartRef.current = chart\n\n    const chartAny = chart as unknown as any\n\n    const candlestickSeries = chartAny.addCandlestickSeries({\n      upColor: colors.upColor,\n      downColor: colors.downColor,\n      borderDownColor: colors.downColor,\n      borderUpColor: colors.upColor,\n      wickDownColor: colors.wickDownColor,\n      wickUpColor: colors.wickUpColor,\n    })\n\n    candlestickSeriesRef.current = candlestickSeries\n\n    if (showVolume) {\n      const volumeSeries = chartAny.addHistogramSeries({\n        color: colors.volumeDownColor,\n        priceFormat: {\n          type: 'volume',\n        },\n        priceScaleId: 'volume',\n      })\n\n      volumeSeries.priceScale().applyOptions({\n        scaleMargins: {\n          top: 0.8,\n          bottom: 0,\n        },\n      })\n\n      volumeSeriesRef.current = volumeSeries\n    }\n\n    const handleResize = () => {\n      if (chartContainerRef.current && chartRef.current) {\n        chartRef.current.applyOptions({\n          width: chartContainerRef.current.clientWidth,\n          height: isFullscreen ? window.innerHeight - 100 : height,\n        })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      if (chartRef.current) {\n        chartRef.current.remove()\n        chartRef.current = null\n      }\n    }\n  }, [colors, height, showVolume, isFullscreen])\n\n  useEffect(() => {\n    if (candlestickSeriesRef.current) {\n      candlestickSeriesRef.current.setData(data)\n    }\n\n    if (volumeSeriesRef.current && showVolume) {\n      const volumeData = data.map((d) => ({\n        time: d.time,\n        value: d.volume || 0,\n        color: d.close >= d.open ? colors.volumeUpColor : colors.volumeDownColor,\n      }))\n      volumeSeriesRef.current.setData(volumeData)\n    }\n  }, [data, showVolume, colors.volumeUpColor, colors.volumeDownColor])\n\n  const handleRefresh = useCallback(async () => {\n    setIsLoading(true)\n    setError(null)\n    try {\n      await new Promise((resolve) => setTimeout(resolve, 1000))\n    } catch (err) {\n      setError('Failed to refresh data')\n    } finally {\n      setIsLoading(false)\n    }\n  }, [])\n\n  const handleDownloadImage = useCallback(() => {\n    if (chartRef.current) {\n      const canvas = chartContainerRef.current?.querySelector('canvas')\n      if (canvas) {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            download(blob, { filename: `${symbol.replace('/', '-')}-candlestick-${timeframe}.png`, mimeType: 'image/png' })\n          }\n        })\n      }\n    }\n  }, [chartRef, download, symbol, timeframe])\n\n  const currentPrice = data[data.length - 1]\n  const previousPrice = data[data.length - 2]\n  const priceChange = currentPrice ? ((currentPrice.close - previousPrice.close) / previousPrice.close) * 100 : 0\n\n  return (\n    <Card className={cn('relative', className)}>\n      {showToolbar && (\n        <div className=\"absolute top-2 right-2 z-10 flex items-center gap-2\">\n          <Badge variant={priceChange >= 0 ? 'default' : 'destructive'}>\n            {priceChange >= 0 ? <TrendingUp className=\"h-3 w-3 mr-1\" /> : <TrendingDown className=\"h-3 w-3 mr-1\" />}\n            {priceChange.toFixed(2)}%\n          </Badge>\n          \n          <Select value={timeframe} onValueChange={(value) => setTimeframe(value as Timeframe)}>\n            <SelectTrigger className=\"h-8 w-[80px]\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"1m\">1m</SelectItem>\n              <SelectItem value=\"5m\">5m</SelectItem>\n              <SelectItem value=\"15m\">15m</SelectItem>\n              <SelectItem value=\"1h\">1H</SelectItem>\n              <SelectItem value=\"4h\">4H</SelectItem>\n              <SelectItem value=\"1d\">1D</SelectItem>\n              <SelectItem value=\"1w\">1W</SelectItem>\n              <SelectItem value=\"1M\">1M</SelectItem>\n            </SelectContent>\n          </Select>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleRefresh}\n            disabled={isLoading}\n            className=\"h-8 w-8\"\n          >\n            <RefreshCw className={cn('h-4 w-4', isLoading && 'animate-spin')} />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleDownloadImage}\n            className=\"h-8 w-8\"\n          >\n            <Download className=\"h-4 w-4\" />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setIsFullscreen(!isFullscreen)}\n            className=\"h-8 w-8\"\n          >\n            {isFullscreen ? <Minimize2 className=\"h-4 w-4\" /> : <Maximize2 className=\"h-4 w-4\" />}\n          </Button>\n        </div>\n      )}\n\n      <div ref={chartContainerRef} className=\"w-full\" />\n      \n      {error && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-background/80\">\n          <div className=\"text-center\">\n            <p className=\"text-destructive font-medium\">{error}</p>\n            <Button variant=\"outline\" size=\"sm\" className=\"mt-2\" onClick={handleRefresh}>\n              Retry\n            </Button>\n          </div>\n        </div>\n      )}\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AASA;AACA;AAEA;AACA;AACA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;;;AAjCA;;;;;;;;;;;AAwDO,SAAS,iBAAiB,EAC/B,MAAM,YAAY,EAClB,SAAS,SAAS,EAClB,WAAW,mBAAmB,IAAI,EAClC,SAAS,GAAG,EACZ,aAAa,IAAI,EACjB,cAAc,IAAI,EAClB,SAAS,EACa;;IACtB,MAAM,oBAAoB,IAAA,2LAAM,EAAiB;IACjD,MAAM,WAAW,IAAA,2LAAM,EAAmB;IAC1C,MAAM,uBAAuB,IAAA,2LAAM,EAAmC;IACtE,MAAM,kBAAkB,IAAA,2LAAM,EAAiC;IAE/D,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,0LAAQ;IAC1B,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,iKAAW;IAEhC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAY;IACtD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAC;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6LAAQ,EAAC;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6LAAQ,EAAgB;IAElD,MAAM,SAAS,IAAA,4LAAO;4CAAC,IAAM,CAAC;gBAC5B,YAAY,UAAU,SAAS,YAAY;gBAC3C,MAAM,UAAU,SAAS,YAAY;gBACrC,MAAM,UAAU,SAAS,YAAY;gBACrC,SAAS;gBACT,WAAW;gBACX,aAAa;gBACb,eAAe;gBACf,eAAe;gBACf,iBAAiB;YACnB,CAAC;2CAAG;QAAC;KAAM;IAEX,MAAM,OAAO,IAAA,4LAAO;0CAAC;YACnB,IAAI,cAAc,OAAO;YAEzB,MAAM,WAA8B,EAAE;YACtC,IAAI,QAAQ,QAAQ,KAAK,MAAM,KAAK;YACpC,MAAM,MAAM,KAAK,GAAG;YACpB,MAAM,WAAW;YAEjB,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,IAAK;gBAC5B,MAAM,OAAO,KAAK,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,QAAQ,IAAI;gBACvD,MAAM,aAAa;gBAEnB,MAAM,OAAO;gBACb,MAAM,SAAS,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI,aAAa;gBACpD,MAAM,QAAQ,OAAO;gBACrB,MAAM,OAAO,KAAK,GAAG,CAAC,MAAM,SAAS,KAAK,MAAM,KAAK,aAAa,QAAQ;gBAC1E,MAAM,MAAM,KAAK,GAAG,CAAC,MAAM,SAAS,KAAK,MAAM,KAAK,aAAa,QAAQ;gBACzE,MAAM,SAAS,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,WAAW;gBAErD,SAAS,IAAI,CAAC;oBACZ;oBACA;oBACA;oBACA;oBACA;oBACA;gBACF;gBAEA,QAAQ;YACV;YAEA,OAAO;QACT;yCAAG;QAAC;QAAc;QAAQ;KAAU;IAEpC,IAAA,8LAAS;sCAAC;YACR,IAAI,CAAC,kBAAkB,OAAO,EAAE;YAEhC,MAAM,QAAQ,IAAA,mOAAW,EAAC,kBAAkB,OAAO,EAAE;gBACnD,OAAO,kBAAkB,OAAO,CAAC,WAAW;gBAC5C,QAAQ,eAAe,OAAO,WAAW,GAAG,MAAM;gBAClD,QAAQ;oBACN,YAAY;wBAAE,MAAM,iOAAS,CAAC,KAAK;wBAAE,OAAO,OAAO,UAAU;oBAAC;oBAC9D,WAAW,OAAO,IAAI;gBACxB;gBACA,MAAM;oBACJ,WAAW;wBAAE,OAAO,OAAO,IAAI;oBAAC;oBAChC,WAAW;wBAAE,OAAO,OAAO,IAAI;oBAAC;gBAClC;gBACA,WAAW;oBACT,MAAM,qOAAa,CAAC,MAAM;gBAC5B;gBACA,iBAAiB;oBACf,aAAa,OAAO,IAAI;gBAC1B;gBACA,WAAW;oBACT,aAAa,OAAO,IAAI;oBACxB,aAAa;oBACb,gBAAgB;gBAClB;YACF;YAEA,SAAS,OAAO,GAAG;YAEnB,MAAM,WAAW;YAEjB,MAAM,oBAAoB,SAAS,oBAAoB,CAAC;gBACtD,SAAS,OAAO,OAAO;gBACvB,WAAW,OAAO,SAAS;gBAC3B,iBAAiB,OAAO,SAAS;gBACjC,eAAe,OAAO,OAAO;gBAC7B,eAAe,OAAO,aAAa;gBACnC,aAAa,OAAO,WAAW;YACjC;YAEA,qBAAqB,OAAO,GAAG;YAE/B,IAAI,YAAY;gBACd,MAAM,eAAe,SAAS,kBAAkB,CAAC;oBAC/C,OAAO,OAAO,eAAe;oBAC7B,aAAa;wBACX,MAAM;oBACR;oBACA,cAAc;gBAChB;gBAEA,aAAa,UAAU,GAAG,YAAY,CAAC;oBACrC,cAAc;wBACZ,KAAK;wBACL,QAAQ;oBACV;gBACF;gBAEA,gBAAgB,OAAO,GAAG;YAC5B;YAEA,MAAM;2DAAe;oBACnB,IAAI,kBAAkB,OAAO,IAAI,SAAS,OAAO,EAAE;wBACjD,SAAS,OAAO,CAAC,YAAY,CAAC;4BAC5B,OAAO,kBAAkB,OAAO,CAAC,WAAW;4BAC5C,QAAQ,eAAe,OAAO,WAAW,GAAG,MAAM;wBACpD;oBACF;gBACF;;YAEA,OAAO,gBAAgB,CAAC,UAAU;YAElC;8CAAO;oBACL,OAAO,mBAAmB,CAAC,UAAU;oBACrC,IAAI,SAAS,OAAO,EAAE;wBACpB,SAAS,OAAO,CAAC,MAAM;wBACvB,SAAS,OAAO,GAAG;oBACrB;gBACF;;QACF;qCAAG;QAAC;QAAQ;QAAQ;QAAY;KAAa;IAE7C,IAAA,8LAAS;sCAAC;YACR,IAAI,qBAAqB,OAAO,EAAE;gBAChC,qBAAqB,OAAO,CAAC,OAAO,CAAC;YACvC;YAEA,IAAI,gBAAgB,OAAO,IAAI,YAAY;gBACzC,MAAM,aAAa,KAAK,GAAG;6DAAC,CAAC,IAAM,CAAC;4BAClC,MAAM,EAAE,IAAI;4BACZ,OAAO,EAAE,MAAM,IAAI;4BACnB,OAAO,EAAE,KAAK,IAAI,EAAE,IAAI,GAAG,OAAO,aAAa,GAAG,OAAO,eAAe;wBAC1E,CAAC;;gBACD,gBAAgB,OAAO,CAAC,OAAO,CAAC;YAClC;QACF;qCAAG;QAAC;QAAM;QAAY,OAAO,aAAa;QAAE,OAAO,eAAe;KAAC;IAEnE,MAAM,gBAAgB,IAAA,gMAAW;uDAAC;YAChC,aAAa;YACb,SAAS;YACT,IAAI;gBACF,MAAM,IAAI;mEAAQ,CAAC,UAAY,WAAW,SAAS;;YACrD,EAAE,OAAO,KAAK;gBACZ,SAAS;YACX,SAAU;gBACR,aAAa;YACf;QACF;sDAAG,EAAE;IAEL,MAAM,sBAAsB,IAAA,gMAAW;6DAAC;YACtC,IAAI,SAAS,OAAO,EAAE;gBACpB,MAAM,SAAS,kBAAkB,OAAO,EAAE,cAAc;gBACxD,IAAI,QAAQ;oBACV,OAAO,MAAM;6EAAC,CAAC;4BACb,IAAI,MAAM;gCACR,SAAS,MAAM;oCAAE,UAAU,GAAG,OAAO,OAAO,CAAC,KAAK,KAAK,aAAa,EAAE,UAAU,IAAI,CAAC;oCAAE,UAAU;gCAAY;4BAC/G;wBACF;;gBACF;YACF;QACF;4DAAG;QAAC;QAAU;QAAU;QAAQ;KAAU;IAE1C,MAAM,eAAe,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE;IAC1C,MAAM,gBAAgB,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE;IAC3C,MAAM,cAAc,eAAe,AAAC,CAAC,aAAa,KAAK,GAAG,cAAc,KAAK,IAAI,cAAc,KAAK,GAAI,MAAM;IAE9G,qBACE,iNAAC,+JAAI;QAAC,WAAW,IAAA,gJAAE,EAAC,YAAY;;YAC7B,6BACC,iNAAC;gBAAI,WAAU;;kCACb,iNAAC,iKAAK;wBAAC,SAAS,eAAe,IAAI,YAAY;;4BAC5C,eAAe,kBAAI,iNAAC,8PAAU;gCAAC,WAAU;;;;;qDAAoB,iNAAC,oQAAY;gCAAC,WAAU;;;;;;4BACrF,YAAY,OAAO,CAAC;4BAAG;;;;;;;kCAG1B,iNAAC,mKAAM;wBAAC,OAAO;wBAAW,eAAe,CAAC,QAAU,aAAa;;0CAC/D,iNAAC,0KAAa;gCAAC,WAAU;0CACvB,cAAA,iNAAC,wKAAW;;;;;;;;;;0CAEd,iNAAC,0KAAa;;kDACZ,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;kDACvB,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;kDACvB,iNAAC,uKAAU;wCAAC,OAAM;kDAAM;;;;;;kDACxB,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;kDACvB,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;kDACvB,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;kDACvB,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;kDACvB,iNAAC,uKAAU;wCAAC,OAAM;kDAAK;;;;;;;;;;;;;;;;;;kCAI3B,iNAAC,mKAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,UAAU;wBACV,WAAU;kCAEV,cAAA,iNAAC,2PAAS;4BAAC,WAAW,IAAA,gJAAE,EAAC,WAAW,aAAa;;;;;;;;;;;kCAGnD,iNAAC,mKAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,WAAU;kCAEV,cAAA,iNAAC,oPAAQ;4BAAC,WAAU;;;;;;;;;;;kCAGtB,iNAAC,mKAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS,IAAM,gBAAgB,CAAC;wBAChC,WAAU;kCAET,6BAAe,iNAAC,2PAAS;4BAAC,WAAU;;;;;iDAAe,iNAAC,2PAAS;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAK/E,iNAAC;gBAAI,KAAK;gBAAmB,WAAU;;;;;;YAEtC,uBACC,iNAAC;gBAAI,WAAU;0BACb,cAAA,iNAAC;oBAAI,WAAU;;sCACb,iNAAC;4BAAE,WAAU;sCAAgC;;;;;;sCAC7C,iNAAC,mKAAM;4BAAC,SAAQ;4BAAU,MAAK;4BAAK,WAAU;4BAAO,SAAS;sCAAe;;;;;;;;;;;;;;;;;;;;;;;AAQzF;GAtQgB;;QAcI,0LAAQ;QACL,iKAAW;;;KAflB"}},
    {"offset": {"line": 8022, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/LineChart.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react'\nimport {\n  createChart,\n  IChartApi,\n  ISeriesApi,\n  ColorType,\n  CrosshairMode,\n  Time,\n} from 'lightweight-charts'\nimport { useTheme } from 'next-themes'\nimport { Card } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  Download,\n  RefreshCw,\n  TrendingUp,\n  TrendingDown,\n  Maximize2,\n  Minimize2,\n} from 'lucide-react'\nimport { useDownload } from '@/hooks/useDownload'\nimport { cn } from '@/lib/utils'\n\nexport type Timeframe = '1m' | '5m' | '15m' | '1h' | '4h' | '1d' | '1w' | '1M'\n\nexport interface LineData {\n  time: Time\n  value: number\n}\n\ninterface LineChartProps {\n  data?: LineData[]\n  symbol?: string\n  timeframe?: Timeframe\n  height?: number\n  showToolbar?: boolean\n  lineColor?: string\n  lineWidth?: number\n  lineType?: 'solid' | 'dotted' | 'dashed'\n  className?: string\n}\n\nexport function LineChart({\n  data: externalData,\n  symbol = 'BTC/USD',\n  timeframe: initialTimeframe = '1h',\n  height = 400,\n  showToolbar = true,\n  lineColor,\n  lineWidth = 2,\n  lineType = 'solid',\n  className,\n}: LineChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n  const lineSeriesRef = useRef<ISeriesApi<'Line'> | null>(null)\n  \n  const { theme } = useTheme()\n  const { download } = useDownload()\n  \n  const [timeframe, setTimeframe] = useState<Timeframe>(initialTimeframe)\n  const [isLoading, setIsLoading] = useState(false)\n  const [isFullscreen, setIsFullscreen] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  const colors = useMemo(() => {\n    const defaultLineColor = theme === 'dark' ? '#26a69a' : '#0ea5e9'\n    return {\n      background: theme === 'dark' ? '#0a0a0a' : '#ffffff',\n      grid: theme === 'dark' ? '#1a1a1a' : '#e5e5e5',\n      text: theme === 'dark' ? '#a0a0a0' : '#666666',\n      line: lineColor || defaultLineColor,\n    }\n  }, [theme, lineColor])\n\n  const data = useMemo(() => {\n    if (externalData) return externalData\n    \n    const mockData: LineData[] = []\n    let value = 50000 + Math.random() * 5000\n    const now = Date.now()\n    const interval = 60000\n    \n    for (let i = 0; i < 200; i++) {\n      const time = Math.floor((now - (200 - i) * interval) / 1000) as Time\n      const change = (Math.random() - 0.5) * 500\n      value = Math.max(value + change, 1000)\n      \n      mockData.push({\n        time,\n        value,\n      })\n    }\n    \n    return mockData\n  }, [externalData, symbol, timeframe])\n\n  useEffect(() => {\n    if (!chartContainerRef.current) return\n\n    const chart = createChart(chartContainerRef.current, {\n      width: chartContainerRef.current.clientWidth,\n      height: isFullscreen ? window.innerHeight - 100 : height,\n      layout: {\n        background: { type: ColorType.Solid, color: colors.background },\n        textColor: colors.text,\n      },\n      grid: {\n        vertLines: { color: colors.grid },\n        horzLines: { color: colors.grid },\n      },\n      crosshair: {\n        mode: CrosshairMode.Normal,\n      },\n      rightPriceScale: {\n        borderColor: colors.grid,\n      },\n      timeScale: {\n        borderColor: colors.grid,\n        timeVisible: true,\n        secondsVisible: false,\n      },\n    })\n\n    chartRef.current = chart\n\n    const chartAny = chart as unknown as any\n\n    const lineSeries = chartAny.addLineSeries({\n      color: colors.line,\n      lineWidth,\n      lineType: lineType === 'dotted' ? 2 : lineType === 'dashed' ? 3 : 0,\n      priceLineVisible: false,\n    })\n\n    lineSeriesRef.current = lineSeries\n\n    const handleResize = () => {\n      if (chartContainerRef.current && chartRef.current) {\n        chartRef.current.applyOptions({\n          width: chartContainerRef.current.clientWidth,\n          height: isFullscreen ? window.innerHeight - 100 : height,\n        })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      if (chartRef.current) {\n        chartRef.current.remove()\n        chartRef.current = null\n      }\n    }\n  }, [colors, height, lineWidth, lineType, isFullscreen])\n\n  useEffect(() => {\n    if (lineSeriesRef.current) {\n      lineSeriesRef.current.setData(data)\n    }\n  }, [data])\n\n  const handleRefresh = useCallback(async () => {\n    setIsLoading(true)\n    setError(null)\n    try {\n      await new Promise((resolve) => setTimeout(resolve, 1000))\n    } catch (err) {\n      setError('Failed to refresh data')\n    } finally {\n      setIsLoading(false)\n    }\n  }, [])\n\n  const handleDownloadImage = useCallback(() => {\n    if (chartRef.current) {\n      const canvas = chartContainerRef.current?.querySelector('canvas')\n      if (canvas) {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            download(blob, { filename: `${symbol.replace('/', '-')}-line-${timeframe}.png`, mimeType: 'image/png' })\n          }\n        })\n      }\n    }\n  }, [chartRef, download, symbol, timeframe])\n\n  const currentValue = data[data.length - 1]\n  const previousValue = data[data.length - 2]\n  const priceChange = currentValue && previousValue ? ((currentValue.value - previousValue.value) / previousValue.value) * 100 : 0\n\n  return (\n    <Card className={cn('relative', className)}>\n      {showToolbar && (\n        <div className=\"absolute top-2 right-2 z-10 flex items-center gap-2\">\n          <Badge variant={priceChange >= 0 ? 'default' : 'destructive'}>\n            {priceChange >= 0 ? <TrendingUp className=\"h-3 w-3 mr-1\" /> : <TrendingDown className=\"h-3 w-3 mr-1\" />}\n            {priceChange.toFixed(2)}%\n          </Badge>\n          \n          <Select value={timeframe} onValueChange={(value) => setTimeframe(value as Timeframe)}>\n            <SelectTrigger className=\"h-8 w-[80px]\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"1m\">1m</SelectItem>\n              <SelectItem value=\"5m\">5m</SelectItem>\n              <SelectItem value=\"15m\">15m</SelectItem>\n              <SelectItem value=\"1h\">1H</SelectItem>\n              <SelectItem value=\"4h\">4H</SelectItem>\n              <SelectItem value=\"1d\">1D</SelectItem>\n              <SelectItem value=\"1w\">1W</SelectItem>\n              <SelectItem value=\"1M\">1M</SelectItem>\n            </SelectContent>\n          </Select>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleRefresh}\n            disabled={isLoading}\n            className=\"h-8 w-8\"\n          >\n            <RefreshCw className={cn('h-4 w-4', isLoading && 'animate-spin')} />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleDownloadImage}\n            className=\"h-8 w-8\"\n          >\n            <Download className=\"h-4 w-4\" />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setIsFullscreen(!isFullscreen)}\n            className=\"h-8 w-8\"\n          >\n            {isFullscreen ? <Minimize2 className=\"h-4 w-4\" /> : <Maximize2 className=\"h-4 w-4\" />}\n          </Button>\n        </div>\n      )}\n\n      <div ref={chartContainerRef} className=\"w-full\" />\n      \n      {error && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-background/80\">\n          <div className=\"text-center\">\n            <p className=\"text-destructive font-medium\">{error}</p>\n            <Button variant=\"outline\" size=\"sm\" className=\"mt-2\" onClick={handleRefresh}>\n              Retry\n            </Button>\n          </div>\n        </div>\n      )}\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8478, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/AreaChart.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react'\nimport {\n  createChart,\n  IChartApi,\n  ISeriesApi,\n  ColorType,\n  CrosshairMode,\n  Time,\n} from 'lightweight-charts'\nimport { useTheme } from 'next-themes'\nimport { Card } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  Download,\n  RefreshCw,\n  TrendingUp,\n  TrendingDown,\n  Maximize2,\n  Minimize2,\n} from 'lucide-react'\nimport { useDownload } from '@/hooks/useDownload'\nimport { cn } from '@/lib/utils'\n\nexport type Timeframe = '1m' | '5m' | '15m' | '1h' | '4h' | '1d' | '1w' | '1M'\n\nexport interface AreaData {\n  time: Time\n  value: number\n}\n\ninterface AreaChartProps {\n  data?: AreaData[]\n  symbol?: string\n  timeframe?: Timeframe\n  height?: number\n  showToolbar?: boolean\n  lineColor?: string\n  topColor?: string\n  bottomColor?: string\n  lineWidth?: number\n  className?: string\n}\n\nexport function AreaChart({\n  data: externalData,\n  symbol = 'BTC/USD',\n  timeframe: initialTimeframe = '1h',\n  height = 400,\n  showToolbar = true,\n  lineColor,\n  topColor,\n  bottomColor,\n  lineWidth = 2,\n  className,\n}: AreaChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n  const areaSeriesRef = useRef<ISeriesApi<'Area'> | null>(null)\n  \n  const { theme } = useTheme()\n  const { download } = useDownload()\n  \n  const [timeframe, setTimeframe] = useState<Timeframe>(initialTimeframe)\n  const [isLoading, setIsLoading] = useState(false)\n  const [isFullscreen, setIsFullscreen] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  const colors = useMemo(() => {\n    const defaultLineColor = theme === 'dark' ? '#26a69a' : '#0ea5e9'\n    const defaultTopColor = theme === 'dark' ? 'rgba(38, 166, 154, 0.4)' : 'rgba(14, 165, 233, 0.4)'\n    const defaultBottomColor = theme === 'dark' ? 'rgba(38, 166, 154, 0.0)' : 'rgba(14, 165, 233, 0.0)'\n    \n    return {\n      background: theme === 'dark' ? '#0a0a0a' : '#ffffff',\n      grid: theme === 'dark' ? '#1a1a1a' : '#e5e5e5',\n      text: theme === 'dark' ? '#a0a0a0' : '#666666',\n      line: lineColor || defaultLineColor,\n      top: topColor || defaultTopColor,\n      bottom: bottomColor || defaultBottomColor,\n    }\n  }, [theme, lineColor, topColor, bottomColor])\n\n  const data = useMemo(() => {\n    if (externalData) return externalData\n    \n    const mockData: AreaData[] = []\n    let value = 50000 + Math.random() * 5000\n    const now = Date.now()\n    const interval = 60000\n    \n    for (let i = 0; i < 200; i++) {\n      const time = Math.floor((now - (200 - i) * interval) / 1000) as Time\n      const change = (Math.random() - 0.5) * 500\n      value = Math.max(value + change, 1000)\n      \n      mockData.push({\n        time,\n        value,\n      })\n    }\n    \n    return mockData\n  }, [externalData, symbol, timeframe])\n\n  useEffect(() => {\n    if (!chartContainerRef.current) return\n\n    const chart = createChart(chartContainerRef.current, {\n      width: chartContainerRef.current.clientWidth,\n      height: isFullscreen ? window.innerHeight - 100 : height,\n      layout: {\n        background: { type: ColorType.Solid, color: colors.background },\n        textColor: colors.text,\n      },\n      grid: {\n        vertLines: { color: colors.grid },\n        horzLines: { color: colors.grid },\n      },\n      crosshair: {\n        mode: CrosshairMode.Normal,\n      },\n      rightPriceScale: {\n        borderColor: colors.grid,\n      },\n      timeScale: {\n        borderColor: colors.grid,\n        timeVisible: true,\n        secondsVisible: false,\n      },\n    })\n\n    chartRef.current = chart\n\n    const chartAny = chart as unknown as any\n\n    const areaSeries = chartAny.addAreaSeries({\n      lineColor: colors.line,\n      topColor: colors.top,\n      bottomColor: colors.bottom,\n      lineWidth,\n      priceLineVisible: false,\n    })\n\n    areaSeriesRef.current = areaSeries\n\n    const handleResize = () => {\n      if (chartContainerRef.current && chartRef.current) {\n        chartRef.current.applyOptions({\n          width: chartContainerRef.current.clientWidth,\n          height: isFullscreen ? window.innerHeight - 100 : height,\n        })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      if (chartRef.current) {\n        chartRef.current.remove()\n        chartRef.current = null\n      }\n    }\n  }, [colors, height, lineWidth, isFullscreen])\n\n  useEffect(() => {\n    if (areaSeriesRef.current) {\n      areaSeriesRef.current.setData(data)\n    }\n  }, [data])\n\n  const handleRefresh = useCallback(async () => {\n    setIsLoading(true)\n    setError(null)\n    try {\n      await new Promise((resolve) => setTimeout(resolve, 1000))\n    } catch (err) {\n      setError('Failed to refresh data')\n    } finally {\n      setIsLoading(false)\n    }\n  }, [])\n\n  const handleDownloadImage = useCallback(() => {\n    if (chartRef.current) {\n      const canvas = chartContainerRef.current?.querySelector('canvas')\n      if (canvas) {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            download(blob, { filename: `${symbol.replace('/', '-')}-area-${timeframe}.png`, mimeType: 'image/png' })\n          }\n        })\n      }\n    }\n  }, [chartRef, download, symbol, timeframe])\n\n  const currentValue = data[data.length - 1]\n  const previousValue = data[data.length - 2]\n  const priceChange = currentValue && previousValue ? ((currentValue.value - previousValue.value) / previousValue.value) * 100 : 0\n\n  return (\n    <Card className={cn('relative', className)}>\n      {showToolbar && (\n        <div className=\"absolute top-2 right-2 z-10 flex items-center gap-2\">\n          <Badge variant={priceChange >= 0 ? 'default' : 'destructive'}>\n            {priceChange >= 0 ? <TrendingUp className=\"h-3 w-3 mr-1\" /> : <TrendingDown className=\"h-3 w-3 mr-1\" />}\n            {priceChange.toFixed(2)}%\n          </Badge>\n          \n          <Select value={timeframe} onValueChange={(value) => setTimeframe(value as Timeframe)}>\n            <SelectTrigger className=\"h-8 w-[80px]\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"1m\">1m</SelectItem>\n              <SelectItem value=\"5m\">5m</SelectItem>\n              <SelectItem value=\"15m\">15m</SelectItem>\n              <SelectItem value=\"1h\">1H</SelectItem>\n              <SelectItem value=\"4h\">4H</SelectItem>\n              <SelectItem value=\"1d\">1D</SelectItem>\n              <SelectItem value=\"1w\">1W</SelectItem>\n              <SelectItem value=\"1M\">1M</SelectItem>\n            </SelectContent>\n          </Select>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleRefresh}\n            disabled={isLoading}\n            className=\"h-8 w-8\"\n          >\n            <RefreshCw className={cn('h-4 w-4', isLoading && 'animate-spin')} />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleDownloadImage}\n            className=\"h-8 w-8\"\n          >\n            <Download className=\"h-4 w-4\" />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setIsFullscreen(!isFullscreen)}\n            className=\"h-8 w-8\"\n          >\n            {isFullscreen ? <Minimize2 className=\"h-4 w-4\" /> : <Maximize2 className=\"h-4 w-4\" />}\n          </Button>\n        </div>\n      )}\n\n      <div ref={chartContainerRef} className=\"w-full\" />\n      \n      {error && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-background/80\">\n          <div className=\"text-center\">\n            <p className=\"text-destructive font-medium\">{error}</p>\n            <Button variant=\"outline\" size=\"sm\" className=\"mt-2\" onClick={handleRefresh}>\n              Retry\n            </Button>\n          </div>\n        </div>\n      )}\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8940, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/HeikinAshiChart.tsx"],"sourcesContent":["'use client'\n\nimport { useMemo, useRef, useEffect, useState } from 'react'\nimport { createChart, ColorType, IChartApi, ISeriesApi, CandlestickData, Time } from 'lightweight-charts'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { cn } from '@/lib/utils'\nimport { RefreshCw } from 'lucide-react'\n\nexport interface HeikinAshiData {\n  time: string\n  open: number\n  high: number\n  low: number\n  close: number\n  volume?: number\n}\n\ninterface HeikinAshiChartProps {\n  data: HeikinAshiData[]\n  className?: string\n  height?: number\n  showVolume?: boolean\n  onSymbolChange?: (symbol: string) => void\n}\n\nfunction calculateHeikinAshi(data: { time: string; open: number; high: number; low: number; close: number; volume?: number }[]): HeikinAshiData[] {\n  if (data.length === 0) return []\n\n  const result: HeikinAshiData[] = []\n  let prevHaOpen = data[0].open\n  let prevHaClose = data[0].close\n\n  for (let i = 0; i < data.length; i++) {\n    const candle = data[i]\n    const haClose = (candle.open + candle.high + candle.low + candle.close) / 4\n    const haOpen = (prevHaOpen + prevHaClose) / 2\n    const haHigh = Math.max(candle.high, Math.max(haOpen, haClose))\n    const haLow = Math.min(candle.low, Math.min(haOpen, haClose))\n\n    result.push({\n      time: candle.time,\n      open: haOpen,\n      high: haHigh,\n      low: haLow,\n      close: haClose,\n      volume: candle.volume\n    })\n\n    prevHaOpen = haOpen\n    prevHaClose = haClose\n  }\n\n  return result\n}\n\nexport function HeikinAshiChart({\n  data,\n  className,\n  height = 400,\n  showVolume = true,\n  onSymbolChange\n}: HeikinAshiChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n  const seriesRef = useRef<ISeriesApi<'Candlestick'> | null>(null)\n  const volumeSeriesRef = useRef<ISeriesApi<'Histogram'> | null>(null)\n  const [chartType, setChartType] = useState<'heikin-ashi' | 'traditional'>('heikin-ashi')\n\n  const processedData = useMemo(() => {\n    if (chartType === 'heikin-ashi') {\n      return calculateHeikinAshi(data)\n    }\n    return data.map(d => ({\n      time: d.time,\n      open: d.open,\n      high: d.high,\n      low: d.low,\n      close: d.close,\n      volume: d.volume\n    }))\n  }, [data, chartType])\n\n  useEffect(() => {\n    if (!chartContainerRef.current) return\n\n    const chart = createChart(chartContainerRef.current, {\n      layout: {\n        background: { type: ColorType.Solid, color: 'transparent' },\n        textColor: 'hsl(var(--muted-foreground))'\n      },\n      grid: {\n        vertLines: { color: 'hsl(var(--border))' },\n        horzLines: { color: 'hsl(var(--border))' }\n      },\n      width: chartContainerRef.current.clientWidth,\n      height: height,\n      timeScale: {\n        timeVisible: true,\n        secondsVisible: false,\n      }\n    })\n\n    chartRef.current = chart\n\n    const candlestickSeries = (chart as any).addCandlestickSeries({\n      upColor: '#22c55e',\n      downColor: '#ef4444',\n      borderUpColor: '#22c55e',\n      borderDownColor: '#ef4444',\n      wickUpColor: '#22c55e',\n      wickDownColor: '#ef4444',\n    })\n    seriesRef.current = candlestickSeries\n\n    if (showVolume) {\n      const volumeSeries = (chart as any).addHistogramSeries({\n        color: '#64748b',\n        priceFormat: {\n          type: 'volume',\n        },\n        priceScaleId: '',\n      })\n      volumeSeries.priceScale().applyOptions({\n        scaleMargins: {\n          top: 0.8,\n          bottom: 0,\n        },\n      })\n      volumeSeriesRef.current = volumeSeries\n    }\n\n    const handleResize = () => {\n      if (chartContainerRef.current) {\n        chart.applyOptions({ width: chartContainerRef.current.clientWidth })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      chart.remove()\n    }\n  }, [height, showVolume])\n\n  useEffect(() => {\n    if (!seriesRef.current) return\n\n    const candleData: CandlestickData<Time>[] = processedData.map(d => ({\n      time: d.time as Time,\n      open: d.open,\n      high: d.high,\n      low: d.low,\n      close: d.close,\n    }))\n\n    seriesRef.current.setData(candleData)\n\n    if (volumeSeriesRef.current && showVolume) {\n      const volumeData = processedData.map(d => ({\n        time: d.time as Time,\n        value: d.volume || 0,\n        color: d.close >= d.open ? 'rgba(34, 197, 94, 0.5)' : 'rgba(239, 68, 68, 0.5)',\n      }))\n      volumeSeriesRef.current.setData(volumeData)\n    }\n\n    chartRef.current?.timeScale().fitContent()\n  }, [processedData, showVolume])\n\n  return (\n    <Card className={className}>\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle>Heikin Ashi Chart</CardTitle>\n          <div className=\"flex items-center gap-2\">\n            <Select value={chartType} onValueChange={(v) => setChartType(v as 'heikin-ashi' | 'traditional')}>\n              <SelectTrigger className=\"w-40\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"heikin-ashi\">Heikin Ashi</SelectItem>\n                <SelectItem value=\"traditional\">Traditional</SelectItem>\n              </SelectContent>\n            </Select>\n            <Button variant=\"outline\" size=\"icon\" onClick={() => chartRef.current?.timeScale().fitContent()}>\n              <RefreshCw className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div ref={chartContainerRef} className=\"w-full\" />\n        {chartType === 'heikin-ashi' && (\n          <div className=\"mt-4 p-3 rounded-lg bg-muted text-sm\">\n            <p className=\"font-medium mb-2\">Heikin Ashi Interpretation</p>\n            <div className=\"grid grid-cols-2 gap-2 text-muted-foreground\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-sm bg-green-500\" />\n                <span>Green candles = Uptrend</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-sm bg-red-500\" />\n                <span>Red candles = Downtrend</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-sm bg-green-500\" />\n                <span>Large bodies = Strong momentum</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-sm bg-red-500\" />\n                <span>Small bodies = Weak trend</span>\n              </div>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n\nexport default HeikinAshiChart\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9365, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/RenkoChart.tsx"],"sourcesContent":["'use client'\n\nimport { useMemo, useRef, useEffect, useState } from 'react'\nimport { createChart, ColorType, IChartApi, ISeriesApi, Time } from 'lightweight-charts'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { cn } from '@/lib/utils'\nimport { RefreshCw, TrendingUp, TrendingDown } from 'lucide-react'\n\nexport interface RenkoBrick {\n  startTime: string\n  endTime: string\n  open: number\n  close: number\n  high: number\n  low: number\n  direction: 'up' | 'down'\n  isReversal: boolean\n}\n\ninterface RenkoDataPoint {\n  time: string\n  close: number\n  volume?: number\n}\n\ninterface RenkoChartProps {\n  data: RenkoDataPoint[]\n  className?: string\n  height?: number\n  brickSize?: number\n  showVolume?: boolean\n}\n\nfunction calculateRenko(data: RenkoDataPoint[], brickSize: number): RenkoBrick[] {\n  if (data.length < 2) return []\n\n  const bricks: RenkoBrick[] = []\n  let currentPrice = data[0].close\n  let direction: 'up' | 'down' = data[1].close >= currentPrice ? 'up' : 'down'\n  let brickOpen = currentPrice - (direction === 'up' ? 0 : brickSize)\n  let brickClose = direction === 'up' ? brickOpen + brickSize : brickOpen - brickSize\n\n  for (let i = 1; i < data.length; i++) {\n    const price = data[i].close\n    const time = data[i].time\n\n    while (true) {\n      if (direction === 'up') {\n        if (price >= brickClose + brickSize) {\n          bricks.push({\n            startTime: time,\n            endTime: time,\n            open: brickOpen,\n            close: brickClose,\n            high: brickClose,\n            low: brickOpen,\n            direction: 'up',\n            isReversal: false\n          })\n          brickOpen = brickClose\n          brickClose += brickSize\n        } else if (price <= brickOpen - brickSize) {\n          bricks.push({\n            startTime: time,\n            endTime: time,\n            open: brickOpen,\n            close: brickOpen - brickSize,\n            high: brickOpen,\n            low: brickOpen - brickSize,\n            direction: 'down',\n            isReversal: true\n          })\n          brickClose = brickOpen\n          brickOpen = brickClose - brickSize\n          direction = 'down'\n        } else {\n          break\n        }\n      } else {\n        if (price <= brickClose - brickSize) {\n          bricks.push({\n            startTime: time,\n            endTime: time,\n            open: brickOpen,\n            close: brickClose,\n            high: brickOpen,\n            low: brickClose,\n            direction: 'down',\n            isReversal: false\n          })\n          brickOpen = brickClose\n          brickClose -= brickSize\n        } else if (price >= brickOpen + brickSize) {\n          bricks.push({\n            startTime: time,\n            endTime: time,\n            open: brickOpen,\n            close: brickOpen + brickSize,\n            high: brickOpen + brickSize,\n            low: brickOpen,\n            direction: 'up',\n            isReversal: true\n          })\n          brickClose = brickOpen\n          brickOpen = brickClose + brickSize\n          direction = 'up'\n        } else {\n          break\n        }\n      }\n    }\n  }\n\n  return bricks\n}\n\nexport function RenkoChart({\n  data,\n  className,\n  height = 400,\n  brickSize: initialBrickSize,\n  showVolume = true\n}: RenkoChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n  const seriesRef = useRef<ISeriesApi<'Custom'> | null>(null)\n  const [brickSize, setBrickSize] = useState(initialBrickSize || 10)\n  const [brickCount, setBrickCount] = useState(20)\n\n  const renkoData = useMemo(() => {\n    if (data.length === 0) return []\n    const priceRange = Math.max(...data.map(d => d.close)) - Math.min(...data.map(d => d.close))\n    const calculatedBrickSize = initialBrickSize || Math.max(priceRange / 50, 1)\n    return calculateRenko(data, calculatedBrickSize)\n  }, [data, initialBrickSize])\n\n  useEffect(() => {\n    if (!chartContainerRef.current) return\n\n    const chart = createChart(chartContainerRef.current, {\n      layout: {\n        background: { type: ColorType.Solid, color: 'transparent' },\n        textColor: 'hsl(var(--muted-foreground))'\n      },\n      grid: {\n        vertLines: { color: 'hsl(var(--border))' },\n        horzLines: { color: 'hsl(var(--border))' }\n      },\n      width: chartContainerRef.current.clientWidth,\n      height: height,\n      timeScale: {\n        timeVisible: true,\n        secondsVisible: false,\n      }\n    })\n\n    chartRef.current = chart\n\n    const handleResize = () => {\n      if (chartContainerRef.current) {\n        chart.applyOptions({ width: chartContainerRef.current.clientWidth })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      chart.remove()\n    }\n  }, [height])\n\n  useEffect(() => {\n    if (!chartRef.current || renkoData.length === 0) return\n\n    const upBricks = renkoData.filter(b => b.direction === 'up')\n    const downBricks = renkoData.filter(b => b.direction === 'down')\n\n    const upData = upBricks.map((brick, i) => ({\n      time: (i + 1) as Time,\n      open: brick.open,\n      high: brick.high,\n      low: brick.low,\n      close: brick.close,\n    }))\n\n    const downData = downBricks.map((brick, i) => ({\n      time: (i + 1) as Time,\n      open: brick.open,\n      high: brick.high,\n      low: brick.low,\n      close: brick.close,\n    }))\n\n    chartRef.current.timeScale().fitContent()\n  }, [renkoData])\n\n  const upTrendCount = renkoData.filter(b => b.direction === 'up').length\n  const downTrendCount = renkoData.filter(b => b.direction === 'down').length\n  const reversalCount = renkoData.filter(b => b.isReversal).length\n\n  return (\n    <Card className={className}>\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle>Renko Chart</CardTitle>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"flex items-center gap-2\">\n              <Label className=\"text-xs\">Brick Size</Label>\n              <Input\n                type=\"number\"\n                value={brickSize}\n                onChange={(e) => setBrickSize(parseFloat(e.target.value) || 10)}\n                className=\"w-20 h-8\"\n                min={0.01}\n                step={0.01}\n              />\n            </div>\n            <Button variant=\"outline\" size=\"icon\" onClick={() => chartRef.current?.timeScale().fitContent()}>\n              <RefreshCw className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div ref={chartContainerRef} className=\"w-full\" />\n        <div className=\"mt-4 grid grid-cols-4 gap-4\">\n          <div className=\"p-3 rounded-lg bg-green-50 border border-green-200\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <TrendingUp className=\"h-4 w-4 text-green-600\" />\n              <span className=\"text-xs text-green-600 font-medium\">Up Bricks</span>\n            </div>\n            <p className=\"text-xl font-bold text-green-700\">{upTrendCount}</p>\n          </div>\n          <div className=\"p-3 rounded-lg bg-red-50 border border-red-200\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <TrendingDown className=\"h-4 w-4 text-red-600\" />\n              <span className=\"text-xs text-red-600 font-medium\">Down Bricks</span>\n            </div>\n            <p className=\"text-xl font-bold text-red-700\">{downTrendCount}</p>\n          </div>\n          <div className=\"p-3 rounded-lg bg-muted\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <RefreshCw className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Reversals</span>\n            </div>\n            <p className=\"text-xl font-bold\">{reversalCount}</p>\n          </div>\n          <div className=\"p-3 rounded-lg bg-muted\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <span className=\"text-xs font-medium\">Total</span>\n            </div>\n            <p className=\"text-xl font-bold\">{renkoData.length}</p>\n          </div>\n        </div>\n        <div className=\"mt-4 p-3 rounded-lg bg-muted text-sm\">\n          <p className=\"font-medium mb-2\">Renko Chart Interpretation</p>\n          <div className=\"grid grid-cols-2 gap-2 text-muted-foreground\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded-sm bg-green-500\" />\n              <span>Green bricks = Up trend</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded-sm bg-red-500\" />\n              <span>Red bricks = Down trend</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span>•</span>\n              <span>Equal brick sizes filter noise</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span>•</span>\n              <span>Reversals show trend changes</span>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport default RenkoChart\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9970, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/KagiChart.tsx"],"sourcesContent":["'use client'\n\nimport { useMemo, useRef, useEffect } from 'react'\nimport { createChart, ColorType, IChartApi, Time } from 'lightweight-charts'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { RefreshCw } from 'lucide-react'\n\nexport interface KagiLine {\n  time: string\n  value: number\n  direction: 'up' | 'down' | 'neutral'\n  reversal: boolean\n  type: 'yang' | 'yin' | 'neutral'\n}\n\ninterface KagiDataPoint {\n  time: string\n  close: number\n  volume?: number\n}\n\ninterface KagiChartProps {\n  data: KagiDataPoint[]\n  className?: string\n  height?: number\n  reversalAmount?: number\n  showVolume?: boolean\n}\n\nfunction calculateKagi(data: KagiDataPoint[], reversalPercent: number): KagiLine[] {\n  if (data.length < 2) return []\n\n  const kagiLines: KagiLine[] = []\n  let currentPrice = data[0].close\n  let direction: 'up' | 'down' | 'neutral' = 'neutral'\n  let startPrice = currentPrice\n\n  const reversalThreshold = currentPrice * (reversalPercent / 100)\n\n  for (let i = 1; i < data.length; i++) {\n    const price = data[i].close\n    const time = data[i].time\n\n    if (direction === 'neutral') {\n      if (price > startPrice + reversalThreshold) {\n        direction = 'up'\n        kagiLines.push({ time, value: price, direction: 'up', reversal: false, type: 'yang' })\n      } else if (price < startPrice - reversalThreshold) {\n        direction = 'down'\n        kagiLines.push({ time, value: price, direction: 'down', reversal: false, type: 'yin' })\n      }\n    } else if (direction === 'up') {\n      if (price >= currentPrice) {\n        currentPrice = price\n        kagiLines.push({ time, value: price, direction: 'up', reversal: false, type: 'yang' })\n      } else if (price <= currentPrice - reversalThreshold) {\n        direction = 'down'\n        kagiLines.push({ time, value: price, direction: 'down', reversal: true, type: 'yin' })\n        currentPrice = price\n      }\n    } else if (direction === 'down') {\n      if (price <= currentPrice) {\n        currentPrice = price\n        kagiLines.push({ time, value: price, direction: 'down', reversal: false, type: 'yin' })\n      } else if (price >= currentPrice + reversalThreshold) {\n        direction = 'up'\n        kagiLines.push({ time, value: price, direction: 'up', reversal: true, type: 'yang' })\n        currentPrice = price\n      }\n    }\n  }\n\n  return kagiLines\n}\n\nexport function KagiChart({\n  data,\n  className,\n  height = 400,\n  reversalAmount = 4,\n  showVolume = true\n}: KagiChartProps) {\n  const chartContainerRef = useRef<HTMLDivElement>(null)\n  const chartRef = useRef<IChartApi | null>(null)\n\n  const kagiData = useMemo(() => calculateKagi(data, reversalAmount), [data, reversalAmount])\n\n  useEffect(() => {\n    if (!chartContainerRef.current) return\n\n    const chart = createChart(chartContainerRef.current, {\n      layout: {\n        background: { type: ColorType.Solid, color: 'transparent' },\n        textColor: 'hsl(var(--muted-foreground))'\n      },\n      grid: {\n        vertLines: { color: 'hsl(var(--border))' },\n        horzLines: { color: 'hsl(var(--border))' }\n      },\n      width: chartContainerRef.current.clientWidth,\n      height: height,\n      timeScale: {\n        timeVisible: true,\n        secondsVisible: false,\n      }\n    })\n\n    chartRef.current = chart\n\n    const handleResize = () => {\n      if (chartContainerRef.current) {\n        chart.applyOptions({ width: chartContainerRef.current.clientWidth })\n      }\n    }\n\n    window.addEventListener('resize', handleResize)\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      chart.remove()\n    }\n  }, [height])\n\n  useEffect(() => {\n    if (!chartRef.current || kagiData.length === 0) return\n\n    const yangLines = kagiData.filter(l => l.type === 'yang')\n    const yinLines = kagiData.filter(l => l.type === 'yin')\n\n    chartRef.current.timeScale().fitContent()\n  }, [kagiData])\n\n  const yangCount = kagiData.filter(l => l.type === 'yang').length\n  const yinCount = kagiData.filter(l => l.type === 'yin').length\n  const reversalCount = kagiData.filter(l => l.reversal).length\n\n  return (\n    <Card className={className}>\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle>Kagi Chart</CardTitle>\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-sm text-muted-foreground\">\n              Reversal: {reversalAmount}%\n            </span>\n            <Button variant=\"outline\" size=\"icon\" onClick={() => chartRef.current?.timeScale().fitContent()}>\n              <RefreshCw className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div ref={chartContainerRef} className=\"w-full\" />\n        <div className=\"mt-4 grid grid-cols-4 gap-4\">\n          <div className=\"p-3 rounded-lg bg-green-50 border border-green-200\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <div className=\"w-4 h-1 bg-green-600 rounded\" />\n              <span className=\"text-xs text-green-600 font-medium\">Yang (Up)</span>\n            </div>\n            <p className=\"text-xl font-bold text-green-700\">{yangCount}</p>\n          </div>\n          <div className=\"p-3 rounded-lg bg-red-50 border border-red-200\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <div className=\"w-4 h-1 bg-red-600 rounded\" />\n              <span className=\"text-xs text-red-600 font-medium\">Yin (Down)</span>\n            </div>\n            <p className=\"text-xl font-bold text-red-700\">{yinCount}</p>\n          </div>\n          <div className=\"p-3 rounded-lg bg-muted\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <span className=\"text-xs font-medium\">Reversals</span>\n            </div>\n            <p className=\"text-xl font-bold\">{reversalCount}</p>\n          </div>\n          <div className=\"p-3 rounded-lg bg-muted\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <span className=\"text-xs font-medium\">Total Lines</span>\n            </div>\n            <p className=\"text-xl font-bold\">{kagiData.length}</p>\n          </div>\n        </div>\n        <div className=\"mt-4 p-3 rounded-lg bg-muted text-sm\">\n          <p className=\"font-medium mb-2\">Kagi Chart Interpretation</p>\n          <div className=\"grid grid-cols-2 gap-2 text-muted-foreground\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-1 bg-green-600 rounded\" />\n              <span>Yang (green) = Rising trend</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-1 bg-red-600 rounded\" />\n              <span>Yin (red) = Falling trend</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span>•</span>\n              <span>Thickness changes indicate strength</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span>•</span>\n              <span>Shoulders mark trend reversals</span>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport default KagiChart\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10511, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/DepthChart.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo, useCallback, useRef, useEffect } from 'react'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  ZoomIn,\n  ZoomOut,\n  Download,\n  RefreshCw,\n  Settings2,\n  TrendingUp,\n  TrendingDown,\n  BarChart3,\n  Maximize2,\n  Minimize2,\n  Activity,\n  CheckCircle,\n} from 'lucide-react'\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  ReferenceLine,\n} from 'recharts'\nimport { cn, formatNumber, formatCurrency } from '@/lib/utils'\nimport { useDownloadFile } from '@/hooks/useDownload'\n\nexport interface DepthLevel {\n  price: number\n  bids: number\n  asks: number\n  bidVolume: number\n  askVolume: number\n  bidCumulative: number\n  askCumulative: number\n  spread: number\n  spreadPercent: number\n}\n\nexport interface DepthPoint {\n  price: number\n  bidDepth: number\n  askDepth: number\n  bidCumulative: number\n  askCumulative: number\n}\n\nexport interface OrderBookData {\n  symbol: string\n  bids: { price: number; size: number; total: number }[]\n  asks: { price: number; size: number; total: number }[]\n  spread: number\n  spreadPercent: number\n  midPrice: number\n  timestamp: string\n}\n\ninterface DepthChartProps {\n  data?: OrderBookData\n  depthLevels?: DepthLevel[]\n  symbol?: string\n  colorScheme?: 'classic' | 'blueRed' | 'greenRed'\n  showCumulative?: boolean\n  showMidPrice?: boolean\n  className?: string\n  onRefresh?: () => void\n}\n\nconst TIMEFRAMES = [\n  { value: 'realtime', label: 'Realtime' },\n  { value: '1s', label: '1 Second' },\n  { value: '5s', label: '5 Seconds' },\n  { value: '1m', label: '1 Minute' },\n]\n\nexport function DepthChart({\n  data,\n  depthLevels = [],\n  symbol = '',\n  colorScheme = 'blueRed',\n  showCumulative = false,\n  showMidPrice = true,\n  className,\n  onRefresh,\n}: DepthChartProps) {\n  const [activeTab, setActiveTab] = useState('depth')\n  const [selectedTimeframe, setSelectedTimeframe] = useState('realtime')\n  const [showMid, setShowMid] = useState(showMidPrice)\n  const [showCum, setShowCum] = useState(showCumulative)\n  const [isExporting, setIsExporting] = useState(false)\n  const [isFullscreen, setIsFullscreen] = useState(false)\n  const chartRef = useRef<HTMLDivElement>(null)\n  const { downloadCSV, downloadText } = useDownloadFile()\n\n  const colors = useMemo(() => {\n    switch (colorScheme) {\n      case 'greenRed':\n        return { bid: '#22c55e', ask: '#ef4444', bidFill: '#22c55e20', askFill: '#ef444420' }\n      case 'blueRed':\n        return { bid: '#3b82f6', ask: '#ef4444', bidFill: '#3b82f620', askFill: '#ef444420' }\n      default:\n        return { bid: '#22c55e', ask: '#ef4444', bidFill: '#22c55e20', askFill: '#ef444420' }\n    }\n  }, [colorScheme])\n\n  const chartData = useMemo(() => {\n    if (depthLevels.length > 0) {\n      return depthLevels.map(level => ({\n        price: level.price,\n        bidDepth: level.bids,\n        askDepth: level.asks,\n        bidCumulative: level.bidCumulative,\n        askCumulative: level.askCumulative,\n        spread: level.spread,\n      }))\n    }\n\n    if (data) {\n      const maxPrice = Math.max(...data.asks.map(a => a.price))\n      const minPrice = Math.min(...data.bids.map(b => b.price))\n      const priceStep = (maxPrice - minPrice) / 50\n\n      const levels: DepthPoint[] = []\n      for (let price = minPrice; price <= maxPrice; price += priceStep) {\n        const bidDepth = data.bids\n          .filter(b => b.price >= price && b.price < price + priceStep)\n          .reduce((sum, b) => sum + b.size, 0)\n        const askDepth = data.asks\n          .filter(a => a.price >= price && a.price < price + priceStep)\n          .reduce((sum, a) => sum + a.size, 0)\n\n        levels.push({\n          price: parseFloat(price.toFixed(2)),\n          bidDepth,\n          askDepth,\n          bidCumulative: 0,\n          askCumulative: 0,\n        })\n      }\n\n      let bidCum = 0\n      let askCum = 0\n      for (let i = levels.length - 1; i >= 0; i--) {\n        bidCum += levels[i].bidDepth\n        levels[i].bidCumulative = bidCum\n      }\n      for (let i = 0; i < levels.length; i++) {\n        askCum += levels[i].askDepth\n        levels[i].askCumulative = askCum\n      }\n\n      return levels\n    }\n\n    return []\n  }, [data, depthLevels])\n\n  const maxDepth = useMemo(() => {\n    return Math.max(\n      ...chartData.map(d => Math.max(showCum ? d.bidCumulative : d.bidDepth, showCum ? d.askCumulative : d.askDepth))\n    )\n  }, [chartData, showCum])\n\n  const midPrice = useMemo(() => {\n    if (data) return data.midPrice\n    if (chartData.length > 0) {\n      const bids = chartData.filter(d => d.bidDepth > 0)\n      const asks = chartData.filter(d => d.askDepth > 0)\n      if (bids.length > 0 && asks.length > 0) {\n        const bidHigh = Math.max(...bids.map(b => b.price))\n        const askLow = Math.min(...asks.map(a => a.price))\n        return (bidHigh + askLow) / 2\n      }\n    }\n    return 0\n  }, [data, chartData])\n\n  const handleExportCSV = useCallback(() => {\n    if (chartData.length === 0) return\n\n    const headers = ['Price', 'Bid Depth', 'Ask Depth', 'Bid Cumulative', 'Ask Cumulative']\n    const rows = chartData.map(row => [\n      row.price.toFixed(2),\n      row.bidDepth.toFixed(4),\n      row.askDepth.toFixed(4),\n      row.bidCumulative.toFixed(4),\n      row.askCumulative.toFixed(4),\n    ])\n\n    const csvContent = [headers.join(','), ...rows.map(r => r.join(','))].join('\\n')\n    const filename = `depth-${symbol || 'chart'}-${new Date().toISOString().slice(0, 10)}.csv`\n    downloadCSV(csvContent, filename)\n  }, [chartData, symbol, downloadCSV])\n\n  const handleExportPNG = useCallback(async () => {\n    if (!chartRef.current) return\n    setIsExporting(true)\n\n    try {\n      const html2canvas = (await import('html2canvas')).default\n      const canvas = await html2canvas(chartRef.current, { scale: 2 })\n      const dataUrl = canvas.toDataURL('image/png')\n      const filename = `depth-${symbol || 'chart'}-${new Date().toISOString().slice(0, 10)}.png`\n      downloadText(dataUrl, filename, 'image/png')\n    } catch (err) {\n      console.error('Failed to export PNG:', err)\n    } finally {\n      setIsExporting(false)\n    }\n  }, [symbol, downloadText])\n\n  if (!data && depthLevels.length === 0) {\n    return (\n      <Card className={cn('border-2 border-foreground', className)}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Activity className=\"h-5 w-5\" />\n            Order Book Depth\n          </CardTitle>\n          <CardDescription>Loading depth data...</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-64 flex items-center justify-center\">\n            <div className=\"animate-pulse flex flex-col items-center\">\n              <BarChart3 className=\"h-8 w-8 text-muted-foreground mb-2\" />\n              <span className=\"text-sm text-muted-foreground\">Waiting for market data</span>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card className={cn('border-2 border-foreground', isFullscreen && 'fixed inset-4 z-50', className)}>\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Activity className=\"h-5 w-5\" />\n              Order Book Depth\n              {symbol && <Badge variant=\"secondary\">{symbol}</Badge>}\n            </CardTitle>\n            <CardDescription>\n              {data && (\n                <span>\n                  Spread: {formatCurrency(data.spread)} ({data.spreadPercent.toFixed(3)}%) • Mid: {formatCurrency(data.midPrice)}\n                </span>\n              )}\n            </CardDescription>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Select value={selectedTimeframe} onValueChange={setSelectedTimeframe}>\n              <SelectTrigger className=\"w-32\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {TIMEFRAMES.map(tf => (\n                  <SelectItem key={tf.value} value={tf.value}>{tf.label}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            <Button variant=\"outline\" size=\"icon\" onClick={onRefresh}>\n              <RefreshCw className=\"h-4 w-4\" />\n            </Button>\n            <Button variant=\"outline\" size=\"icon\" onClick={() => setIsFullscreen(!isFullscreen)}>\n              {isFullscreen ? <Minimize2 className=\"h-4 w-4\" /> : <Maximize2 className=\"h-4 w-4\" />}\n            </Button>\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"outline\" size=\"icon\">\n                  <Settings2 className=\"h-4 w-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\">\n                <DropdownMenuItem onClick={() => setShowMid(!showMid)}>\n                  <CheckCircle className={cn('h-4 w-4 mr-2', showMid ? 'opacity-100' : 'opacity-0')} />\n                  Show Mid Price\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => setShowCum(!showCum)}>\n                  <CheckCircle className={cn('h-4 w-4 mr-2', showCum ? 'opacity-100' : 'opacity-0')} />\n                  Show Cumulative\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={() => {}}>\n                  Color Scheme\n                  <Select defaultValue={colorScheme} onValueChange={(v) => {}}>\n                    <SelectTrigger className=\"w-24 ml-2\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"blueRed\">Blue/Red</SelectItem>\n                      <SelectItem value=\"greenRed\">Green/Red</SelectItem>\n                      <SelectItem value=\"classic\">Classic</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent ref={chartRef}>\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n            <TabsTrigger value=\"depth\">Depth Chart</TabsTrigger>\n            <TabsTrigger value=\"levels\">Order Levels</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"depth\" className=\"mt-0\">\n            <div className=\"h-80\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <AreaChart data={chartData} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>\n                  <defs>\n                    <linearGradient id=\"bidGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\" stopColor={colors.bid} stopOpacity={0.8} />\n                      <stop offset=\"95%\" stopColor={colors.bid} stopOpacity={0} />\n                    </linearGradient>\n                    <linearGradient id=\"askGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\" stopColor={colors.ask} stopOpacity={0.8} />\n                      <stop offset=\"95%\" stopColor={colors.ask} stopOpacity={0} />\n                    </linearGradient>\n                  </defs>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border)\" opacity={0.3} />\n                  <XAxis\n                    dataKey=\"price\"\n                    tick={{ fontSize: 11, fontFamily: 'monospace' }}\n                    tickFormatter={(v) => formatCurrency(v)}\n                  />\n                  <YAxis\n                    tick={{ fontSize: 11, fontFamily: 'monospace' }}\n                    tickFormatter={(v) => formatNumber(v)}\n                    domain={[0, maxDepth * 1.1]}\n                  />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: 'var(--background)',\n                      border: '2px solid var(--foreground)',\n                      borderRadius: 0,\n                      boxShadow: '4px 4px 0px 0px var(--foreground)',\n                    }}\n                    formatter={(value: number, name: string) => [\n                      formatNumber(value),\n                      name === 'bidDepth' || name === 'bidCumulative' ? 'Bid' : 'Ask'\n                    ]}\n                    labelFormatter={(label) => `Price: ${formatCurrency(label)}`}\n                  />\n                  {showMid && midPrice > 0 && (\n                    <ReferenceLine\n                      x={midPrice}\n                      stroke=\"var(--muted-foreground)\"\n                      strokeDasharray=\"5 5\"\n                      label={{ value: 'Mid', position: 'top', fill: 'var(--muted-foreground)', fontSize: 10 }}\n                    />\n                  )}\n                  <Area\n                    type=\"monotone\"\n                    dataKey={showCum ? 'bidCumulative' : 'bidDepth'}\n                    stroke={colors.bid}\n                    fill=\"url(#bidGradient)\"\n                    strokeWidth={2}\n                  />\n                  <Area\n                    type=\"monotone\"\n                    dataKey={showCum ? 'askCumulative' : 'askDepth'}\n                    stroke={colors.ask}\n                    fill=\"url(#askGradient)\"\n                    strokeWidth={2}\n                  />\n                </AreaChart>\n              </ResponsiveContainer>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"levels\" className=\"mt-0\">\n            <div className=\"rounded-md border\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"text-right\">Price</TableHead>\n                    <TableHead className=\"text-right text-green-500\">Bid Size</TableHead>\n                    <TableHead className=\"text-right text-red-500\">Ask Size</TableHead>\n                    <TableHead className=\"text-right\">Price</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {depthLevels.slice(0, 20).map((level, i) => (\n                    <TableRow key={i}>\n                      <TableCell className=\"text-right font-mono text-green-500\">\n                        {formatCurrency(level.price)}\n                      </TableCell>\n                      <TableCell className=\"text-right font-mono\">\n                        {formatNumber(level.bids)}\n                      </TableCell>\n                      <TableCell className=\"text-right font-mono\">\n                        {formatNumber(level.asks)}\n                      </TableCell>\n                      <TableCell className=\"text-right font-mono text-red-500\">\n                        {formatCurrency(level.price + level.spread)}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        <div className=\"flex items-center justify-between mt-4 pt-4 border-t-2 border-foreground/10\">\n          <div className=\"flex items-center gap-4 text-sm\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-4 h-4 rounded bg-green-500\" />\n              <span className=\"text-muted-foreground\">Bids</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-4 h-4 rounded bg-red-500\" />\n              <span className=\"text-muted-foreground\">Asks</span>\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={handleExportCSV}>\n              <Download className=\"h-4 w-4 mr-2\" />\n              CSV\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleExportPNG} disabled={isExporting}>\n              <BarChart3 className=\"h-4 w-4 mr-2\" />\n              PNG\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\n\nexport default DepthChart\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAOA;AACA;AACA;AAQA;AACA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AA0ZA;;;AA/cA;;;;;;;;;;;;AAgGA,MAAM,aAAa;IACjB;QAAE,OAAO;QAAY,OAAO;IAAW;IACvC;QAAE,OAAO;QAAM,OAAO;IAAW;IACjC;QAAE,OAAO;QAAM,OAAO;IAAY;IAClC;QAAE,OAAO;QAAM,OAAO;IAAW;CAClC;AAEM,SAAS,WAAW,EACzB,IAAI,EACJ,cAAc,EAAE,EAChB,SAAS,EAAE,EACX,cAAc,SAAS,EACvB,iBAAiB,KAAK,EACtB,eAAe,IAAI,EACnB,SAAS,EACT,SAAS,EACO;;IAChB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAC;IAC3C,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,6LAAQ,EAAC;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6LAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6LAAQ,EAAC;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6LAAQ,EAAC;IAC/C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6LAAQ,EAAC;IACjD,MAAM,WAAW,IAAA,2LAAM,EAAiB;IACxC,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,GAAG,IAAA,qKAAe;IAErD,MAAM,SAAS,IAAA,4LAAO;sCAAC;YACrB,OAAQ;gBACN,KAAK;oBACH,OAAO;wBAAE,KAAK;wBAAW,KAAK;wBAAW,SAAS;wBAAa,SAAS;oBAAY;gBACtF,KAAK;oBACH,OAAO;wBAAE,KAAK;wBAAW,KAAK;wBAAW,SAAS;wBAAa,SAAS;oBAAY;gBACtF;oBACE,OAAO;wBAAE,KAAK;wBAAW,KAAK;wBAAW,SAAS;wBAAa,SAAS;oBAAY;YACxF;QACF;qCAAG;QAAC;KAAY;IAEhB,MAAM,YAAY,IAAA,4LAAO;yCAAC;YACxB,IAAI,YAAY,MAAM,GAAG,GAAG;gBAC1B,OAAO,YAAY,GAAG;qDAAC,CAAA,QAAS,CAAC;4BAC/B,OAAO,MAAM,KAAK;4BAClB,UAAU,MAAM,IAAI;4BACpB,UAAU,MAAM,IAAI;4BACpB,eAAe,MAAM,aAAa;4BAClC,eAAe,MAAM,aAAa;4BAClC,QAAQ,MAAM,MAAM;wBACtB,CAAC;;YACH;YAEA,IAAI,MAAM;gBACR,MAAM,WAAW,KAAK,GAAG,IAAI,KAAK,IAAI,CAAC,GAAG;8DAAC,CAAA,IAAK,EAAE,KAAK;;gBACvD,MAAM,WAAW,KAAK,GAAG,IAAI,KAAK,IAAI,CAAC,GAAG;8DAAC,CAAA,IAAK,EAAE,KAAK;;gBACvD,MAAM,YAAY,CAAC,WAAW,QAAQ,IAAI;gBAE1C,MAAM,SAAuB,EAAE;gBAC/B,IAAK,IAAI,QAAQ,UAAU,SAAS,UAAU,SAAS,UAAW;oBAChE,MAAM,WAAW,KAAK,IAAI,CACvB,MAAM;kEAAC,CAAA,IAAK,EAAE,KAAK,IAAI,SAAS,EAAE,KAAK,GAAG,QAAQ;iEAClD,MAAM;kEAAC,CAAC,KAAK,IAAM,MAAM,EAAE,IAAI;iEAAE;oBACpC,MAAM,WAAW,KAAK,IAAI,CACvB,MAAM;kEAAC,CAAA,IAAK,EAAE,KAAK,IAAI,SAAS,EAAE,KAAK,GAAG,QAAQ;iEAClD,MAAM;kEAAC,CAAC,KAAK,IAAM,MAAM,EAAE,IAAI;iEAAE;oBAEpC,OAAO,IAAI,CAAC;wBACV,OAAO,WAAW,MAAM,OAAO,CAAC;wBAChC;wBACA;wBACA,eAAe;wBACf,eAAe;oBACjB;gBACF;gBAEA,IAAI,SAAS;gBACb,IAAI,SAAS;gBACb,IAAK,IAAI,IAAI,OAAO,MAAM,GAAG,GAAG,KAAK,GAAG,IAAK;oBAC3C,UAAU,MAAM,CAAC,EAAE,CAAC,QAAQ;oBAC5B,MAAM,CAAC,EAAE,CAAC,aAAa,GAAG;gBAC5B;gBACA,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;oBACtC,UAAU,MAAM,CAAC,EAAE,CAAC,QAAQ;oBAC5B,MAAM,CAAC,EAAE,CAAC,aAAa,GAAG;gBAC5B;gBAEA,OAAO;YACT;YAEA,OAAO,EAAE;QACX;wCAAG;QAAC;QAAM;KAAY;IAEtB,MAAM,WAAW,IAAA,4LAAO;wCAAC;YACvB,OAAO,KAAK,GAAG,IACV,UAAU,GAAG;gDAAC,CAAA,IAAK,KAAK,GAAG,CAAC,UAAU,EAAE,aAAa,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,aAAa,GAAG,EAAE,QAAQ;;QAEjH;uCAAG;QAAC;QAAW;KAAQ;IAEvB,MAAM,WAAW,IAAA,4LAAO;wCAAC;YACvB,IAAI,MAAM,OAAO,KAAK,QAAQ;YAC9B,IAAI,UAAU,MAAM,GAAG,GAAG;gBACxB,MAAM,OAAO,UAAU,MAAM;yDAAC,CAAA,IAAK,EAAE,QAAQ,GAAG;;gBAChD,MAAM,OAAO,UAAU,MAAM;yDAAC,CAAA,IAAK,EAAE,QAAQ,GAAG;;gBAChD,IAAI,KAAK,MAAM,GAAG,KAAK,KAAK,MAAM,GAAG,GAAG;oBACtC,MAAM,UAAU,KAAK,GAAG,IAAI,KAAK,GAAG;gEAAC,CAAA,IAAK,EAAE,KAAK;;oBACjD,MAAM,SAAS,KAAK,GAAG,IAAI,KAAK,GAAG;+DAAC,CAAA,IAAK,EAAE,KAAK;;oBAChD,OAAO,CAAC,UAAU,MAAM,IAAI;gBAC9B;YACF;YACA,OAAO;QACT;uCAAG;QAAC;QAAM;KAAU;IAEpB,MAAM,kBAAkB,IAAA,gMAAW;mDAAC;YAClC,IAAI,UAAU,MAAM,KAAK,GAAG;YAE5B,MAAM,UAAU;gBAAC;gBAAS;gBAAa;gBAAa;gBAAkB;aAAiB;YACvF,MAAM,OAAO,UAAU,GAAG;gEAAC,CAAA,MAAO;wBAChC,IAAI,KAAK,CAAC,OAAO,CAAC;wBAClB,IAAI,QAAQ,CAAC,OAAO,CAAC;wBACrB,IAAI,QAAQ,CAAC,OAAO,CAAC;wBACrB,IAAI,aAAa,CAAC,OAAO,CAAC;wBAC1B,IAAI,aAAa,CAAC,OAAO,CAAC;qBAC3B;;YAED,MAAM,aAAa;gBAAC,QAAQ,IAAI,CAAC;mBAAS,KAAK,GAAG;0EAAC,CAAA,IAAK,EAAE,IAAI,CAAC;;aAAM,CAAC,IAAI,CAAC;YAC3E,MAAM,WAAW,CAAC,MAAM,EAAE,UAAU,QAAQ,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC;YAC1F,YAAY,YAAY;QAC1B;kDAAG;QAAC;QAAW;QAAQ;KAAY;IAEnC,MAAM,kBAAkB,IAAA,gMAAW;mDAAC;YAClC,IAAI,CAAC,SAAS,OAAO,EAAE;YACvB,eAAe;YAEf,IAAI;gBACF,MAAM,cAAc,CAAC,iJAA2B,EAAE,OAAO;gBACzD,MAAM,SAAS,MAAM,YAAY,SAAS,OAAO,EAAE;oBAAE,OAAO;gBAAE;gBAC9D,MAAM,UAAU,OAAO,SAAS,CAAC;gBACjC,MAAM,WAAW,CAAC,MAAM,EAAE,UAAU,QAAQ,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC;gBAC1F,aAAa,SAAS,UAAU;YAClC,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,yBAAyB;YACzC,SAAU;gBACR,eAAe;YACjB;QACF;kDAAG;QAAC;QAAQ;KAAa;IAEzB,IAAI,CAAC,QAAQ,YAAY,MAAM,KAAK,GAAG;QACrC,qBACE,iNAAC,+JAAI;YAAC,WAAW,IAAA,gJAAE,EAAC,8BAA8B;;8BAChD,iNAAC,qKAAU;;sCACT,iNAAC,oKAAS;4BAAC,WAAU;;8CACnB,iNAAC,oPAAQ;oCAAC,WAAU;;;;;;gCAAY;;;;;;;sCAGlC,iNAAC,0KAAe;sCAAC;;;;;;;;;;;;8BAEnB,iNAAC,sKAAW;8BACV,cAAA,iNAAC;wBAAI,WAAU;kCACb,cAAA,iNAAC;4BAAI,WAAU;;8CACb,iNAAC,6PAAS;oCAAC,WAAU;;;;;;8CACrB,iNAAC;oCAAK,WAAU;8CAAgC;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAM5D;IAEA,qBACE,iNAAC,+JAAI;QAAC,WAAW,IAAA,gJAAE,EAAC,8BAA8B,gBAAgB,sBAAsB;;0BACtF,iNAAC,qKAAU;gBAAC,WAAU;0BACpB,cAAA,iNAAC;oBAAI,WAAU;;sCACb,iNAAC;;8CACC,iNAAC,oKAAS;oCAAC,WAAU;;sDACnB,iNAAC,oPAAQ;4CAAC,WAAU;;;;;;wCAAY;wCAE/B,wBAAU,iNAAC,iKAAK;4CAAC,SAAQ;sDAAa;;;;;;;;;;;;8CAEzC,iNAAC,0KAAe;8CACb,sBACC,iNAAC;;4CAAK;4CACK,IAAA,4JAAc,EAAC,KAAK,MAAM;4CAAE;4CAAG,KAAK,aAAa,CAAC,OAAO,CAAC;4CAAG;4CAAW,IAAA,4JAAc,EAAC,KAAK,QAAQ;;;;;;;;;;;;;;;;;;sCAKrH,iNAAC;4BAAI,WAAU;;8CACb,iNAAC,mKAAM;oCAAC,OAAO;oCAAmB,eAAe;;sDAC/C,iNAAC,0KAAa;4CAAC,WAAU;sDACvB,cAAA,iNAAC,wKAAW;;;;;;;;;;sDAEd,iNAAC,0KAAa;sDACX,WAAW,GAAG,CAAC,CAAA,mBACd,iNAAC,uKAAU;oDAAgB,OAAO,GAAG,KAAK;8DAAG,GAAG,KAAK;mDAApC,GAAG,KAAK;;;;;;;;;;;;;;;;8CAI/B,iNAAC,mKAAM;oCAAC,SAAQ;oCAAU,MAAK;oCAAO,SAAS;8CAC7C,cAAA,iNAAC,2PAAS;wCAAC,WAAU;;;;;;;;;;;8CAEvB,iNAAC,mKAAM;oCAAC,SAAQ;oCAAU,MAAK;oCAAO,SAAS,IAAM,gBAAgB,CAAC;8CACnE,6BAAe,iNAAC,2PAAS;wCAAC,WAAU;;;;;6DAAe,iNAAC,2PAAS;wCAAC,WAAU;;;;;;;;;;;8CAE3E,iNAAC,mLAAY;;sDACX,iNAAC,0LAAmB;4CAAC,OAAO;sDAC1B,cAAA,iNAAC,mKAAM;gDAAC,SAAQ;gDAAU,MAAK;0DAC7B,cAAA,iNAAC,2PAAS;oDAAC,WAAU;;;;;;;;;;;;;;;;sDAGzB,iNAAC,0LAAmB;4CAAC,OAAM;;8DACzB,iNAAC,uLAAgB;oDAAC,SAAS,IAAM,WAAW,CAAC;;sEAC3C,iNAAC,wQAAW;4DAAC,WAAW,IAAA,gJAAE,EAAC,gBAAgB,UAAU,gBAAgB;;;;;;wDAAgB;;;;;;;8DAGvF,iNAAC,uLAAgB;oDAAC,SAAS,IAAM,WAAW,CAAC;;sEAC3C,iNAAC,wQAAW;4DAAC,WAAW,IAAA,gJAAE,EAAC,gBAAgB,UAAU,gBAAgB;;;;;;wDAAgB;;;;;;;8DAGvF,iNAAC,4LAAqB;;;;;8DACtB,iNAAC,uLAAgB;oDAAC,SAAS,KAAO;;wDAAG;sEAEnC,iNAAC,mKAAM;4DAAC,cAAc;4DAAa,eAAe,CAAC,KAAO;;8EACxD,iNAAC,0KAAa;oEAAC,WAAU;8EACvB,cAAA,iNAAC,wKAAW;;;;;;;;;;8EAEd,iNAAC,0KAAa;;sFACZ,iNAAC,uKAAU;4EAAC,OAAM;sFAAU;;;;;;sFAC5B,iNAAC,uKAAU;4EAAC,OAAM;sFAAW;;;;;;sFAC7B,iNAAC,uKAAU;4EAAC,OAAM;sFAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAS5C,iNAAC,sKAAW;gBAAC,KAAK;;kCAChB,iNAAC,+JAAI;wBAAC,OAAO;wBAAW,eAAe;;0CACrC,iNAAC,mKAAQ;gCAAC,WAAU;;kDAClB,iNAAC,sKAAW;wCAAC,OAAM;kDAAQ;;;;;;kDAC3B,iNAAC,sKAAW;wCAAC,OAAM;kDAAS;;;;;;;;;;;;0CAG9B,iNAAC,sKAAW;gCAAC,OAAM;gCAAQ,WAAU;0CACnC,cAAA,iNAAC;oCAAI,WAAU;8CACb,cAAA,iNAAC,wNAAmB;wCAAC,OAAM;wCAAO,QAAO;kDACvC,cAAA,iNAAC,gMAAS;4CAAC,MAAM;4CAAW,QAAQ;gDAAE,KAAK;gDAAI,OAAO;gDAAI,MAAM;gDAAG,QAAQ;4CAAE;;8DAC3E,iNAAC;;sEACC,iNAAC;4DAAe,IAAG;4DAAc,IAAG;4DAAI,IAAG;4DAAI,IAAG;4DAAI,IAAG;;8EACvD,iNAAC;oEAAK,QAAO;oEAAK,WAAW,OAAO,GAAG;oEAAE,aAAa;;;;;;8EACtD,iNAAC;oEAAK,QAAO;oEAAM,WAAW,OAAO,GAAG;oEAAE,aAAa;;;;;;;;;;;;sEAEzD,iNAAC;4DAAe,IAAG;4DAAc,IAAG;4DAAI,IAAG;4DAAI,IAAG;4DAAI,IAAG;;8EACvD,iNAAC;oEAAK,QAAO;oEAAK,WAAW,OAAO,GAAG;oEAAE,aAAa;;;;;;8EACtD,iNAAC;oEAAK,QAAO;oEAAM,WAAW,OAAO,GAAG;oEAAE,aAAa;;;;;;;;;;;;;;;;;;8DAG3D,iNAAC,4MAAa;oDAAC,iBAAgB;oDAAM,QAAO;oDAAgB,SAAS;;;;;;8DACrE,iNAAC,4LAAK;oDACJ,SAAQ;oDACR,MAAM;wDAAE,UAAU;wDAAI,YAAY;oDAAY;oDAC9C,eAAe,CAAC,IAAM,IAAA,4JAAc,EAAC;;;;;;8DAEvC,iNAAC,4LAAK;oDACJ,MAAM;wDAAE,UAAU;wDAAI,YAAY;oDAAY;oDAC9C,eAAe,CAAC,IAAM,IAAA,0JAAY,EAAC;oDACnC,QAAQ;wDAAC;wDAAG,WAAW;qDAAI;;;;;;8DAE7B,iNAAC,gMAAO;oDACN,cAAc;wDACZ,iBAAiB;wDACjB,QAAQ;wDACR,cAAc;wDACd,WAAW;oDACb;oDACA,WAAW,CAAC,OAAe,OAAiB;4DAC1C,IAAA,0JAAY,EAAC;4DACb,SAAS,cAAc,SAAS,kBAAkB,QAAQ;yDAC3D;oDACD,gBAAgB,CAAC,QAAU,CAAC,OAAO,EAAE,IAAA,4JAAc,EAAC,QAAQ;;;;;;gDAE7D,WAAW,WAAW,mBACrB,iNAAC,4MAAa;oDACZ,GAAG;oDACH,QAAO;oDACP,iBAAgB;oDAChB,OAAO;wDAAE,OAAO;wDAAO,UAAU;wDAAO,MAAM;wDAA2B,UAAU;oDAAG;;;;;;8DAG1F,iNAAC,0LAAI;oDACH,MAAK;oDACL,SAAS,UAAU,kBAAkB;oDACrC,QAAQ,OAAO,GAAG;oDAClB,MAAK;oDACL,aAAa;;;;;;8DAEf,iNAAC,0LAAI;oDACH,MAAK;oDACL,SAAS,UAAU,kBAAkB;oDACrC,QAAQ,OAAO,GAAG;oDAClB,MAAK;oDACL,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;0CAOvB,iNAAC,sKAAW;gCAAC,OAAM;gCAAS,WAAU;0CACpC,cAAA,iNAAC;oCAAI,WAAU;8CACb,cAAA,iNAAC,iKAAK;;0DACJ,iNAAC,uKAAW;0DACV,cAAA,iNAAC,oKAAQ;;sEACP,iNAAC,qKAAS;4DAAC,WAAU;sEAAa;;;;;;sEAClC,iNAAC,qKAAS;4DAAC,WAAU;sEAA4B;;;;;;sEACjD,iNAAC,qKAAS;4DAAC,WAAU;sEAA0B;;;;;;sEAC/C,iNAAC,qKAAS;4DAAC,WAAU;sEAAa;;;;;;;;;;;;;;;;;0DAGtC,iNAAC,qKAAS;0DACP,YAAY,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,OAAO,kBACpC,iNAAC,oKAAQ;;0EACP,iNAAC,qKAAS;gEAAC,WAAU;0EAClB,IAAA,4JAAc,EAAC,MAAM,KAAK;;;;;;0EAE7B,iNAAC,qKAAS;gEAAC,WAAU;0EAClB,IAAA,0JAAY,EAAC,MAAM,IAAI;;;;;;0EAE1B,iNAAC,qKAAS;gEAAC,WAAU;0EAClB,IAAA,0JAAY,EAAC,MAAM,IAAI;;;;;;0EAE1B,iNAAC,qKAAS;gEAAC,WAAU;0EAClB,IAAA,4JAAc,EAAC,MAAM,KAAK,GAAG,MAAM,MAAM;;;;;;;uDAX/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAqB3B,iNAAC;wBAAI,WAAU;;0CACb,iNAAC;gCAAI,WAAU;;kDACb,iNAAC;wCAAI,WAAU;;0DACb,iNAAC;gDAAI,WAAU;;;;;;0DACf,iNAAC;gDAAK,WAAU;0DAAwB;;;;;;;;;;;;kDAE1C,iNAAC;wCAAI,WAAU;;0DACb,iNAAC;gDAAI,WAAU;;;;;;0DACf,iNAAC;gDAAK,WAAU;0DAAwB;;;;;;;;;;;;;;;;;;0CAG5C,iNAAC;gCAAI,WAAU;;kDACb,iNAAC,mKAAM;wCAAC,SAAQ;wCAAU,MAAK;wCAAK,SAAS;;0DAC3C,iNAAC,oPAAQ;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;kDAGvC,iNAAC,mKAAM;wCAAC,SAAQ;wCAAU,MAAK;wCAAK,SAAS;wCAAiB,UAAU;;0DACtE,iNAAC,6PAAS;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQpD;GAtWgB;;QAiBwB,qKAAe;;;KAjBvC;;uCAgXD"}},
    {"offset": {"line": 11638, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/OrderBook.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo } from 'react'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport {\n  ArrowUp,\n  ArrowDown,\n  Activity,\n  RefreshCw,\n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n} from 'lucide-react'\nimport { cn, formatNumber, formatCurrency } from '@/lib/utils'\n\nexport interface OrderBookLevelData {\n  price: number\n  quantity: number\n  total: number\n}\n\nexport interface OrderBookMetrics {\n  spread: number\n  spread_pct: number\n  total_bid_volume: number\n  total_ask_volume: number\n  top_5_bid_volume: number\n  top_5_ask_volume: number\n  vwap_bid: number | null\n  vwap_ask: number | null\n  order_imbalance: number | null\n  timestamp: string\n}\n\nexport interface OrderBookData {\n  bids: OrderBookLevelData[]\n  asks: OrderBookLevelData[]\n  metrics: OrderBookMetrics\n}\n\ninterface OrderBookProps {\n  data?: OrderBookData\n  symbol?: string\n  depth?: number\n  className?: string\n  onRefresh?: () => void\n}\n\nexport function OrderBook({\n  data,\n  symbol = '',\n  depth = 15,\n  className,\n  onRefresh,\n}: OrderBookProps) {\n  const [activeTab, setActiveTab] = useState('book')\n  const [showPercent, setShowPercent] = useState(true)\n\n  const maxTotal = useMemo(() => {\n    if (!data) return 1\n    const maxBid = Math.max(...data.bids.map(b => b.total), 0)\n    const maxAsk = Math.max(...data.asks.map(a => a.total), 0)\n    return Math.max(maxBid, maxAsk)\n  }, [data])\n\n  const spread = data?.metrics.spread ?? null\n  const spreadPct = data?.metrics.spread_pct ?? null\n  const imbalance = data?.metrics.order_imbalance ?? null\n\n  const getDepthBarWidth = (total: number) => {\n    if (maxTotal === 0) return '0%'\n    return `${(total / maxTotal) * 100}%`\n  }\n\n  const getImbalanceColor = (value: number | null) => {\n    if (value === null) return 'bg-gray-500'\n    if (value > 0.3) return 'bg-green-500'\n    if (value > 0.1) return 'bg-green-400'\n    if (value > -0.1) return 'bg-yellow-500'\n    if (value > -0.3) return 'bg-orange-400'\n    return 'bg-red-500'\n  }\n\n  const getImbalanceLabel = (value: number | null) => {\n    if (value === null) return 'N/A'\n    if (value > 0.3) return 'Strong Buy'\n    if (value > 0.1) return 'Buy'\n    if (value > -0.1) return 'Neutral'\n    if (value > -0.3) return 'Sell'\n    return 'Strong Sell'\n  }\n\n  if (!data) {\n    return (\n      <Card className={cn('border-2 border-foreground', className)}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Activity className=\"h-5 w-5\" />\n            Order Book\n            {symbol && <Badge variant=\"secondary\">{symbol}</Badge>}\n          </CardTitle>\n          <CardDescription>Loading order book data...</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-96 flex items-center justify-center\">\n            <div className=\"animate-pulse flex flex-col items-center\">\n              <Activity className=\"h-8 w-8 text-muted-foreground mb-2\" />\n              <span className=\"text-sm text-muted-foreground\">Waiting for market data</span>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card className={cn('border-2 border-foreground', className)}>\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Activity className=\"h-5 w-5\" />\n              Order Book\n              {symbol && <Badge variant=\"secondary\">{symbol}</Badge>}\n            </CardTitle>\n            <CardDescription className=\"flex items-center gap-3 mt-1\">\n                <span className=\"flex items-center gap-1\">\n                  Spread: <span className=\"font-mono font-medium\">{spread ? formatCurrency(spread) : '-'}</span>\n                  <span className=\"text-muted-foreground\">({spreadPct?.toFixed(3)}%)</span>\n                </span>\n                <span className=\"flex items-center gap-1\">\n                  <DollarSign className=\"h-3 w-3\" />\n                  Imbalance:\n                  <span className={cn('font-mono font-medium px-1 rounded', imbalance !== null && imbalance !== undefined ? getImbalanceColor(imbalance) : '')}>\n                    {imbalance !== null && imbalance !== undefined ? imbalance.toFixed(3) : 'N/A'}\n                  </span>\n                  <span className=\"text-muted-foreground\">({imbalance !== null && imbalance !== undefined ? getImbalanceLabel(imbalance) : 'N/A'})</span>\n                </span>\n            </CardDescription>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"outline\" size=\"icon\" onClick={onRefresh}>\n              <RefreshCw className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n            <TabsTrigger value=\"book\">Order Book</TabsTrigger>\n            <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"book\" className=\"mt-0\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"rounded-md border\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"text-right\">Price</TableHead>\n                      <TableHead className=\"text-right\">Size</TableHead>\n                      {showPercent && <TableHead className=\"text-right\">Total</TableHead>}\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {data.asks.slice(0, depth).reverse().map((level, i) => (\n                      <TableRow key={i}>\n                        <TableCell className=\"text-right font-mono text-red-500\">\n                          {formatCurrency(level.price)}\n                        </TableCell>\n                        <TableCell className=\"text-right font-mono\">\n                          <div className=\"flex items-center justify-end gap-2\">\n                            <span>{formatNumber(level.quantity)}</span>\n                            <div\n                              className=\"h-1 bg-red-500/30\"\n                              style={{ width: getDepthBarWidth(level.total) }}\n                            />\n                          </div>\n                        </TableCell>\n                        {showPercent && (\n                          <TableCell className=\"text-right font-mono text-muted-foreground\">\n                            {formatCurrency(level.total)}\n                          </TableCell>\n                        )}\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n\n              <div className=\"rounded-md border\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      {showPercent && <TableHead className=\"text-left\">Total</TableHead>}\n                      <TableHead className=\"text-left\">Size</TableHead>\n                      <TableHead className=\"text-left text-green-500\">Price</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {data.bids.slice(0, depth).map((level, i) => (\n                      <TableRow key={i}>\n                        {showPercent && (\n                          <TableCell className=\"text-left font-mono text-muted-foreground\">\n                            <div className=\"flex items-center gap-2\">\n                              <div\n                                className=\"h-1 bg-green-500/30\"\n                                style={{ width: getDepthBarWidth(level.total) }}\n                              />\n                              <span>{formatCurrency(level.total)}</span>\n                            </div>\n                          </TableCell>\n                        )}\n                        <TableCell className=\"text-left font-mono\">\n                          {formatNumber(level.quantity)}\n                        </TableCell>\n                        <TableCell className=\"text-left font-mono text-green-500\">\n                          {formatCurrency(level.price)}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-between mt-4 pt-4 border-t-2 border-foreground/10\">\n              <div className=\"flex items-center gap-4 text-sm\">\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-4 h-4 rounded bg-red-500\" />\n                  <span className=\"text-muted-foreground\">Asks (Sellers)</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-4 h-4 rounded bg-green-500\" />\n                  <span className=\"text-muted-foreground\">Bids (Buyers)</span>\n                </div>\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                Last update: {data.metrics.timestamp ? new Date(data.metrics.timestamp).toLocaleTimeString() : 'N/A'}\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"analytics\" className=\"mt-0\">\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div className=\"p-4 rounded-lg border bg-card\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-1\">\n                  <TrendingUp className=\"h-4 w-4 text-green-500\" />\n                  Total Bid Vol\n                </div>\n                <div className=\"text-2xl font-mono font-bold\">\n                  {formatNumber(data.metrics.total_bid_volume)}\n                </div>\n              </div>\n\n              <div className=\"p-4 rounded-lg border bg-card\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-1\">\n                  <TrendingDown className=\"h-4 w-4 text-red-500\" />\n                  Total Ask Vol\n                </div>\n                <div className=\"text-2xl font-mono font-bold\">\n                  {formatNumber(data.metrics.total_ask_volume)}\n                </div>\n              </div>\n\n              <div className=\"p-4 rounded-lg border bg-card\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-1\">\n                  <ArrowUp className=\"h-4 w-4 text-blue-500\" />\n                  VWAP Bid\n                </div>\n                <div className=\"text-2xl font-mono font-bold\">\n                  {data.metrics.vwap_bid ? formatCurrency(data.metrics.vwap_bid) : 'N/A'}\n                </div>\n              </div>\n\n              <div className=\"p-4 rounded-lg border bg-card\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-1\">\n                  <ArrowDown className=\"h-4 w-4 text-blue-500\" />\n                  VWAP Ask\n                </div>\n                <div className=\"text-2xl font-mono font-bold\">\n                  {data.metrics.vwap_ask ? formatCurrency(data.metrics.vwap_ask) : 'N/A'}\n                </div>\n              </div>\n\n              <div className=\"p-4 rounded-lg border bg-card\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-1\">\n                  Top 5 Bid Vol\n                </div>\n                <div className=\"text-2xl font-mono font-bold text-green-500\">\n                  {formatNumber(data.metrics.top_5_bid_volume)}\n                </div>\n              </div>\n\n              <div className=\"p-4 rounded-lg border bg-card\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-1\">\n                  Top 5 Ask Vol\n                </div>\n                <div className=\"text-2xl font-mono font-bold text-red-500\">\n                  {formatNumber(data.metrics.top_5_ask_volume)}\n                </div>\n              </div>\n\n              <div className=\"p-4 rounded-lg border bg-card col-span-2\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-2\">\n                  Order Imbalance\n                </div>\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"flex-1 h-4 rounded-full bg-gray-200 overflow-hidden\">\n                    <div\n                      className={cn('h-full transition-all', imbalance !== null && imbalance !== undefined ? getImbalanceColor(imbalance) : '')}\n                      style={{\n                        width: `${((imbalance ?? 0) + 1) * 50}%`,\n                      }}\n                    />\n                  </div>\n                  <div className=\"text-lg font-mono font-bold\">\n                    {imbalance !== null && imbalance !== undefined ? imbalance.toFixed(3) : 'N/A'}\n                  </div>\n                  <Badge variant=\"secondary\">\n                    {imbalance !== null && imbalance !== undefined ? getImbalanceLabel(imbalance) : 'N/A'}\n                  </Badge>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport default OrderBook\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 12600, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/ChartWrapper.tsx"],"sourcesContent":["'use client'\n\nimport { ErrorBoundary } from '@/components/ui/ErrorBoundary'\nimport type { ReactNode } from 'react'\n\ninterface ChartWrapperProps {\n  children: ReactNode\n  fallback?: ReactNode\n  className?: string\n}\n\nexport function ChartWrapper({ children, fallback, className }: ChartWrapperProps) {\n  return (\n    <ErrorBoundary fallback={fallback} className={className}>\n      {children}\n    </ErrorBoundary>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAWO,SAAS,aAAa,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAqB;IAC/E,qBACE,iNAAC,iLAAa;QAAC,UAAU;QAAU,WAAW;kBAC3C;;;;;;AAGP;KANgB"}},
    {"offset": {"line": 12630, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/HistoricalDataExport.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport {\n  Calendar,\n  Download,\n  FileSpreadsheet,\n  FileJson,\n  FileText,\n  Clock,\n  TrendingUp,\n  Database,\n  RefreshCw,\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { useDownloadFile } from '@/hooks/useDownload'\nimport { format, subDays, subMonths, subYears } from 'date-fns'\n\ninterface HistoricalDataExportProps {\n  symbol?: string\n  className?: string\n}\n\ninterface ExportConfig {\n  symbol: string\n  startDate: string\n  endDate: string\n  interval: '1d' | '1wk' | '1mo'\n  adjustments: 'splits' | 'dividends' | 'unadjusted' | 'all'\n  includeExtended: boolean\n}\n\nconst INTERVALS = [\n  { value: '1d', label: 'Daily', description: 'Trading days only' },\n  { value: '1wk', label: 'Weekly', description: 'End of week prices' },\n  { value: '1mo', label: 'Monthly', description: 'End of month prices' },\n]\n\nconst ADJUSTMENTS = [\n  { value: 'splits', label: 'Splits Only', description: 'Adjusted for splits' },\n  { value: 'dividends', label: 'Dividends Only', description: 'Adjusted for dividends' },\n  { value: 'unadjusted', label: 'Unadjusted', description: 'Raw prices' },\n  { value: 'all', label: 'All Adjustments', description: 'Both splits & dividends' },\n]\n\nconst PRESETS = [\n  { label: 'Last 7 Days', days: 7 },\n  { label: 'Last 30 Days', days: 30 },\n  { label: 'Last 3 Months', months: 3 },\n  { label: 'Last 6 Months', months: 6 },\n  { label: 'Last Year', years: 1 },\n  { label: 'Last 5 Years', years: 5 },\n  { label: 'All Time', years: 10 },\n]\n\nfunction generateMockData(config: ExportConfig): Array<{\n  date: string\n  open: number\n  high: number\n  low: number\n  close: number\n  volume: number\n  adjusted_close: number\n}> {\n  const start = new Date(config.startDate)\n  const end = new Date(config.endDate)\n  const data: Array<{\n    date: string\n    open: number\n    high: number\n    low: number\n    close: number\n    volume: number\n    adjusted_close: number\n  }> = []\n\n  let currentDate = new Date(start)\n  let basePrice = 150 + Math.random() * 50\n\n  while (currentDate <= end) {\n    const dayData = {\n      date: format(currentDate, 'yyyy-MM-dd'),\n      open: basePrice,\n      high: basePrice * (1 + Math.random() * 0.04),\n      low: basePrice * (1 - Math.random() * 0.04),\n      close: basePrice * (0.98 + Math.random() * 0.04),\n      volume: Math.floor(Math.random() * 50000000) + 10000000,\n      adjusted_close: basePrice * (0.97 + Math.random() * 0.06),\n    }\n    data.push(dayData)\n    basePrice = dayData.close\n    currentDate.setDate(currentDate.getDate() + 1)\n  }\n\n  return data\n}\n\nexport function HistoricalDataExport({ symbol = 'AAPL', className }: HistoricalDataExportProps) {\n  const [loading, setLoading] = useState(false)\n  const [config, setConfig] = useState<ExportConfig>({\n    symbol,\n    startDate: format(subYears(new Date(), 1), 'yyyy-MM-dd'),\n    endDate: format(new Date(), 'yyyy-MM-dd'),\n    interval: '1d',\n    adjustments: 'all',\n    includeExtended: false,\n  })\n  const [preview, setPreview] = useState<Array<{\n    date: string\n    open: number\n    high: number\n    low: number\n    close: number\n    volume: number\n  }> | null>(null)\n  const { downloadCSV, downloadJSON } = useDownloadFile()\n\n  const applyPreset = (preset: typeof PRESETS[0]) => {\n    const endDate = new Date()\n    let startDate: Date\n\n    if (preset.days) {\n      startDate = subDays(endDate, preset.days)\n    } else if (preset.months) {\n      startDate = subMonths(endDate, preset.months)\n    } else if (preset.years) {\n      startDate = subYears(endDate, preset.years)\n    } else {\n      startDate = subYears(endDate, 1)\n    }\n\n    setConfig((prev) => ({\n      ...prev,\n      startDate: format(startDate, 'yyyy-MM-dd'),\n      endDate: format(endDate, 'yyyy-MM-dd'),\n    }))\n  }\n\n  const handlePreview = () => {\n    setLoading(true)\n    setTimeout(() => {\n      const data = generateMockData(config).slice(0, 5)\n      setPreview(data.map(({ adjusted_close, ...rest }) => rest))\n      setLoading(false)\n    }, 800)\n  }\n\n  const handleExportCSV = () => {\n    const data = generateMockData(config)\n    const headers = ['Date', 'Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted_Close']\n    const rows = data.map((d) => ({\n      Date: d.date,\n      Open: d.open.toFixed(4),\n      High: d.high.toFixed(4),\n      Low: d.low.toFixed(4),\n      Close: d.close.toFixed(4),\n      Volume: d.volume.toString(),\n      Adjusted_Close: d.adjusted_close.toFixed(4),\n    }))\n    downloadCSV(rows, `${symbol}_historical_data`)\n  }\n\n  const handleExportJSON = () => {\n    const data = generateMockData(config)\n    downloadJSON(data, `${symbol}_historical_data`)\n  }\n\n  const handleExportYAML = () => {\n    const data = generateMockData(config)\n    const yaml = `symbol: ${symbol}\nstart_date: ${config.startDate}\nend_date: ${config.endDate}\ninterval: ${config.interval}\nadjustments: ${config.adjustments}\ndata:\\n${data.map((d) => `  - date: ${d.date}\n    open: ${d.open.toFixed(4)}\n    high: ${d.high.toFixed(4)}\n    low: ${d.low.toFixed(4)}\n    close: ${d.close.toFixed(4)}\n    volume: ${d.volume}\n    adjusted_close: ${d.adjusted_close.toFixed(4)}`).join('\\n')}`\n    const blob = new Blob([yaml], { type: 'text/yaml' })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = `${symbol}_historical_data.yaml`\n    a.click()\n    URL.revokeObjectURL(url)\n  }\n\n  const dataPoints = preview?.length || 0\n\n  return (\n    <Card className={cn('', className)}>\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg flex items-center gap-2\">\n          <Database className=\"h-5 w-5\" />\n          Historical Data Export\n          {symbol && (\n            <Badge variant=\"secondary\" className=\"ml-2\">\n              {symbol}\n            </Badge>\n          )}\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Start Date</Label>\n                <Input\n                  type=\"date\"\n                  value={config.startDate}\n                  onChange={(e) => setConfig((prev) => ({ ...prev, startDate: e.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>End Date</Label>\n                <Input\n                  type=\"date\"\n                  value={config.endDate}\n                  onChange={(e) => setConfig((prev) => ({ ...prev, endDate: e.target.value }))}\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Quick Select</Label>\n              <div className=\"flex flex-wrap gap-2\">\n                {PRESETS.map((preset) => (\n                  <Button\n                    key={preset.label}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => applyPreset(preset)}\n                  >\n                    {preset.label}\n                  </Button>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Interval</Label>\n                <Select\n                  value={config.interval}\n                  onValueChange={(v) => setConfig((prev) => ({ ...prev, interval: v as ExportConfig['interval'] }))}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {INTERVALS.map((interval) => (\n                      <SelectItem key={interval.value} value={interval.value}>\n                        <div>\n                          <div className=\"font-medium\">{interval.label}</div>\n                          <div className=\"text-xs text-muted-foreground\">{interval.description}</div>\n                        </div>\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Adjustments</Label>\n                <Select\n                  value={config.adjustments}\n                  onValueChange={(v) => setConfig((prev) => ({ ...prev, adjustments: v as ExportConfig['adjustments'] }))}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {ADJUSTMENTS.map((adj) => (\n                      <SelectItem key={adj.value} value={adj.value}>\n                        <div>\n                          <div className=\"font-medium\">{adj.label}</div>\n                          <div className=\"text-xs text-muted-foreground\">{adj.description}</div>\n                        </div>\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <Button onClick={handlePreview} disabled={loading} className=\"w-full\">\n              {loading ? (\n                <>\n                  <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                  Generating Preview...\n                </>\n              ) : (\n                <>\n                  <Clock className=\"h-4 w-4 mr-2\" />\n                  Preview Data\n                </>\n              )}\n            </Button>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div className=\"bg-muted/50 rounded-lg p-4\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <h4 className=\"font-medium\">Export Options</h4>\n              </div>\n\n              <div className=\"grid grid-cols-3 gap-2 mb-4\">\n                <Button variant=\"outline\" onClick={handleExportCSV}>\n                  <FileSpreadsheet className=\"h-4 w-4 mr-2\" />\n                  CSV\n                </Button>\n                <Button variant=\"outline\" onClick={handleExportJSON}>\n                  <FileJson className=\"h-4 w-4 mr-2\" />\n                  JSON\n                </Button>\n                <Button variant=\"outline\" onClick={handleExportYAML}>\n                  <FileText className=\"h-4 w-4 mr-2\" />\n                  YAML\n                </Button>\n              </div>\n\n              <div className=\"text-xs text-muted-foreground\">\n                <div className=\"flex items-center gap-1\">\n                  <TrendingUp className=\"h-3 w-3\" />\n                  <span>Includes: OHLCV + Adjusted Close</span>\n                </div>\n              </div>\n            </div>\n\n            {preview && (\n              <div className=\"bg-muted/50 rounded-lg p-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h4 className=\"font-medium\">Preview ({dataPoints} rows)</h4>\n                  <Badge variant=\"outline\">{config.interval.toUpperCase()}</Badge>\n                </div>\n\n                <div className=\"space-y-1\">\n                  <div className=\"grid grid-cols-6 gap-2 text-xs font-medium\">\n                    <div>Date</div>\n                    <div>Open</div>\n                    <div>High</div>\n                    <div>Low</div>\n                    <div>Close</div>\n                    <div>Volume</div>\n                  </div>\n                  {preview.map((row, i) => (\n                    <div key={i} className=\"grid grid-cols-6 gap-2 text-xs\">\n                      <div className=\"truncate\">{row.date}</div>\n                      <div>${row.open.toFixed(2)}</div>\n                      <div>${row.high.toFixed(2)}</div>\n                      <div>${row.low.toFixed(2)}</div>\n                      <div className=\"font-medium\">${row.close.toFixed(2)}</div>\n                      <div className=\"text-muted-foreground\">{(row.volume / 1000000).toFixed(1)}M</div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {!preview && !loading && (\n              <div className=\"bg-muted/50 rounded-lg p-8 text-center text-muted-foreground\">\n                <Calendar className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                <p className=\"text-sm\">Click \"Preview Data\" to see sample</p>\n              </div>\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 13545, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergi/Desktop/Projects/FinanceHub/apps/frontend/src/components/charts/index.ts"],"sourcesContent":["export { TradingViewChart, type ChartType, type Timeframe } from './TradingViewChart'\nexport { AdvancedChart, type ChartType as AdvancedChartType, type Timeframe as AdvancedTimeframe, type DrawingType, type Drawing } from './AdvancedChart'\nexport { ChartControls } from './ChartControls'\nexport { TechnicalIndicators } from './TechnicalIndicators'\nexport { TechnicalIndicatorsPanel } from './TechnicalIndicatorsPanel'\nexport { IndicatorConfigModal } from './IndicatorConfigModal'\nexport { DrawingTools } from './DrawingTools'\nexport { ComparisonChart } from './ComparisonChart'\nexport { HoldingsPnLChart } from './HoldingsPnLChart'\nexport { HoldingsAllocationChart } from './HoldingsAllocationChart'\nexport { TopHoldingsChart } from './TopHoldingsChart'\nexport { MarketHeatmap, MarketHeatmapSkeleton, type Timeframe as HeatmapTimeframe } from './MarketHeatmap'\nexport { VolumeProfileChart, type VolumeProfileData, type VolumeProfilePoint } from './VolumeProfileChart'\nexport { CandlestickChart, type CandlestickData } from './CandlestickChart'\nexport { LineChart, type LineData } from './LineChart'\nexport { AreaChart, type AreaData } from './AreaChart'\nexport { HeikinAshiChart, type HeikinAshiData } from './HeikinAshiChart'\nexport { RenkoChart } from './RenkoChart'\nexport { KagiChart } from './KagiChart'\nexport { DepthChart } from './DepthChart'\nexport { OrderBook, type OrderBookData, type OrderBookLevelData, type OrderBookMetrics } from './OrderBook'\nexport { ChartWrapper } from './ChartWrapper'\nexport { HistoricalDataExport } from './HistoricalDataExport'\nexport { ChartScreenReader, ScreenReaderTable, ScreenReaderSummary } from './ScreenReaderChart'"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}}]
}