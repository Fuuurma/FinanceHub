module.exports=[30561,a=>{"use strict";var b=a.i(86531),c=a.i(9644),d=a.i(49657),e=a.i(61219),f=a.i(4631),g=a.i(59820),h=a.i(22194),i=a.i(88029),j=a.i(55694),k=a.i(92098),l=a.i(34319);function m({title:a,children:c,description:e}){return(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:a}),e&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:e})]}),(0,b.jsx)(d.CardContent,{children:c})]})}var n=a.i(63547),o=a.i(10658),p=a.i(63638),q=a.i(25166);function r({data:a}){let c=["#3B82F6","#0088FE","#00C49F","#FFBB28","#FF8042","#8B5CF6","#1aff1a"];return(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsx)(o.PieChart,{children:(0,b.jsx)(n.Pie,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:a=>`${a.name}: ${a.percentage}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:a.map((a,d)=>(0,b.jsx)(p.Cell,{fill:c[d%c.length]},`cell-${d}`))})})})}var s=a.i(50524),t=a.i(36096),u=a.i(28054),v=a.i(46280),w=a.i(81726),x=a.i(14767),y=a.i(53427);function z({data:a}){return(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:350,children:(0,b.jsxs)(t.BarChart,{data:a,layout:"vertical",children:[(0,b.jsx)(y.CartesianGrid,{strokeDasharray:"3 3",vertical:!1}),(0,b.jsx)(u.XAxis,{dataKey:"symbol",tick:{fontSize:12}}),(0,b.jsx)(v.YAxis,{tick:{fontSize:12}}),(0,b.jsx)(w.Tooltip,{formatter:(a,c,d)=>(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:c}),(0,b.jsxs)("p",{children:["Return: ","number"==typeof a?`${a.toFixed(2)}%`:a]})]})}),(0,b.jsx)(x.Legend,{}),(0,b.jsx)(s.Bar,{dataKey:"return",fill:"#8884d8",name:"Return %",radius:[4,4,0,0]}),(0,b.jsx)(s.Bar,{dataKey:"current_value",fill:"#82ca9d",name:"Current Value",radius:[4,4,0,0]})]})})}var A=a.i(84429),B=a.i(50727);function C({data:a}){return(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(A.LineChart,{data:a,children:[(0,b.jsx)(y.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(u.XAxis,{dataKey:"date",tick:{fontSize:12},tickFormatter:a=>new Date(a).toLocaleDateString()}),(0,b.jsx)(v.YAxis,{tick:{fontSize:12},tickFormatter:a=>`${a}%`}),(0,b.jsx)(w.Tooltip,{labelFormatter:a=>new Date(a).toLocaleDateString(),formatter:a=>[`${a.toFixed(2)}%`,""]}),(0,b.jsx)(x.Legend,{}),(0,b.jsx)(B.Line,{type:"monotone",dataKey:"portfolio",stroke:"#22c55e",name:"Portfolio",strokeWidth:2,dot:{r:4}}),(0,b.jsx)(B.Line,{type:"monotone",dataKey:"benchmark",stroke:"#ef4444",name:"Benchmark",strokeWidth:2,dot:{r:4}})]})})}function D({data:a}){return(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(t.BarChart,{data:a.sort((a,b)=>Math.abs(b.contribution)-Math.abs(a.contribution)),layout:"horizontal",children:[(0,b.jsx)(y.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(u.XAxis,{type:"number",tick:{fontSize:12},tickFormatter:a=>`${a}%`}),(0,b.jsx)(v.YAxis,{dataKey:"symbol",type:"category",width:80,tick:{fontSize:12}}),(0,b.jsx)(w.Tooltip,{formatter:(a,b)=>"contribution"===b?[`${a.toFixed(2)}%`,"Contribution"]:[`$${a.toLocaleString()}`,"Value"]}),(0,b.jsx)(s.Bar,{dataKey:"contribution",fill:"#3b82f6",name:"contribution",children:a.map((a,c)=>(0,b.jsx)(p.Cell,{fill:a.contribution>=0?"#22c55e":"#ef4444"},`cell-${c}`))})]})})}function E({data:a}){return(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(A.LineChart,{data:a,children:[(0,b.jsx)(y.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(u.XAxis,{dataKey:"date",tick:{fontSize:12},tickFormatter:a=>new Date(a).toLocaleDateString()}),(0,b.jsx)(v.YAxis,{tick:{fontSize:12}}),(0,b.jsx)(w.Tooltip,{labelFormatter:a=>new Date(a).toLocaleDateString(),formatter:(a,b)=>"volatility"===b?[a.toFixed(2),"Volatility"]:[a.toFixed(2),"Sharpe Ratio"]}),(0,b.jsx)(x.Legend,{}),(0,b.jsx)(B.Line,{type:"monotone",dataKey:"volatility",stroke:"#ef4444",name:"Volatility",strokeWidth:2,dot:{r:3}}),(0,b.jsx)(B.Line,{type:"monotone",dataKey:"sharpeRatio",stroke:"#22c55e",name:"Sharpe Ratio",strokeWidth:2,dot:{r:3},yAxisId:"right"})]})})}var F=a.i(1797),G=a.i(26575);function H({data:a,selectedPeriod:c,onPeriodChange:d}){return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>d("7d"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${"7d"===c?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"7-Day"}),(0,b.jsx)("button",{onClick:()=>d("30d"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${"30d"===c?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"30-Day"}),(0,b.jsx)("button",{onClick:()=>d("90d"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${"90d"===c?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"90-Day"})]}),(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(G.AreaChart,{data:a,children:[(0,b.jsx)("defs",{children:(0,b.jsxs)("linearGradient",{id:"colorReturn",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,b.jsx)("stop",{offset:"5%",stopColor:"#0ea5e9",stopOpacity:.8}),(0,b.jsx)("stop",{offset:"95%",stopColor:"#0ea5e9",stopOpacity:0})]})}),(0,b.jsx)(y.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(u.XAxis,{dataKey:"date",tick:{fontSize:12},tickFormatter:a=>new Date(a).toLocaleDateString()}),(0,b.jsx)(v.YAxis,{tick:{fontSize:12},tickFormatter:a=>`${a}%`}),(0,b.jsx)(w.Tooltip,{labelFormatter:a=>new Date(a).toLocaleDateString(),formatter:a=>[`${a.toFixed(2)}%`,"Return"]}),(0,b.jsx)(F.Area,{type:"monotone",dataKey:c,stroke:"#0ea5e9",fillOpacity:1,fill:"url(#colorReturn)",name:"Rolling Return"})]})})]})}let I=["#0ea5e9","#22c55e","#f59e0b","#ef4444","#8b5cf6","#ec4899","#14b8a6","#f97316"];function J({data:a}){return(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(o.PieChart,{children:[(0,b.jsx)(n.Pie,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percentage:b})=>`${a}: ${b.toFixed(1)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:a.map((a,c)=>(0,b.jsx)(p.Cell,{fill:I[c%I.length]},`cell-${c}`))}),(0,b.jsx)(w.Tooltip,{formatter:a=>`$${a.toLocaleString()}`}),(0,b.jsx)(x.Legend,{})]})})}var K=a.i(48121),L=a.i(81623),M=a.i(62485),N=a.i(76321);function O({value:a,percent:c=!0,className:e}){let f=a>0,g=0===a,h=c?`${a>=0?"+":""}${a.toFixed(2)}%`:`$${a.toLocaleString()}`;return(0,b.jsxs)(d.Card,{className:(0,N.cn)("border-l-4",e),children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Return"})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[f&&(0,b.jsx)(K.TrendingUp,{className:"h-5 w-5 text-green-500"}),g&&(0,b.jsx)(M.Minus,{className:"h-5 w-5 text-gray-500"}),!f&&!g&&(0,b.jsx)(L.TrendingDown,{className:"h-5 w-5 text-red-500"}),(0,b.jsx)("span",{className:(0,N.cn)("text-3xl font-bold",f&&"text-green-600",g&&"text-gray-600",!f&&!g&&"text-red-600"),children:h})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a>=0?"Profit":0===a?"Break even":"Loss"})]})]})}var P=a.i(23409);function Q({value:a,change:c,className:e}){let f=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a),g=void 0!==c?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(Math.abs(c)):null;return(0,b.jsxs)(d.Card,{className:e,children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(P.DollarSign,{className:"h-4 w-4"}),"Portfolio Value"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:f}),void 0!==c&&(0,b.jsxs)("p",{className:(0,N.cn)("text-xs mt-1",c>0?"text-green-600":c<0?"text-red-600":"text-muted-foreground"),children:[c>=0?"+":"",g," from last period"]})]})]})}var R=a.i(6991);function S({volatility:a,beta:c,sharpeRatio:e,className:f}){let g=a<10?{level:"Low",color:"text-green-600",bg:"bg-green-100"}:a<20?{level:"Medium",color:"text-yellow-600",bg:"bg-yellow-100"}:{level:"High",color:"text-red-600",bg:"bg-red-100"};return(0,b.jsxs)(d.Card,{className:f,children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(R.Activity,{className:"h-4 w-4"}),"Risk Metrics"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Volatility"}),(0,b.jsxs)("p",{className:"text-xl font-bold",children:[a.toFixed(2),"%"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Beta"}),(0,b.jsx)("p",{className:"text-xl font-bold",children:c.toFixed(2)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sharpe"}),(0,b.jsx)("p",{className:(0,N.cn)("text-xl font-bold",e>=1?"text-green-600":e>=0?"text-yellow-600":"text-red-600"),children:e.toFixed(2)})]})]}),(0,b.jsx)("div",{className:"mt-3 pt-3 border-t",children:(0,b.jsxs)("span",{className:(0,N.cn)("text-xs px-2 py-1 rounded-full",g.bg,g.color),children:[g.level," Risk"]})})]})]})}var T=a.i(80380),U=a.i(1688);function V({maxDrawdown:a,maxDrawdownDate:c,recoveryTime:e,className:f}){return(0,b.jsxs)(d.Card,{className:(0,N.cn)("border-l-4 border-red-500",f),children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(T.ArrowDown,{className:"h-4 w-4 text-red-500"}),"Max Drawdown"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:[a>=0?"-":"",Math.abs(a).toFixed(2),"%"]}),c&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Largest drop on ",new Date(c).toLocaleDateString()]}),void 0!==e&&e>0&&(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[(0,b.jsx)(U.Clock,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:["Recovered in ",e," days"]})]})]})]})}function W({cagr:a,annualizedReturn:c,className:e}){let f=a||c||0,g=f>0;return(0,b.jsxs)(d.Card,{className:(0,N.cn)("border-l-4 border-green-500",e),children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4"}),"CAGR / Annual Return"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("p",{className:(0,N.cn)("text-3xl font-bold",g?"text-green-600":"text-red-600"),children:[f>=0?"+":"",f.toFixed(2),"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Compound Annual Growth Rate"})]})]})}var X=a.i(30764),Y=a.i(26199),Z=a.i(26971),$=a.i(53671),_=a.i(63073),aa=a.i(6047);function ab({selectedPortfolioId:a,onSelectPortfolio:d}){let[f,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{try{j(!0);let b=await $.portfoliosApi.list();if(h(b.portfolios),b.portfolios.length>0&&!a){let a=b.portfolios.find(a=>a.is_default)||b.portfolios[0];d(a.id)}}catch(a){l(a instanceof Error?a.message:"Failed to load portfolios")}finally{j(!1)}})()},[d,a]);let m=f.find(b=>b.id===a);return i?(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(g.Skeleton,{className:"h-10 w-48"})}):k?(0,b.jsxs)(e.Button,{variant:"outline",disabled:!0,children:[(0,b.jsx)(Y.Building2,{className:"mr-2 h-4 w-4"}),"Error loading portfolios"]}):(0,b.jsxs)(_.DropdownMenu,{children:[(0,b.jsx)(_.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"outline",className:"min-w-[200px] justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(Y.Building2,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:m?.name||"Select Portfolio"})]}),(0,b.jsx)(X.ChevronDown,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,b.jsxs)(_.DropdownMenuContent,{align:"start",className:"w-72",children:[(0,b.jsx)("div",{className:"px-2 py-1.5",children:(0,b.jsxs)("span",{className:"text-xs font-medium text-muted-foreground",children:[f.length," Portfolio",1!==f.length?"s":""]})}),(0,b.jsx)(_.DropdownMenuSeparator,{}),f.map(a=>{let c;return(0,b.jsxs)(_.DropdownMenuItem,{onClick:()=>d(a.id),className:"flex flex-col items-start gap-1 p-3",children:[(0,b.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.is_default?(0,b.jsx)(Z.Briefcase,{className:"h-4 w-4 text-primary"}):(0,b.jsx)(Y.Building2,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a.name}),a.is_default&&(0,b.jsx)(aa.Badge,{variant:"secondary",className:"text-xs",children:"Default"})]})}),(0,b.jsxs)("div",{className:"flex w-full items-center justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:(c=a.total_value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(c))}),(0,b.jsxs)("span",{className:a.total_pnl>=0?"text-green-600":"text-red-600",children:[a.total_pnl>=0?"+":"",a.total_pnl_percent.toFixed(2),"%"]})]})]},a.id)}),(0,b.jsx)(_.DropdownMenuSeparator,{}),(0,b.jsxs)(_.DropdownMenuItem,{onClick:()=>d(null),className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Aggregate View (All Portfolios)"})]})]})]})}let ac=(0,a.i(78360).default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);var ad=a.i(19468);function ae({portfolios:a,selectedId:c,onSelect:e,className:f}){let g=[...a].sort((a,b)=>b.return-a.return),h=g[0]?.id,i=g[g.length-1]?.id;return(0,b.jsxs)(d.Card,{className:f,children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(ac,{className:"h-5 w-5 text-yellow-500"}),"Portfolio Comparison"]}),(0,b.jsx)(d.CardDescription,{children:"Compare performance across your portfolios"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[a.map(d=>{let f,j=(f=d.id,g.findIndex(a=>a.id===f)+1),k=d.id===h,l=d.id===i;return(0,b.jsxs)("div",{onClick:()=>e(d.id),className:(0,N.cn)("p-4 border rounded-lg cursor-pointer transition-all",c===d.id?"border-primary bg-primary/5":"hover:border-muted-foreground/50",k&&"bg-green-50 border-green-200 dark:bg-green-900/20",l&&"bg-red-50 border-red-200 dark:bg-red-900/20"),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:["#",j]}),k&&(0,b.jsx)(ac,{className:"h-4 w-4 text-yellow-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:d.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Vol: ",d.volatility.toFixed(1),"%"]}),(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{children:["Sharpe: ",d.sharpeRatio.toFixed(2)]})]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("div",{className:(0,N.cn)("flex items-center gap-1 font-semibold",d.return>=0?"text-green-600":"text-red-600"),children:[d.return>=0?(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4"}):(0,b.jsx)(L.TrendingDown,{className:"h-4 w-4"}),d.return>=0?"+":"",d.return.toFixed(2),"%"]})})]}),(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-4 text-xs",children:[(0,b.jsxs)("span",{className:"text-muted-foreground",children:["Max Drawdown: ",(0,b.jsxs)("span",{className:"text-red-600",children:["-",Math.abs(d.maxDrawdown).toFixed(2),"%"]})]}),k&&(0,b.jsx)(aa.Badge,{variant:"secondary",className:"bg-green-100 text-green-700",children:"Best Performer"}),l&&a.length>1&&(0,b.jsx)(aa.Badge,{variant:"secondary",className:"bg-red-100 text-red-700",children:"Worst Performer"})]})]},d.id)}),0===a.length&&(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(ad.AlertCircle,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No portfolios to compare"}),(0,b.jsx)("p",{className:"text-sm",children:"Create multiple portfolios to see comparison"})]})]})})]})}var af=a.i(33678),ag=a.i(53405),ah=a.i(17683);function ai({holdings:a,className:c}){let e=[...a].sort((a,b)=>b.contribution-a.contribution),f=e.slice(0,5),g=e.slice(-5).reverse();return(0,b.jsxs)(d.Card,{className:c,children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Performance Breakdown"}),(0,b.jsx)(d.CardDescription,{children:"Contribution to portfolio return by holding"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-green-500"}),"Top Contributors"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[f.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-green-50 dark:bg-green-900/20",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-mono text-muted-foreground",children:c+1}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.symbol}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:a.name})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["+",a.contribution.toFixed(2),"%"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a.weight.toFixed(1),"% weight"]})]})]},a.symbol)),0===f.length&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No positive contributors"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,b.jsx)(L.TrendingDown,{className:"h-4 w-4 text-red-500"}),"Bottom Contributors"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[g.map((c,d)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-red-50 dark:bg-red-900/20",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-mono text-muted-foreground",children:a.length-d}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:c.symbol}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:c.name})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-red-600",children:[c.contribution.toFixed(2),"%"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[c.weight.toFixed(1),"% weight"]})]})]},c.symbol)),0===g.length&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No negative contributors"})]})]})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-3",children:"All Holdings"}),(0,b.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,b.jsxs)(af.Table,{children:[(0,b.jsx)(af.TableHeader,{children:(0,b.jsxs)(af.TableRow,{children:[(0,b.jsx)(af.TableHead,{children:"Symbol"}),(0,b.jsx)(af.TableHead,{children:"Name"}),(0,b.jsx)(af.TableHead,{className:"text-right",children:"Weight"}),(0,b.jsx)(af.TableHead,{className:"text-right",children:"Return"}),(0,b.jsx)(af.TableHead,{className:"text-right",children:"Contribution"}),(0,b.jsx)(af.TableHead,{className:"text-right",children:"Value"})]})}),(0,b.jsx)(af.TableBody,{children:a.map(a=>{var c;let d;return(0,b.jsxs)(af.TableRow,{children:[(0,b.jsx)(af.TableCell,{className:"font-medium",children:a.symbol}),(0,b.jsx)(af.TableCell,{className:"text-muted-foreground truncate max-w-[150px]",children:a.name}),(0,b.jsxs)(af.TableCell,{className:"text-right",children:[a.weight.toFixed(1),"%"]}),(0,b.jsx)(af.TableCell,{className:"text-right",children:(c=a.return)>0?(0,b.jsxs)(aa.Badge,{className:"bg-green-100 text-green-700 hover:bg-green-200",children:[(0,b.jsx)(ag.ArrowUpRight,{className:"h-3 w-3 mr-1"}),"+",c.toFixed(2),"%"]}):c<0?(0,b.jsxs)(aa.Badge,{variant:"destructive",className:"bg-red-100 text-red-700 hover:bg-red-200",children:[(0,b.jsx)(ah.ArrowDownRight,{className:"h-3 w-3 mr-1"}),c.toFixed(2),"%"]}):(0,b.jsxs)(aa.Badge,{variant:"secondary",children:[(0,b.jsx)(M.Minus,{className:"h-3 w-3 mr-1"}),c.toFixed(2),"%"]})}),(0,b.jsxs)(af.TableCell,{className:(0,N.cn)("text-right font-medium",a.contribution>0?"text-green-600":a.contribution<0?"text-red-600":""),children:[a.contribution>=0?"+":"",a.contribution.toFixed(2),"%"]}),(0,b.jsx)(af.TableCell,{className:"text-right",children:(d=a.value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(d))})]},a.symbol)})})]})})]})]})]})}var aj=a.i(47627),ak=a.i(29134),al=a.i(51145),am=a.i(60663),an=a.i(12685),ao=a.i(62951),ap=a.i(2110),aq=a.i(62121);let ar=[{value:"1d",label:"1D"},{value:"1w",label:"1W"},{value:"1m",label:"1M"},{value:"3m",label:"3M"},{value:"6m",label:"6M"},{value:"1y",label:"1Y"},{value:"2y",label:"2Y"},{value:"3y",label:"3Y"},{value:"5y",label:"5Y"},{value:"ytd",label:"YTD"},{value:"all",label:"All"}],as=[{type:"sp500",name:"S&P 500",description:"500 largest US companies",category:"us_indices",annualized_return:.1,volatility:.15},{type:"nasdaq100",name:"NASDAQ-100",description:"100 largest non-financial stocks",category:"us_indices",annualized_return:.14,volatility:.2},{type:"dow30",name:"Dow Jones 30",description:"30 blue-chip companies",category:"us_indices",annualized_return:.09,volatility:.13},{type:"russell2000",name:"Russell 2000",description:"2000 small-cap companies",category:"us_indices",annualized_return:.08,volatility:.22},{type:"vti",name:"VTI",description:"Vanguard Total Stock Market",category:"etf",annualized_return:.1,volatility:.16},{type:"qqq",name:"QQQ",description:"Invesco NASDAQ 100",category:"etf",annualized_return:.14,volatility:.21},{type:"spy",name:"SPY",description:"SPDR S&P 500 ETF",category:"etf",annualized_return:.1,volatility:.15},{type:"dia",name:"DIA",description:"SPDR Dow Jones ETF",category:"etf",annualized_return:.09,volatility:.13},{type:"iwm",name:"IWM",description:"iShares Russell 2000",category:"etf",annualized_return:.08,volatility:.22},{type:"vgt",name:"VGT",description:"Vanguard Information Tech",category:"etf",annualized_return:.16,volatility:.24},{type:"vht",name:"VHT",description:"Vanguard Health Care",category:"etf",annualized_return:.11,volatility:.15},{type:"vcr",name:"VCR",description:"Vanguard Consumer Disc.",category:"etf",annualized_return:.1,volatility:.18},{type:"vdc",name:"VDC",description:"Vanguard Consumer Staples",category:"etf",annualized_return:.08,volatility:.12},{type:"ven",name:"VEN",description:"Vanguard Energy",category:"etf",annualized_return:.07,volatility:.28},{type:"vfi",name:"VFI",description:"Vanguard Financials",category:"etf",annualized_return:.09,volatility:.2},{type:"viu",name:"VIU",description:"Vanguard Developed ex-US",category:"international",annualized_return:.06,volatility:.18},{type:"acwx",name:"ACWX",description:"iShares MSCI AC World ex-US",category:"international",annualized_return:.05,volatility:.17},{type:"bnd",name:"BND",description:"Vanguard Total Bond Market",category:"bonds",annualized_return:.04,volatility:.06},{type:"agg",name:"AGG",description:"iShares Core US Aggregate",category:"bonds",annualized_return:.03,volatility:.05},{type:"tlt",name:"TLT",description:"iShares 20+ Year Treasury",category:"bonds",annualized_return:.02,volatility:.2},{type:"gld",name:"GLD",description:"SPDR Gold Shares",category:"custom",annualized_return:.06,volatility:.16},{type:"bitcoin",name:"Bitcoin",description:"BTC/USD",category:"crypto",annualized_return:.45,volatility:.7},{type:"ethereum",name:"Ethereum",description:"ETH/USD",category:"crypto",annualized_return:.35,volatility:.65}],at=[{value:"us_indices",label:"US Indices"},{value:"etf",label:"ETFs"},{value:"crypto",label:"Cryptocurrency"},{value:"bonds",label:"Bonds"},{value:"international",label:"International"}];function au(a,b=0){if(0===a.length)return[];let c={ids:a.map(a=>a.id),symbols:a.map(a=>a.symbol),names:a.map(a=>a.name),sectors:a.map(a=>a.sector||"Other"),assetClasses:a.map(a=>a.asset_class),currentValues:Float64Array.from(a.map(a=>a.current_value)),avgCosts:Float64Array.from(a.map(a=>a.average_cost)),currentPrices:Float64Array.from(a.map(a=>a.current_price)),unrealizedPnls:Float64Array.from(a.map(a=>a.unrealized_pnl))},d=function(a){let b=0,c=a.currentValues;for(let a=0;a<c.length;a++)b+=c[a];return b}(c),e=function(a,b){let c=new Float64Array(a.currentValues.length);if(b>0)for(let d=0;d<c.length;d++)c[d]=a.currentValues[d]/b*100;return c}(c,d),f=function(a){let b=new Float64Array(a.currentValues.length);for(let c=0;c<b.length;c++)a.avgCosts[c]>0&&(b[c]=(a.currentPrices[c]-a.avgCosts[c])/a.avgCosts[c]*100);return b}(c),g=function(a,b){let c=new Float64Array(a.length);for(let d=0;d<c.length;d++)c[d]=a[d]/100*b[d];return c}(e,f),h=Array(a.length);for(let d=0;d<a.length;d++){let a=0!==b?g[d]/b*100:0;h[d]={holding_id:c.ids[d],symbol:c.symbols[d],name:c.names[d],sector:c.sectors[d],asset_class:c.assetClasses[d],weight:e[d],return:f[d],contribution:g[d],contribution_percent:isNaN(a)?0:a,value_start:c.currentValues[d]/(1+f[d]/100),value_end:c.currentValues[d],value_change:c.unrealizedPnls[d],avg_weight:e[d]}}return h.sort((a,b)=>b.contribution-a.contribution),h}function av(a,b=0){let c=au(a,b),d=a.reduce((a,b)=>a+b.current_value,0),e=new Map,f=new Map,g=new Map,h=new Map,i=new Map;for(let a of c){let b=a.sector;e.has(b)||(e.set(b,[]),f.set(b,0),g.set(b,0),h.set(b,0),i.set(b,{symbol:"",contribution:-1/0,return:0})),e.get(b).push(a.contribution),f.set(b,f.get(b)+a.weight),g.set(b,g.get(b)+a.contribution),h.set(b,h.get(b)+1);let c=i.get(b);a.contribution>c.contribution&&i.set(b,{symbol:a.symbol,contribution:a.contribution,return:a.return})}let j=[];return e.forEach((a,c)=>{let e=f.get(c),k=g.get(c),l=h.get(c),m=i.get(c),n=e>0?k/(e/100):0,o=(e-10)*n*.1,p=k-o;j.push({sector:c,weight:e,return:n,contribution:k,contribution_percent:d>0?k/b*100:0,holdings_count:l,top_holding:m.symbol,top_holding_return:m.return,allocation_effect:o,selection_effect:p,total_effect:k})}),j.sort((a,b)=>b.contribution-a.contribution)}var aw=a.i(56215);let ax={Technology:"#3B82F6",Healthcare:"#10B981",Financial:"#F59E0B",Consumer:"#EC4899",Energy:"#EF4444",Industrial:"#8B5CF6",Materials:"#06B6D4","Real Estate":"#14B8A6",Utilities:"#F97316",Communication:"#6366F1",Other:"#6B7280"};function ay({data:a,type:c="bar",loading:d=!1,showBenchmark:e=!1,benchmarkReturn:f}){if(d)return(0,b.jsx)("div",{className:"h-[400px] w-full bg-muted animate-pulse rounded-lg"});if(0===a.length)return(0,b.jsx)("div",{className:"h-[400px] w-full flex items-center justify-center bg-muted/50 rounded-lg",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No attribution data available"})});let g=a=>`${a>=0?"+":""}${a.toFixed(2)}%`,h=({active:a,payload:c})=>{if(a&&c&&c.length){let a=c[0].payload,d=void 0!==f?a.return-f:void 0;return(0,b.jsxs)("div",{className:"bg-background border rounded-lg shadow-lg p-3",children:[(0,b.jsx)("p",{className:"font-medium capitalize mb-2",children:a.sector||a.name}),(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Weight:"}),(0,b.jsxs)("span",{className:"font-medium",children:[a.weight.toFixed(1),"%"]})]}),void 0!==a.holdings_count&&(0,b.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Holdings:"}),(0,b.jsx)("span",{className:"font-medium",children:a.holdings_count})]}),void 0!==a.contribution&&(0,b.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Contribution:"}),(0,b.jsx)("span",{className:(0,N.cn)("font-medium",a.contribution>=0?"text-green-600":"text-red-600"),children:g(a.contribution)})]}),void 0!==d&&(0,b.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"vs Benchmark:"}),(0,b.jsx)("span",{className:(0,N.cn)("font-medium",d>=0?"text-green-600":"text-red-600"),children:g(d)})]}),(0,b.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Holdings:"}),(0,b.jsx)("span",{className:"font-medium",children:a.holdings_count})]})]})]})}return null};return"pie"===c?(0,b.jsx)("div",{className:"h-[400px] w-full",children:(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(o.PieChart,{children:[(0,b.jsx)(n.Pie,{data:a,cx:"50%",cy:"45%",outerRadius:140,fill:"#8884d8",dataKey:"contribution",nameKey:"sector",label:({sector:a,percent:b})=>`${a} (${(100*b).toFixed(0)}%)`,labelLine:!1,children:a.map((a,c)=>(0,b.jsx)(p.Cell,{fill:ax[a.sector]||ax.Other},`cell-${c}`))}),(0,b.jsx)(w.Tooltip,{content:h}),(0,b.jsx)(x.Legend,{content:a=>{let{payload:c}=a;return(0,b.jsx)("ul",{className:"flex flex-wrap justify-center gap-3 mt-4",children:c.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-1.5 text-sm",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color}}),(0,b.jsx)("span",{className:"capitalize",children:a.value})]},`legend-${c}`))})}})]})})}):(0,b.jsx)("div",{className:"h-[400px] w-full",children:(0,b.jsx)(q.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(t.BarChart,{data:a,layout:"vertical",margin:{top:20,right:30,left:100,bottom:5},children:[(0,b.jsx)(y.CartesianGrid,{strokeDasharray:"3 3",className:"stroke-muted"}),(0,b.jsx)(u.XAxis,{type:"number",tickFormatter:a=>`${a>=0?"+":""}${a.toFixed(1)}%`,tick:{fontSize:12,fill:"#6B7280"},axisLine:{stroke:"#E5E7EB"}}),(0,b.jsx)(v.YAxis,{type:"category",dataKey:"sector",tick:{fontSize:12,fill:"#6B7280"},axisLine:!1,tickLine:!1,width:90}),(0,b.jsx)(w.Tooltip,{content:(0,b.jsx)(h,{})}),(0,b.jsx)(x.Legend,{}),e&&void 0!==f&&(0,b.jsx)(aw.ReferenceLine,{x:f,stroke:"#F59E0B",strokeDasharray:"5 5",label:{value:`Benchmark: ${g(f)}`,position:"top",fill:"#F59E0B",fontSize:11}}),(0,b.jsx)(s.Bar,{dataKey:"allocation_effect",name:"Allocation Effect",stackId:"a",fill:"#3B82F6",radius:[0,0,0,0]}),(0,b.jsx)(s.Bar,{dataKey:"selection_effect",name:"Selection Effect",stackId:"a",fill:"#10B981",radius:[0,4,4,0]})]})})})}var az=a.i(72030),aA=a.i(33877),aB=a.i(74856),aC=a.i(57668);function aD({attribution:a,formatCurrency:d,formatPercent:f}){let[g,h]=(0,c.useState)([{id:"contribution",desc:!0}]),[i,j]=(0,c.useState)(new Set),k=(0,c.useMemo)(()=>[{id:"select",header:({table:a})=>(0,b.jsx)(aC.Checkbox,{checked:a.getIsAllPageRowsSelected(),onCheckedChange:b=>a.toggleAllPageRowsSelected(!!b),"aria-label":"Select all"}),cell:({row:a})=>(0,b.jsx)(aC.Checkbox,{checked:a.getIsSelected(),onCheckedChange:b=>a.toggleSelected(!!b),"aria-label":"Select row"}),enableSorting:!1,size:40},{accessorKey:"symbol",header:({column:a})=>(0,b.jsxs)(e.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Symbol",(0,b.jsx)(aB.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.getValue("symbol")}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:a.original.name})]}),size:120},{accessorKey:"sector",header:"Sector",cell:({row:a})=>{let c=a.getValue("sector");return(0,b.jsx)(aa.Badge,{variant:"outline",style:{borderColor:ax[c]||ax.Other,color:ax[c]||ax.Other},children:c})},size:120},{accessorKey:"weight",header:({column:a})=>(0,b.jsxs)(e.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Weight",(0,b.jsx)(aB.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>{let c=a.getValue("weight");return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:`${Math.min(4*c,100)}%`}})}),(0,b.jsxs)("span",{className:"text-sm",children:[c.toFixed(1),"%"]})]})},size:140},{accessorKey:"return",header:({column:a})=>(0,b.jsxs)(e.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Return",(0,b.jsx)(aB.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>{let c=a.getValue("return");return(0,b.jsx)("span",{className:(0,N.cn)("font-medium",c>=0?"text-green-600":"text-red-600"),children:f(c)})},size:100},{accessorKey:"contribution",header:({column:a})=>(0,b.jsxs)(e.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Contribution",(0,b.jsx)(aB.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>{let c=a.getValue("contribution");return(0,b.jsxs)("div",{className:"flex flex-col items-end",children:[(0,b.jsx)("span",{className:(0,N.cn)("font-semibold",c>=0?"text-green-600":"text-red-600"),children:f(c)}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:d(1e3*a.original.contribution)})]})},size:140},{accessorKey:"value_change",header:"Value Change",cell:({row:a})=>{let c=a.getValue("value_change");return(0,b.jsx)("span",{className:(0,N.cn)("font-medium",c>=0?"text-green-600":"text-red-600"),children:d(c)})},size:120}],[d,f]),l=(0,az.useReactTable)({data:a,columns:k,getCoreRowModel:(0,aA.getCoreRowModel)(),getSortedRowModel:(0,aA.getSortedRowModel)(),onSortingChange:h,state:{sorting:g},initialState:{pagination:{pageSize:10}}});return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.length," holdings • Click column headers to sort"]})}),(0,b.jsx)("div",{className:"border rounded-lg",children:(0,b.jsxs)(af.Table,{children:[(0,b.jsx)(af.TableHeader,{children:l.getHeaderGroups().map(a=>(0,b.jsx)(af.TableRow,{children:a.headers.map(a=>(0,b.jsx)(af.TableHead,{style:{width:a.getSize()},children:a.isPlaceholder?null:(0,az.flexRender)(a.column.columnDef.header,a.getContext())},a.id))},a.id))}),(0,b.jsx)(af.TableBody,{children:l.getRowModel().rows?.length?l.getRowModel().rows.map(a=>(0,b.jsx)(af.TableRow,{"data-state":a.getIsSelected()&&"selected",className:"cursor-pointer",onClick:()=>a.toggleSelected(),children:a.getVisibleCells().map(a=>(0,b.jsx)(af.TableCell,{children:(0,az.flexRender)(a.column.columnDef.cell,a.getContext())},a.id))},a.id)):(0,b.jsx)(af.TableRow,{children:(0,b.jsx)(af.TableCell,{colSpan:k.length,className:"h-24 text-center",children:"No attribution data available"})})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",l.getState().pagination.pageIndex*l.getState().pagination.pageSize+1," to"," ",Math.min((l.getState().pagination.pageIndex+1)*l.getState().pagination.pageSize,a.length)," ","of ",a.length," holdings"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:"Previous"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:"Next"})]})]})]})}function aE({summary:a,sectorAttribution:c,assetClassAttribution:e}){let f=a=>`${a>=0?"+":""}${a.toFixed(2)}%`,g=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)(d.Card,{className:"border-green-200 bg-green-50/50 dark:bg-green-900/20 dark:border-green-800",children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(ag.ArrowUpRight,{className:"h-4 w-4 text-green-600"}),"Top Contributors"]})}),(0,b.jsx)(d.CardContent,{children:a.top_contributor?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-lg",children:a.top_contributor.symbol}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.top_contributor.name})]}),(0,b.jsx)(aa.Badge,{className:"bg-green-100 text-green-700",children:f(a.top_contributor.contribution)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Weight"}),(0,b.jsxs)("p",{className:"font-medium",children:[a.top_contributor.weight.toFixed(1),"%"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Return"}),(0,b.jsx)("p",{className:"font-medium text-green-600",children:f(a.top_contributor.return)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Value"}),(0,b.jsx)("p",{className:"font-medium",children:g(a.top_contributor.value_end)})]})]})]}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(d.Card,{className:"border-red-200 bg-red-50/50 dark:bg-red-900/20 dark:border-red-800",children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(ah.ArrowDownRight,{className:"h-4 w-4 text-red-600"}),"Bottom Contributors"]})}),(0,b.jsx)(d.CardContent,{children:a.bottom_contributor?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-lg",children:a.bottom_contributor.symbol}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.bottom_contributor.name})]}),(0,b.jsx)(aa.Badge,{className:"bg-red-100 text-red-700",children:f(a.bottom_contributor.contribution)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Weight"}),(0,b.jsxs)("p",{className:"font-medium",children:[a.bottom_contributor.weight.toFixed(1),"%"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Return"}),(0,b.jsx)("p",{className:"font-medium text-red-600",children:f(a.bottom_contributor.return)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Value"}),(0,b.jsx)("p",{className:"font-medium",children:g(a.bottom_contributor.value_end)})]})]})]}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"No data available"})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(am.PieChart,{className:"h-5 w-5"}),"Sector Performance"]}),(0,b.jsx)(d.CardDescription,{children:"How each sector contributed to overall returns"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:c.slice(0,6).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ax[a.sector]||"#6B7280"}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.sector}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a.holdings_count," holding",1!==a.holdings_count?"s":""]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Weight"}),(0,b.jsxs)("p",{className:"font-medium",children:[a.weight.toFixed(1),"%"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Return"}),(0,b.jsx)("p",{className:(0,N.cn)("font-medium",a.return>=0?"text-green-600":"text-red-600"),children:f(a.return)})]}),(0,b.jsxs)("div",{className:"text-right w-20",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Contribution"}),(0,b.jsx)("p",{className:(0,N.cn)("font-semibold",a.contribution>=0?"text-green-600":"text-red-600"),children:f(a.contribution)})]})]})]},a.sector))})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(ao.Layers,{className:"h-5 w-5"}),"Asset Class Breakdown"]}),(0,b.jsx)(d.CardDescription,{children:"Performance by asset class"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(a=>(0,b.jsxs)("div",{className:"p-4 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("p",{className:"font-medium capitalize",children:a.asset_class.replace("_"," ")}),(0,b.jsxs)(aa.Badge,{variant:"secondary",children:[a.holdings_count," holding",1!==a.holdings_count?"s":""]})]}),(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Weight"}),(0,b.jsxs)("span",{className:"font-medium",children:[a.weight.toFixed(1),"%"]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Return"}),(0,b.jsx)("span",{className:(0,N.cn)("font-medium",a.return>=0?"text-green-600":"text-red-600"),children:f(a.return)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Contribution"}),(0,b.jsx)("span",{className:(0,N.cn)("font-semibold",a.contribution>=0?"text-green-600":"text-red-600"),children:f(a.contribution)})]})]})]},a.asset_class))})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(K.TrendingUp,{className:"h-5 w-5"}),"Attribution Effect Analysis"]}),(0,b.jsx)(d.CardDescription,{children:"Breakdown of allocation vs selection effects"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Allocation Effect"}),(0,b.jsx)("p",{className:(0,N.cn)("text-2xl font-bold",a.allocation_effect>=0?"text-blue-600":"text-red-600"),children:f(a.allocation_effect)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Impact of weight differences vs benchmark"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Selection Effect"}),(0,b.jsx)("p",{className:(0,N.cn)("text-2xl font-bold",a.selection_effect>=0?"text-green-600":"text-red-600"),children:f(a.selection_effect)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Impact of security selection within sectors"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Effect"}),(0,b.jsx)("p",{className:(0,N.cn)("text-2xl font-bold",a.total_effect>=0?"text-purple-600":"text-red-600"),children:f(a.total_effect)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Combined allocation + selection effects"})]})]})})]})]})}function aF({holdings:a,loading:h=!1,onPeriodChange:i,initialBenchmark:j="sp500"}){let[k,l]=(0,c.useState)("1m"),[m,n]=(0,c.useState)("summary"),[o,p]=(0,c.useState)(j),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(["us_indices","etf"]),u=(0,c.useMemo)(()=>as.filter(a=>s.includes(a.category)),[s]),v=(0,c.useMemo)(()=>{let b=function(a,b=0){let c=au(a,b),d=av(a,b),e=c.reduce((a,b)=>a+b.contribution,0),f=d.reduce((a,b)=>a+b.allocation_effect,0),g=d.reduce((a,b)=>a+b.selection_effect,0),h=c.filter(a=>a.contribution>0).length,i=c.filter(a=>a.contribution<0).length,j=c.filter(a=>0===a.contribution).length;return{total_return:b,total_contribution:e,allocation_effect:f,selection_effect:g,total_effect:e,top_contributor:c[0]||null,bottom_contributor:c[c.length-1]||null,best_sector:d[0]||null,worst_sector:d[d.length-1]||null,positive_holdings:h,negative_holdings:i,neutral_holdings:j}}(a),c=as.find(a=>a.type===o);if(c){let d,e,f,g,h,i,j,l,m,n;return d=(c.annualized_return||.1)*(({"1d":365,"1w":52,"1m":12,"3m":4,"6m":2,"1y":1,"2y":.5,"3y":.333,"5y":.2,ytd:1.5,all:.5})[k]||1),e=b.total_return-d,f=0!==d?e/Math.abs(d)*100:0,g=.8*Math.abs(e),h=(c.volatility||.15)>0?1+(.2*Math.random()-.1):1,i=.85+.1*Math.random(),l=(j=av(a,b.total_return)).filter(a=>a.return>d),m=j.filter(a=>a.return<d),n={benchmark_type:c.type,benchmark_return:d,portfolio_return:b.total_return,excess_return:e,excess_return_percent:f,tracking_error:g,information_ratio:0!==g?e/g:0,beta:h,correlation:i,sector_outperformance:l.slice(0,3),sector_underperformance:m.slice(0,3)},{...b,benchmark_comparison:n}}return b},[a,o,k]),w=(0,c.useMemo)(()=>au(a),[a]),x=(0,c.useMemo)(()=>av(a),[a]),y=(0,c.useMemo)(()=>(function(a,b=0){let c=au(a,b),d=a.reduce((a,b)=>a+b.current_value,0),e=new Map;for(let a of c){let b=a.asset_class;e.has(b)||e.set(b,{weight:0,contribution:0,holdings:0,sectors:new Set});let c=e.get(b);c.weight+=a.weight,c.contribution+=a.contribution,c.holdings++,c.sectors.add(a.sector)}let f=[];return e.forEach((a,c)=>{let e=a.weight>0?a.contribution/(a.weight/100):0;f.push({asset_class:c,weight:a.weight,return:e,contribution:a.contribution,contribution_percent:d>0?a.contribution/b*100:0,holdings_count:a.holdings,sectors_count:a.sectors.size})}),f.sort((a,b)=>b.contribution-a.contribution)})(a),[a]),z=a=>`${a>=0?"+":""}${a.toFixed(2)}%`,A=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),B=as.find(a=>a.type===o),C=v.benchmark_comparison?.excess_return??0;return h?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(g.Skeleton,{className:"h-8 w-64"}),(0,b.jsx)(g.Skeleton,{className:"h-10 w-64"})]}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(a=>(0,b.jsx)(g.Skeleton,{className:"h-32"},a))}),(0,b.jsx)(g.Skeleton,{className:"h-96"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Performance Attribution"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Analyze how each holding, sector, and asset class contributed to your returns"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(ak.Popover,{open:q,onOpenChange:r,children:[(0,b.jsx)(ak.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"outline",className:"min-w-[180px]",children:[(0,b.jsx)(ap.Target,{className:"w-4 h-4 mr-2"}),(0,b.jsx)("span",{className:"truncate",children:B?.name||"Select Benchmark"})]})}),(0,b.jsx)(ak.PopoverContent,{className:"w-80",align:"end",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"Benchmark Settings"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Compare your portfolio performance against market indices, ETFs, or custom benchmarks."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(al.Label,{className:"text-xs",children:"Categories"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:at.map(a=>(0,b.jsx)(aa.Badge,{variant:s.includes(a.value)?"default":"outline",className:"cursor-pointer",onClick:()=>{s.includes(a.value)?t(b=>b.filter(b=>b!==a.value)):t(b=>[...b,a.value])},children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[(0,b.jsx)(al.Label,{className:"text-xs",children:"Select Benchmark"}),u.map(a=>(0,b.jsxs)("div",{className:(0,N.cn)("flex items-center gap-2 p-2 rounded cursor-pointer transition-colors",o===a.type?"bg-primary/10":"hover:bg-muted"),onClick:()=>{p(a.type),r(!1)},children:[(0,b.jsx)("div",{className:(0,N.cn)("w-3 h-3 rounded-full",o===a.type?"bg-primary":"border border-muted-foreground")}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.description})]})]},a.type))]})]})})]}),(0,b.jsxs)(aj.Select,{value:k,onValueChange:a=>{l(a),i?.(a)},children:[(0,b.jsx)(aj.SelectTrigger,{className:"w-[120px]",children:(0,b.jsx)(aj.SelectValue,{placeholder:"Period"})}),(0,b.jsx)(aj.SelectContent,{children:ar.map(a=>(0,b.jsx)(aj.SelectItem,{value:a.value,children:a.label},a.value))})]})]})]}),v.benchmark_comparison&&(0,b.jsx)(d.Card,{className:"bg-muted/50",children:(0,b.jsx)(d.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(ap.Target,{className:"w-5 h-5 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"vs"}),(0,b.jsx)("span",{className:"font-semibold",children:B?.name})]}),(0,b.jsx)("div",{className:"h-8 w-px bg-border"}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Portfolio: "}),(0,b.jsx)("span",{className:(0,N.cn)("font-semibold",v.total_return>=0?"text-green-600":"text-red-600"),children:z(v.total_return)})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{className:"text-muted-foreground",children:[B?.name,": "]}),(0,b.jsx)("span",{className:(0,N.cn)("font-semibold",v.benchmark_comparison.benchmark_return>=0?"text-green-600":"text-red-600"),children:z(v.benchmark_comparison.benchmark_return)})]}),(0,b.jsx)("div",{className:"h-4 w-px bg-border"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Excess Return: "}),(0,b.jsx)("span",{className:(0,N.cn)("font-semibold",C>=0?"text-green-600":"text-red-600"),children:z(C)})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[void 0!==v.benchmark_comparison.information_ratio&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(R.Activity,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:["IR: ",v.benchmark_comparison.information_ratio.toFixed(2)]})]}),void 0!==v.benchmark_comparison.beta&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(aq.Zap,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:["β: ",v.benchmark_comparison.beta.toFixed(2)]})]})]})]})})}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Return"}),v.total_return>=0?(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-green-600"}):(0,b.jsx)(L.TrendingDown,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:(0,N.cn)("text-2xl font-bold",v.total_return>=0?"text-green-600":"text-red-600"),children:z(v.total_return)}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[A(v.total_contribution)," contribution"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Top Contributor"}),(0,b.jsx)(ag.ArrowUpRight,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.top_contributor?.symbol||"-"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:v.top_contributor?`${z(v.top_contributor.contribution)} contribution`:"No data"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Worst Performer"}),(0,b.jsx)(ah.ArrowDownRight,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.bottom_contributor?.symbol||"-"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:v.bottom_contributor?`${z(v.bottom_contributor.contribution)} contribution`:"No data"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Allocation vs Selection"}),(0,b.jsx)(am.PieChart,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{children:"Allocation"}),(0,b.jsx)("span",{className:(0,N.cn)("font-medium",v.allocation_effect>=0?"text-green-600":"text-red-600"),children:z(v.allocation_effect)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{children:"Selection"}),(0,b.jsx)("span",{className:(0,N.cn)("font-medium",v.selection_effect>=0?"text-green-600":"text-red-600"),children:z(v.selection_effect)})]})]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Attribution Breakdown"}),(0,b.jsxs)(d.CardDescription,{children:[v.positive_holdings," holdings positive, ",v.negative_holdings," negative"]})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)(f.Tabs,{value:m,onValueChange:n,children:[(0,b.jsxs)(f.TabsList,{className:"mb-4",children:[(0,b.jsxs)(f.TabsTrigger,{value:"summary",children:[(0,b.jsx)(ao.Layers,{className:"w-4 h-4 mr-2"}),"Summary"]}),(0,b.jsxs)(f.TabsTrigger,{value:"holdings",children:[(0,b.jsx)(an.BarChart3,{className:"w-4 h-4 mr-2"}),"By Holding"]}),(0,b.jsxs)(f.TabsTrigger,{value:"sectors",children:[(0,b.jsx)(am.PieChart,{className:"w-4 h-4 mr-2"}),"By Sector"]}),(0,b.jsxs)(f.TabsTrigger,{value:"assets",children:[(0,b.jsx)(ao.Layers,{className:"w-4 h-4 mr-2"}),"By Asset Class"]})]}),(0,b.jsx)(f.TabsContent,{value:"summary",children:(0,b.jsx)(aE,{summary:v,sectorAttribution:x,assetClassAttribution:y})}),(0,b.jsx)(f.TabsContent,{value:"holdings",children:(0,b.jsx)(aD,{attribution:w,formatCurrency:A,formatPercent:z})}),(0,b.jsx)(f.TabsContent,{value:"sectors",children:(0,b.jsx)(ay,{data:x,type:"bar",showBenchmark:!!v.benchmark_comparison,benchmarkReturn:v.benchmark_comparison?.benchmark_return})}),(0,b.jsx)(f.TabsContent,{value:"assets",children:(0,b.jsx)(ay,{data:x,type:"pie"})})]})})]})]})}var aG=a.i(69779),aH=a.i(69382),aI=a.i(66149);let aJ={"1d":"3m","7d":"3m","30d":"3m","90d":"6m","180d":"6m","1y":"1y","3y":"1y","5y":"1y",ytd:"1y",all:"1y"},aK=(0,aG.create)()((0,aH.persist)((a,b)=>({selectedPortfolioId:null,selectedPeriod:"1y",selectedBenchmark:"sp500",data:null,loading:!1,error:null,lastUpdated:null,setSelectedPortfolio:c=>{a({selectedPortfolioId:c}),c&&b().fetchAnalytics()},setSelectedPeriod:c=>{a({selectedPeriod:c}),b().fetchAnalytics()},setSelectedBenchmark:c=>{a({selectedBenchmark:c}),b().fetchAnalytics()},fetchAnalytics:async()=>{let{selectedPortfolioId:c,selectedPeriod:d,selectedBenchmark:e}=b();if(!c)return void a({error:"No portfolio selected",loading:!1});a({loading:!0,error:null});try{let b=aJ[d],[e,f,g,h]=await Promise.all([aI.portfolioAnalyticsApi.getPortfolioSummary(c),aI.portfolioAnalyticsApi.getPerformanceMetrics(c,b),aI.portfolioAnalyticsApi.getRiskAnalysis(c),aI.portfolioAnalyticsApi.getHoldingsAnalysis(c)]),i={total_return:f.total_return||0,total_value:e.total_value,total_value_change:e.total_pnl,total_value_change_percent:e.total_pnl_percent,summary:{...e},performance:{portfolio_id:c,time_period:d,cagr:f.annualized_return||0,total_return:f.total_return,total_return_percent:f.total_return_percent,annualized_return:f.annualized_return,volatility:f.volatility,sharpe_ratio:f.sharpe_ratio,sortino_ratio:null,max_drawdown:f.max_drawdown||null,max_drawdown_percent:f.max_drawdown_percent||null,max_drawdown_date:null,recovery_time:null,best_day:f.best_day,worst_day:f.worst_day,win_rate:f.win_rate,alpha_vs_sp500:f.alpha_vs_sp500,beta_vs_sp500:f.beta_vs_sp500,var_95:null,var_99:null,avg_win:null,avg_loss:null,profit_factor:null},performance_by_asset:[],risk_metrics:{volatility:g.volatility_exposure||0,beta:g.volatility_exposure||0,sharpe_ratio:f.sharpe_ratio||0},period_start:new Date(Date.now()-31536e6).toISOString(),period_end:new Date().toISOString(),total_transactions:0};a({data:i,loading:!1,lastUpdated:new Date().toISOString()})}catch(b){a({error:b instanceof Error?b.message:"Failed to fetch analytics",loading:!1})}},clearAnalytics:()=>{a({data:null,error:null,lastUpdated:null})}}),{name:"analytics-storage",partialize:a=>({selectedPortfolioId:a.selectedPortfolioId,selectedPeriod:a.selectedPeriod,selectedBenchmark:a.selectedBenchmark})}));function aL(a,b){let c,d,e,f=function(a,b){let{format:c}=b,d=a.summary||{name:"Unknown Portfolio",total_value:a.total_value,total_invested:0,total_pnl:0,total_pnl_percent:0},e=a.performance||{cagr:0,total_return:0,total_return_percent:0,annualized_return:0,best_day:0,worst_day:0,win_rate:0},f=a.risk_metrics||{volatility:0,beta:1,sharpe_ratio:0},g={summary:{portfolio:d.name,totalValue:d.total_value,totalReturn:e.total_return_percent,periodStart:a.period_start,periodEnd:a.period_end},performance:{cagr:e.cagr,totalReturn:e.total_return_percent,annualizedReturn:e.annualized_return,bestDay:e.best_day,worstDay:e.worst_day,winRate:e.win_rate},risk:{volatility:f.volatility,beta:f.beta,sharpeRatio:f.sharpe_ratio},allocation:a.performance_by_asset,exportedAt:new Date().toISOString(),period:b.period||"1y"};if("json"===c)return JSON.stringify(g,null,2);if("csv"===c){let b=[];return b.push("Summary"),b.push("Portfolio,Total Value,Total Return,Period Start,Period End"),b.push(`${g.summary.portfolio},${g.summary.totalValue},${g.summary.totalReturn}%,${g.summary.periodStart},${g.summary.periodEnd}`),b.push(""),b.push("Performance"),b.push("CAGR,Total Return,Annualized Return,Win Rate"),b.push(`${g.performance.cagr}%,${g.performance.totalReturn}%,${g.performance.annualizedReturn}%,${g.performance.winRate}%`),b.push(""),b.push("Risk Metrics"),b.push("Volatility,Beta,Sharpe Ratio"),b.push(`${g.risk.volatility}%,${g.risk.beta},${g.risk.sharpeRatio}`),b.push(""),b.push("Allocation"),b.push("Asset Type,Value,Return"),a.performance_by_asset.forEach(a=>{b.push(`${a.asset_type},${a.value},${a.return}%`)}),b.join("\n")}return null}(a,b);if(!f)return;let g=new Date().toISOString().split("T")[0],h=`portfolio-analytics-${b.period||"1y"}-${g}.${b.format}`;c=new Blob([f],{type:"json"===b.format?"application/json":"text/csv"}),d=URL.createObjectURL(c),(e=document.createElement("a")).href=d,e.download=h,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(d)}let aM=[{value:"1d",label:"1D"},{value:"7d",label:"7D"},{value:"30d",label:"30D"},{value:"90d",label:"90D"},{value:"180d",label:"6M"},{value:"1y",label:"1Y"},{value:"3y",label:"3Y"},{value:"5y",label:"5Y"},{value:"all",label:"All"}],aN=[{value:"sp500",label:"S&P 500"},{value:"nasdaq",label:"NASDAQ"},{value:"dow",label:"Dow Jones"}];function aO(){let{selectedPortfolioId:a,selectedPeriod:h,selectedBenchmark:n,data:o,loading:p,error:q,lastUpdated:s,setSelectedPortfolio:t,setSelectedPeriod:u,setSelectedBenchmark:v,fetchAnalytics:w}=aK(),[x,y]=(0,c.useState)("overview"),[A,B]=(0,c.useState)("30d"),[F,G]=(0,c.useState)([]);(0,c.useEffect)(()=>{w(),(async()=>{try{let a=await $.portfoliosApi.list();G(a.portfolios)}catch(a){console.error("Failed to fetch portfolios:",a)}})()},[h,n,w]);let I=o?.performance_by_asset?.map(a=>({name:a.asset_type,value:a.value,percentage:(a.value/(o?.total_value||1)*100).toFixed(1)}))||[],K=o?.performance_by_asset?.map(a=>({symbol:a.asset_type,return:a.return,current_value:a.value}))||[],L=[{symbol:"AAPL",name:"Apple Inc.",weight:15.2,return:18.5,contribution:2.81,value:15200,sector:"Technology"},{symbol:"MSFT",name:"Microsoft Corp.",weight:14.8,return:22.3,contribution:3.3,value:14800,sector:"Technology"},{symbol:"GOOGL",name:"Alphabet Inc.",weight:12.5,return:15.2,contribution:1.9,value:12500,sector:"Technology"},{symbol:"AMZN",name:"Amazon.com Inc.",weight:10.3,return:28.7,contribution:2.96,value:10300,sector:"Consumer"},{symbol:"NVDA",name:"NVIDIA Corp.",weight:8.7,return:45.2,contribution:3.93,value:8700,sector:"Technology"},{symbol:"JPM",name:"JPMorgan Chase",weight:6.5,return:12.3,contribution:.8,value:6500,sector:"Finance"},{symbol:"V",name:"Visa Inc.",weight:5.8,return:8.5,contribution:.49,value:5800,sector:"Finance"},{symbol:"JNJ",name:"Johnson & Johnson",weight:5.2,return:-2.3,contribution:-.12,value:5200,sector:"Healthcare"},{symbol:"WMT",name:"Walmart Inc.",weight:4.8,return:15.8,contribution:.76,value:4800,sector:"Consumer"},{symbol:"XOM",name:"Exxon Mobil",weight:4.2,return:-8.5,contribution:-.36,value:4200,sector:"Energy"}];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Portfolio Analytics"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Detailed portfolio performance analysis"})]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(ab,{selectedPortfolioId:a,onSelectPortfolio:t}),(0,b.jsxs)(e.Button,{variant:"outline",onClick:w,disabled:p,children:[(0,b.jsx)(i.RefreshCw,{className:(0,N.cn)("w-4 h-4 mr-2",p&&"animate-spin")}),"Refresh"]}),(0,b.jsxs)(_.DropdownMenu,{children:[(0,b.jsx)(_.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"outline",disabled:!o||p,children:[(0,b.jsx)(j.Download,{className:"w-4 h-4 mr-2"}),"Export"]})}),(0,b.jsxs)(_.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(_.DropdownMenuItem,{onClick:()=>{o&&aL(o,{format:"json",period:h})},children:[(0,b.jsx)(k.FileJson,{className:"w-4 h-4 mr-2"}),"Export as JSON"]}),(0,b.jsxs)(_.DropdownMenuItem,{onClick:()=>{o&&aL(o,{format:"csv",period:h})},children:[(0,b.jsx)(l.FileSpreadsheet,{className:"w-4 h-4 mr-2"}),"Export as CSV"]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap items-center",children:[aM.map(a=>(0,b.jsx)(e.Button,{variant:h===a.value?"default":"outline",size:"sm",onClick:()=>u(a.value),disabled:p,children:a.label},a.value)),(0,b.jsx)("div",{className:"w-px h-6 bg-border mx-2"}),(0,b.jsx)("select",{value:n,onChange:a=>v(a.target.value),className:"px-3 py-1 border rounded-md text-sm",disabled:p,children:aN.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),q&&(0,b.jsxs)("div",{className:"bg-destructive/10 text-destructive p-4 rounded-lg",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Error"}),(0,b.jsx)("p",{children:q})]}),p?(0,b.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(a=>(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(g.Skeleton,{className:"h-6 w-32"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(g.Skeleton,{className:"h-12"})})]},a))}):o?(0,b.jsxs)(f.Tabs,{value:x,onValueChange:a=>y(a),className:"space-y-6",children:[(0,b.jsxs)(f.TabsList,{className:"grid w-full grid-cols-5",children:[(0,b.jsx)(f.TabsTrigger,{value:"overview",children:"Overview"}),(0,b.jsx)(f.TabsTrigger,{value:"performance",children:"Performance"}),(0,b.jsx)(f.TabsTrigger,{value:"risk",children:"Risk"}),(0,b.jsx)(f.TabsTrigger,{value:"attribution",children:"Attribution"}),(0,b.jsx)(f.TabsTrigger,{value:"comparison",children:"Comparison"})]}),(0,b.jsxs)(f.TabsContent,{value:"overview",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsx)(O,{value:o.performance?.total_return_percent||0}),(0,b.jsx)(Q,{value:o.summary?.total_value||0,change:o.summary?.total_pnl}),(0,b.jsx)(W,{cagr:o.performance?.cagr||0,annualizedReturn:o.performance?.annualized_return||0}),(0,b.jsx)(V,{maxDrawdown:o.performance?.max_drawdown_percent||0,maxDrawdownDate:o.performance?.max_drawdown_date||void 0,recoveryTime:o.performance?.recovery_time||void 0})]}),(0,b.jsx)(S,{volatility:o.risk_metrics.volatility,beta:o.risk_metrics.beta,sharpeRatio:o.risk_metrics.sharpe_ratio}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsx)(m,{title:"Asset Allocation",description:"Portfolio distribution by asset type",children:(0,b.jsx)(r,{data:I})}),(0,b.jsx)(m,{title:"Performance by Asset",description:"Return breakdown by asset",children:(0,b.jsx)(z,{data:K})})]})]}),(0,b.jsxs)(f.TabsContent,{value:"performance",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsx)(m,{title:"Rolling Returns",description:"7-day, 30-day, and 90-day rolling returns",children:(0,b.jsx)(H,{data:[{date:"2024-01-01","7d":2.5,"30d":8.2,"90d":15.5},{date:"2024-01-02","7d":2.8,"30d":8.5,"90d":15.8},{date:"2024-01-03","7d":3.1,"30d":8.8,"90d":16},{date:"2024-01-04","7d":2.9,"30d":8.6,"90d":15.7},{date:"2024-01-05","7d":3.2,"30d":9,"90d":16.2},{date:"2024-01-06","7d":3.5,"30d":9.2,"90d":16.5},{date:"2024-01-07","7d":3.3,"30d":9.1,"90d":16.3}],selectedPeriod:A,onPeriodChange:B})}),(0,b.jsx)(m,{title:"Performance Attribution",description:"Sector contribution to returns",children:(0,b.jsx)(D,{data:[{symbol:"Technology",contribution:2.5,value:45e3},{symbol:"Healthcare",contribution:1.2,value:28e3},{symbol:"Finance",contribution:.8,value:22e3},{symbol:"Consumer",contribution:.5,value:18e3},{symbol:"Energy",contribution:-.3,value:12e3}]})})]}),(0,b.jsx)(ai,{holdings:L}),(0,b.jsx)(m,{title:"Benchmark Comparison",description:"Portfolio vs benchmark performance",children:(0,b.jsx)(C,{data:[{date:"2024-01-01",portfolio:0,benchmark:0},{date:"2024-01-02",portfolio:1.2,benchmark:.8},{date:"2024-01-03",portfolio:2.5,benchmark:1.5},{date:"2024-01-04",portfolio:1.8,benchmark:1.2},{date:"2024-01-05",portfolio:3.2,benchmark:2.1},{date:"2024-01-06",portfolio:4.1,benchmark:2.8},{date:"2024-01-07",portfolio:3.8,benchmark:2.5}]})})]}),(0,b.jsxs)(f.TabsContent,{value:"risk",className:"space-y-6",children:[(0,b.jsx)(S,{volatility:o.risk_metrics.volatility,beta:o.risk_metrics.beta,sharpeRatio:o.risk_metrics.sharpe_ratio}),(0,b.jsx)(m,{title:"Risk Metrics History",description:"Volatility and Sharpe ratio over time",children:(0,b.jsx)(E,{data:[{date:"2024-01-01",volatility:15,sharpeRatio:1.2},{date:"2024-01-02",volatility:16,sharpeRatio:1.1},{date:"2024-01-03",volatility:14,sharpeRatio:1.3},{date:"2024-01-04",volatility:15,sharpeRatio:1.2},{date:"2024-01-05",volatility:17,sharpeRatio:1},{date:"2024-01-06",volatility:16,sharpeRatio:1.1},{date:"2024-01-07",volatility:15,sharpeRatio:1.2}]})})]}),(0,b.jsx)(f.TabsContent,{value:"attribution",className:"space-y-6",children:(0,b.jsx)(aF,{holdings:L.map(b=>({id:b.symbol,portfolio_id:a||"",symbol:b.symbol,name:b.name,asset_class:"stocks",quantity:100,average_cost:b.value/(1+b.return/100),current_price:b.value/100,current_value:b.value,unrealized_pnl:b.value*b.return/100,unrealized_pnl_percent:b.return,day_change:0,day_change_percent:0,weight:b.weight,sector:b.sector,exchange:"",currency:"USD",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),loading:p,initialBenchmark:"sp500"})}),(0,b.jsxs)(f.TabsContent,{value:"comparison",className:"space-y-6",children:[(0,b.jsx)(ae,{portfolios:F.map(a=>({id:a.id,name:a.name,return:a.total_pnl_percent,volatility:15,sharpeRatio:1.2,maxDrawdown:5})),selectedId:a||"",onSelect:t}),(0,b.jsx)(m,{title:"Sector Breakdown",description:"Performance by economic sector",children:(0,b.jsx)(J,{data:[{name:"Technology",value:45e3,percentage:35.5,return:12.5},{name:"Healthcare",value:28e3,percentage:22.1,return:8.2},{name:"Finance",value:22e3,percentage:17.3,return:6.5},{name:"Consumer",value:18e3,percentage:14.2,return:4.8},{name:"Energy",value:12e3,percentage:10.9,return:-2.3}]})})]})]}):(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:(0,b.jsx)("p",{children:"No analytics data available. Select a portfolio to view analytics."})})]})}function aP(){return(0,b.jsx)(h.PageErrorBoundary,{onError:(a,b)=>{console.error("Analytics page error:",a,b)},children:(0,b.jsx)(aO,{})})}a.s(["default",()=>aP],30561)}];

//# sourceMappingURL=apps_frontend_src_app_%28dashboard%29_analytics_page_tsx_2fe7dd57._.js.map