(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76965,e=>{"use strict";var t=e.i(29845),r=e.i(59199),s=e.i(74741),a=e.i(61088),n=e.i(60983),l=e.i(95421),i=e.i(99864),o=e.i(8562),c=e.i(51174),d=e.i(60204),m=e.i(64717);function x({title:e,children:r,description:a}){return(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:e}),a&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:a})]}),(0,t.jsx)(s.CardContent,{children:r})]})}var u=e.i(41255),h=e.i(22717),p=e.i(89428),g=e.i(5501);function j({data:e}){let r=["#3B82F6","#0088FE","#00C49F","#FFBB28","#FF8042","#8B5CF6","#1aff1a"];return(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsx)(h.PieChart,{children:(0,t.jsx)(u.Pie,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:e=>`${e.name}: ${e.percentage}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:e.map((e,s)=>(0,t.jsx)(p.Cell,{fill:r[s%r.length]},`cell-${s}`))})})})}var f=e.i(92393),b=e.i(50276),y=e.i(34346),v=e.i(33003),N=e.i(89728),w=e.i(88782),_=e.i(4455);function C({data:e}){return(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:350,children:(0,t.jsxs)(b.BarChart,{data:e,layout:"vertical",children:[(0,t.jsx)(_.CartesianGrid,{strokeDasharray:"3 3",vertical:!1}),(0,t.jsx)(y.XAxis,{dataKey:"symbol",tick:{fontSize:12}}),(0,t.jsx)(v.YAxis,{tick:{fontSize:12}}),(0,t.jsx)(N.Tooltip,{formatter:(e,r,s)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:r}),(0,t.jsxs)("p",{children:["Return: ","number"==typeof e?`${e.toFixed(2)}%`:e]})]})}),(0,t.jsx)(w.Legend,{}),(0,t.jsx)(f.Bar,{dataKey:"return",fill:"#8884d8",name:"Return %",radius:[4,4,0,0]}),(0,t.jsx)(f.Bar,{dataKey:"current_value",fill:"#82ca9d",name:"Current Value",radius:[4,4,0,0]})]})})}var k=e.i(21213),S=e.i(42509);function T({data:e}){return(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsxs)(k.LineChart,{data:e,children:[(0,t.jsx)(_.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(y.XAxis,{dataKey:"date",tick:{fontSize:12},tickFormatter:e=>new Date(e).toLocaleDateString()}),(0,t.jsx)(v.YAxis,{tick:{fontSize:12},tickFormatter:e=>`${e}%`}),(0,t.jsx)(N.Tooltip,{labelFormatter:e=>new Date(e).toLocaleDateString(),formatter:e=>[`${e.toFixed(2)}%`,""]}),(0,t.jsx)(w.Legend,{}),(0,t.jsx)(S.Line,{type:"monotone",dataKey:"portfolio",stroke:"#22c55e",name:"Portfolio",strokeWidth:2,dot:{r:4}}),(0,t.jsx)(S.Line,{type:"monotone",dataKey:"benchmark",stroke:"#ef4444",name:"Benchmark",strokeWidth:2,dot:{r:4}})]})})}function D({data:e}){return(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsxs)(b.BarChart,{data:e.sort((e,t)=>Math.abs(t.contribution)-Math.abs(e.contribution)),layout:"horizontal",children:[(0,t.jsx)(_.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(y.XAxis,{type:"number",tick:{fontSize:12},tickFormatter:e=>`${e}%`}),(0,t.jsx)(v.YAxis,{dataKey:"symbol",type:"category",width:80,tick:{fontSize:12}}),(0,t.jsx)(N.Tooltip,{formatter:(e,t)=>"contribution"===t?[`${e.toFixed(2)}%`,"Contribution"]:[`$${e.toLocaleString()}`,"Value"]}),(0,t.jsx)(f.Bar,{dataKey:"contribution",fill:"#3b82f6",name:"contribution",children:e.map((e,r)=>(0,t.jsx)(p.Cell,{fill:e.contribution>=0?"#22c55e":"#ef4444"},`cell-${r}`))})]})})}function A({data:e}){return(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsxs)(k.LineChart,{data:e,children:[(0,t.jsx)(_.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(y.XAxis,{dataKey:"date",tick:{fontSize:12},tickFormatter:e=>new Date(e).toLocaleDateString()}),(0,t.jsx)(v.YAxis,{tick:{fontSize:12}}),(0,t.jsx)(N.Tooltip,{labelFormatter:e=>new Date(e).toLocaleDateString(),formatter:(e,t)=>"volatility"===t?[e.toFixed(2),"Volatility"]:[e.toFixed(2),"Sharpe Ratio"]}),(0,t.jsx)(w.Legend,{}),(0,t.jsx)(S.Line,{type:"monotone",dataKey:"volatility",stroke:"#ef4444",name:"Volatility",strokeWidth:2,dot:{r:3}}),(0,t.jsx)(S.Line,{type:"monotone",dataKey:"sharpeRatio",stroke:"#22c55e",name:"Sharpe Ratio",strokeWidth:2,dot:{r:3},yAxisId:"right"})]})})}var R=e.i(64799),F=e.i(5190);function B({data:e,selectedPeriod:r,onPeriodChange:s}){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>s("7d"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${"7d"===r?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"7-Day"}),(0,t.jsx)("button",{onClick:()=>s("30d"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${"30d"===r?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"30-Day"}),(0,t.jsx)("button",{onClick:()=>s("90d"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${"90d"===r?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"90-Day"})]}),(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsxs)(F.AreaChart,{data:e,children:[(0,t.jsx)("defs",{children:(0,t.jsxs)("linearGradient",{id:"colorReturn",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:"#0ea5e9",stopOpacity:.8}),(0,t.jsx)("stop",{offset:"95%",stopColor:"#0ea5e9",stopOpacity:0})]})}),(0,t.jsx)(_.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(y.XAxis,{dataKey:"date",tick:{fontSize:12},tickFormatter:e=>new Date(e).toLocaleDateString()}),(0,t.jsx)(v.YAxis,{tick:{fontSize:12},tickFormatter:e=>`${e}%`}),(0,t.jsx)(N.Tooltip,{labelFormatter:e=>new Date(e).toLocaleDateString(),formatter:e=>[`${e.toFixed(2)}%`,"Return"]}),(0,t.jsx)(R.Area,{type:"monotone",dataKey:r,stroke:"#0ea5e9",fillOpacity:1,fill:"url(#colorReturn)",name:"Rolling Return"})]})})]})}let P=["#0ea5e9","#22c55e","#f59e0b","#ef4444","#8b5cf6","#ec4899","#14b8a6","#f97316"];function z({data:e}){return(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsxs)(h.PieChart,{children:[(0,t.jsx)(u.Pie,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percentage:t})=>`${e}: ${t.toFixed(1)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:e.map((e,r)=>(0,t.jsx)(p.Cell,{fill:P[r%P.length]},`cell-${r}`))}),(0,t.jsx)(N.Tooltip,{formatter:e=>`$${e.toLocaleString()}`}),(0,t.jsx)(w.Legend,{})]})})}var M=e.i(18004),V=e.i(77791),$=e.i(19013),I=e.i(22966);function E({value:e,percent:r=!0,className:a}){let n=e>0,l=0===e,i=r?`${e>=0?"+":""}${e.toFixed(2)}%`:`$${e.toLocaleString()}`;return(0,t.jsxs)(s.Card,{className:(0,I.cn)("border-l-4",a),children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Return"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,t.jsx)(M.TrendingUp,{className:"h-5 w-5 text-green-500"}),l&&(0,t.jsx)($.Minus,{className:"h-5 w-5 text-gray-500"}),!n&&!l&&(0,t.jsx)(V.TrendingDown,{className:"h-5 w-5 text-red-500"}),(0,t.jsx)("span",{className:(0,I.cn)("text-3xl font-bold",n&&"text-green-600",l&&"text-gray-600",!n&&!l&&"text-red-600"),children:i})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e>=0?"Profit":0===e?"Break even":"Loss"})]})]})}var H=e.i(94604);function L({value:e,change:r,className:a}){let n=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),l=void 0!==r?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(Math.abs(r)):null;return(0,t.jsxs)(s.Card,{className:a,children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(H.DollarSign,{className:"h-4 w-4"}),"Portfolio Value"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:n}),void 0!==r&&(0,t.jsxs)("p",{className:(0,I.cn)("text-xs mt-1",r>0?"text-green-600":r<0?"text-red-600":"text-muted-foreground"),children:[r>=0?"+":"",l," from last period"]})]})]})}var U=e.i(89578);function K({volatility:e,beta:r,sharpeRatio:a,className:n}){let l=e<10?{level:"Low",color:"text-green-600",bg:"bg-green-100"}:e<20?{level:"Medium",color:"text-yellow-600",bg:"bg-yellow-100"}:{level:"High",color:"text-red-600",bg:"bg-red-100"};return(0,t.jsxs)(s.Card,{className:n,children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(U.Activity,{className:"h-4 w-4"}),"Risk Metrics"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Volatility"}),(0,t.jsxs)("p",{className:"text-xl font-bold",children:[e.toFixed(2),"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Beta"}),(0,t.jsx)("p",{className:"text-xl font-bold",children:r.toFixed(2)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sharpe"}),(0,t.jsx)("p",{className:(0,I.cn)("text-xl font-bold",a>=1?"text-green-600":a>=0?"text-yellow-600":"text-red-600"),children:a.toFixed(2)})]})]}),(0,t.jsx)("div",{className:"mt-3 pt-3 border-t",children:(0,t.jsxs)("span",{className:(0,I.cn)("text-xs px-2 py-1 rounded-full",l.bg,l.color),children:[l.level," Risk"]})})]})]})}var O=e.i(9e4),W=e.i(99587);function G({maxDrawdown:e,maxDrawdownDate:r,recoveryTime:a,className:n}){return(0,t.jsxs)(s.Card,{className:(0,I.cn)("border-l-4 border-red-500",n),children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(O.ArrowDown,{className:"h-4 w-4 text-red-500"}),"Max Drawdown"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:[e>=0?"-":"",Math.abs(e).toFixed(2),"%"]}),r&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Largest drop on ",new Date(r).toLocaleDateString()]}),void 0!==a&&a>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[(0,t.jsx)(W.Clock,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:["Recovered in ",a," days"]})]})]})]})}function Y({cagr:e,annualizedReturn:r,className:a}){let n=e||r||0,l=n>0;return(0,t.jsxs)(s.Card,{className:(0,I.cn)("border-l-4 border-green-500",a),children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(M.TrendingUp,{className:"h-4 w-4"}),"CAGR / Annual Return"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsxs)("p",{className:(0,I.cn)("text-3xl font-bold",l?"text-green-600":"text-red-600"),children:[n>=0?"+":"",n.toFixed(2),"%"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Compound Annual Growth Rate"})]})]})}var J=e.i(30719),X=e.i(72230),q=e.i(92543),Q=e.i(30342),Z=e.i(286),ee=e.i(39197);function et({selectedPortfolioId:e,onSelectPortfolio:s}){let[n,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{c(!0);let t=await Q.portfoliosApi.list();if(i(t.portfolios),t.portfolios.length>0&&!e){let e=t.portfolios.find(e=>e.is_default)||t.portfolios[0];s(e.id)}}catch(e){m(e instanceof Error?e.message:"Failed to load portfolios")}finally{c(!1)}})()},[s,e]);let x=n.find(t=>t.id===e);return o?(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(l.Skeleton,{className:"h-10 w-48"})}):d?(0,t.jsxs)(a.Button,{variant:"outline",disabled:!0,children:[(0,t.jsx)(X.Building2,{className:"mr-2 h-4 w-4"}),"Error loading portfolios"]}):(0,t.jsxs)(Z.DropdownMenu,{children:[(0,t.jsx)(Z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{variant:"outline",className:"min-w-[200px] justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(X.Building2,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:x?.name||"Select Portfolio"})]}),(0,t.jsx)(J.ChevronDown,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,t.jsxs)(Z.DropdownMenuContent,{align:"start",className:"w-72",children:[(0,t.jsx)("div",{className:"px-2 py-1.5",children:(0,t.jsxs)("span",{className:"text-xs font-medium text-muted-foreground",children:[n.length," Portfolio",1!==n.length?"s":""]})}),(0,t.jsx)(Z.DropdownMenuSeparator,{}),n.map(e=>{let r;return(0,t.jsxs)(Z.DropdownMenuItem,{onClick:()=>s(e.id),className:"flex flex-col items-start gap-1 p-3",children:[(0,t.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.is_default?(0,t.jsx)(q.Briefcase,{className:"h-4 w-4 text-primary"}):(0,t.jsx)(X.Building2,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"font-medium",children:e.name}),e.is_default&&(0,t.jsx)(ee.Badge,{variant:"secondary",className:"text-xs",children:"Default"})]})}),(0,t.jsxs)("div",{className:"flex w-full items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:(r=e.total_value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r))}),(0,t.jsxs)("span",{className:e.total_pnl>=0?"text-green-600":"text-red-600",children:[e.total_pnl>=0?"+":"",e.total_pnl_percent.toFixed(2),"%"]})]})]},e.id)}),(0,t.jsx)(Z.DropdownMenuSeparator,{}),(0,t.jsxs)(Z.DropdownMenuItem,{onClick:()=>s(null),className:"flex items-center gap-2 text-muted-foreground",children:[(0,t.jsx)(M.TrendingUp,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Aggregate View (All Portfolios)"})]})]})]})}let er=(0,e.i(19952).default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);var es=e.i(36526);function ea({portfolios:e,selectedId:r,onSelect:a,className:n}){let l=[...e].sort((e,t)=>t.return-e.return),i=l[0]?.id,o=l[l.length-1]?.id;return(0,t.jsxs)(s.Card,{className:n,children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(er,{className:"h-5 w-5 text-yellow-500"}),"Portfolio Comparison"]}),(0,t.jsx)(s.CardDescription,{children:"Compare performance across your portfolios"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[e.map(s=>{let n,c=(n=s.id,l.findIndex(e=>e.id===n)+1),d=s.id===i,m=s.id===o;return(0,t.jsxs)("div",{onClick:()=>a(s.id),className:(0,I.cn)("p-4 border rounded-lg cursor-pointer transition-all",r===s.id?"border-primary bg-primary/5":"hover:border-muted-foreground/50",d&&"bg-green-50 border-green-200 dark:bg-green-900/20",m&&"bg-red-50 border-red-200 dark:bg-red-900/20"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:["#",c]}),d&&(0,t.jsx)(er,{className:"h-4 w-4 text-yellow-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:s.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Vol: ",s.volatility.toFixed(1),"%"]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Sharpe: ",s.sharpeRatio.toFixed(2)]})]})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("div",{className:(0,I.cn)("flex items-center gap-1 font-semibold",s.return>=0?"text-green-600":"text-red-600"),children:[s.return>=0?(0,t.jsx)(M.TrendingUp,{className:"h-4 w-4"}):(0,t.jsx)(V.TrendingDown,{className:"h-4 w-4"}),s.return>=0?"+":"",s.return.toFixed(2),"%"]})})]}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-4 text-xs",children:[(0,t.jsxs)("span",{className:"text-muted-foreground",children:["Max Drawdown: ",(0,t.jsxs)("span",{className:"text-red-600",children:["-",Math.abs(s.maxDrawdown).toFixed(2),"%"]})]}),d&&(0,t.jsx)(ee.Badge,{variant:"secondary",className:"bg-green-100 text-green-700",children:"Best Performer"}),m&&e.length>1&&(0,t.jsx)(ee.Badge,{variant:"secondary",className:"bg-red-100 text-red-700",children:"Worst Performer"})]})]},s.id)}),0===e.length&&(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(es.AlertCircle,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No portfolios to compare"}),(0,t.jsx)("p",{className:"text-sm",children:"Create multiple portfolios to see comparison"})]})]})})]})}var en=e.i(35644),el=e.i(9940),ei=e.i(776);function eo({holdings:e,className:r}){let a=[...e].sort((e,t)=>t.contribution-e.contribution),n=a.slice(0,5),l=a.slice(-5).reverse();return(0,t.jsxs)(s.Card,{className:r,children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Performance Breakdown"}),(0,t.jsx)(s.CardDescription,{children:"Contribution to portfolio return by holding"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,t.jsx)(M.TrendingUp,{className:"h-4 w-4 text-green-500"}),"Top Contributors"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[n.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-green-50 dark:bg-green-900/20",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs font-mono text-muted-foreground",children:r+1}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:e.symbol}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:e.name})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["+",e.contribution.toFixed(2),"%"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.weight.toFixed(1),"% weight"]})]})]},e.symbol)),0===n.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No positive contributors"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,t.jsx)(V.TrendingDown,{className:"h-4 w-4 text-red-500"}),"Bottom Contributors"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[l.map((r,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-red-50 dark:bg-red-900/20",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs font-mono text-muted-foreground",children:e.length-s}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:r.symbol}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:r.name})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-red-600",children:[r.contribution.toFixed(2),"%"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[r.weight.toFixed(1),"% weight"]})]})]},r.symbol)),0===l.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No negative contributors"})]})]})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-3",children:"All Holdings"}),(0,t.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,t.jsxs)(en.Table,{children:[(0,t.jsx)(en.TableHeader,{children:(0,t.jsxs)(en.TableRow,{children:[(0,t.jsx)(en.TableHead,{children:"Symbol"}),(0,t.jsx)(en.TableHead,{children:"Name"}),(0,t.jsx)(en.TableHead,{className:"text-right",children:"Weight"}),(0,t.jsx)(en.TableHead,{className:"text-right",children:"Return"}),(0,t.jsx)(en.TableHead,{className:"text-right",children:"Contribution"}),(0,t.jsx)(en.TableHead,{className:"text-right",children:"Value"})]})}),(0,t.jsx)(en.TableBody,{children:e.map(e=>{var r;let s;return(0,t.jsxs)(en.TableRow,{children:[(0,t.jsx)(en.TableCell,{className:"font-medium",children:e.symbol}),(0,t.jsx)(en.TableCell,{className:"text-muted-foreground truncate max-w-[150px]",children:e.name}),(0,t.jsxs)(en.TableCell,{className:"text-right",children:[e.weight.toFixed(1),"%"]}),(0,t.jsx)(en.TableCell,{className:"text-right",children:(r=e.return)>0?(0,t.jsxs)(ee.Badge,{className:"bg-green-100 text-green-700 hover:bg-green-200",children:[(0,t.jsx)(el.ArrowUpRight,{className:"h-3 w-3 mr-1"}),"+",r.toFixed(2),"%"]}):r<0?(0,t.jsxs)(ee.Badge,{variant:"destructive",className:"bg-red-100 text-red-700 hover:bg-red-200",children:[(0,t.jsx)(ei.ArrowDownRight,{className:"h-3 w-3 mr-1"}),r.toFixed(2),"%"]}):(0,t.jsxs)(ee.Badge,{variant:"secondary",children:[(0,t.jsx)($.Minus,{className:"h-3 w-3 mr-1"}),r.toFixed(2),"%"]})}),(0,t.jsxs)(en.TableCell,{className:(0,I.cn)("text-right font-medium",e.contribution>0?"text-green-600":e.contribution<0?"text-red-600":""),children:[e.contribution>=0?"+":"",e.contribution.toFixed(2),"%"]}),(0,t.jsx)(en.TableCell,{className:"text-right",children:(s=e.value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s))})]},e.symbol)})})]})})]})]})]})}var ec=e.i(74601),ed=e.i(37841),em=e.i(46045),ex=e.i(63333),eu=e.i(32012),eh=e.i(71253),ep=e.i(60762),eg=e.i(23325);let ej=[{value:"1d",label:"1D"},{value:"1w",label:"1W"},{value:"1m",label:"1M"},{value:"3m",label:"3M"},{value:"6m",label:"6M"},{value:"1y",label:"1Y"},{value:"2y",label:"2Y"},{value:"3y",label:"3Y"},{value:"5y",label:"5Y"},{value:"ytd",label:"YTD"},{value:"all",label:"All"}],ef=[{type:"sp500",name:"S&P 500",description:"500 largest US companies",category:"us_indices",annualized_return:.1,volatility:.15},{type:"nasdaq100",name:"NASDAQ-100",description:"100 largest non-financial stocks",category:"us_indices",annualized_return:.14,volatility:.2},{type:"dow30",name:"Dow Jones 30",description:"30 blue-chip companies",category:"us_indices",annualized_return:.09,volatility:.13},{type:"russell2000",name:"Russell 2000",description:"2000 small-cap companies",category:"us_indices",annualized_return:.08,volatility:.22},{type:"vti",name:"VTI",description:"Vanguard Total Stock Market",category:"etf",annualized_return:.1,volatility:.16},{type:"qqq",name:"QQQ",description:"Invesco NASDAQ 100",category:"etf",annualized_return:.14,volatility:.21},{type:"spy",name:"SPY",description:"SPDR S&P 500 ETF",category:"etf",annualized_return:.1,volatility:.15},{type:"dia",name:"DIA",description:"SPDR Dow Jones ETF",category:"etf",annualized_return:.09,volatility:.13},{type:"iwm",name:"IWM",description:"iShares Russell 2000",category:"etf",annualized_return:.08,volatility:.22},{type:"vgt",name:"VGT",description:"Vanguard Information Tech",category:"etf",annualized_return:.16,volatility:.24},{type:"vht",name:"VHT",description:"Vanguard Health Care",category:"etf",annualized_return:.11,volatility:.15},{type:"vcr",name:"VCR",description:"Vanguard Consumer Disc.",category:"etf",annualized_return:.1,volatility:.18},{type:"vdc",name:"VDC",description:"Vanguard Consumer Staples",category:"etf",annualized_return:.08,volatility:.12},{type:"ven",name:"VEN",description:"Vanguard Energy",category:"etf",annualized_return:.07,volatility:.28},{type:"vfi",name:"VFI",description:"Vanguard Financials",category:"etf",annualized_return:.09,volatility:.2},{type:"viu",name:"VIU",description:"Vanguard Developed ex-US",category:"international",annualized_return:.06,volatility:.18},{type:"acwx",name:"ACWX",description:"iShares MSCI AC World ex-US",category:"international",annualized_return:.05,volatility:.17},{type:"bnd",name:"BND",description:"Vanguard Total Bond Market",category:"bonds",annualized_return:.04,volatility:.06},{type:"agg",name:"AGG",description:"iShares Core US Aggregate",category:"bonds",annualized_return:.03,volatility:.05},{type:"tlt",name:"TLT",description:"iShares 20+ Year Treasury",category:"bonds",annualized_return:.02,volatility:.2},{type:"gld",name:"GLD",description:"SPDR Gold Shares",category:"custom",annualized_return:.06,volatility:.16},{type:"bitcoin",name:"Bitcoin",description:"BTC/USD",category:"crypto",annualized_return:.45,volatility:.7},{type:"ethereum",name:"Ethereum",description:"ETH/USD",category:"crypto",annualized_return:.35,volatility:.65}],eb=[{value:"us_indices",label:"US Indices"},{value:"etf",label:"ETFs"},{value:"crypto",label:"Cryptocurrency"},{value:"bonds",label:"Bonds"},{value:"international",label:"International"}];function ey(e,t=0){if(0===e.length)return[];let r={ids:e.map(e=>e.id),symbols:e.map(e=>e.symbol),names:e.map(e=>e.name),sectors:e.map(e=>e.sector||"Other"),assetClasses:e.map(e=>e.asset_class),currentValues:Float64Array.from(e.map(e=>e.current_value)),avgCosts:Float64Array.from(e.map(e=>e.average_cost)),currentPrices:Float64Array.from(e.map(e=>e.current_price)),unrealizedPnls:Float64Array.from(e.map(e=>e.unrealized_pnl))},s=function(e){let t=0,r=e.currentValues;for(let e=0;e<r.length;e++)t+=r[e];return t}(r),a=function(e,t){let r=new Float64Array(e.currentValues.length);if(t>0)for(let s=0;s<r.length;s++)r[s]=e.currentValues[s]/t*100;return r}(r,s),n=function(e){let t=new Float64Array(e.currentValues.length);for(let r=0;r<t.length;r++)e.avgCosts[r]>0&&(t[r]=(e.currentPrices[r]-e.avgCosts[r])/e.avgCosts[r]*100);return t}(r),l=function(e,t){let r=new Float64Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]/100*t[s];return r}(a,n),i=Array(e.length);for(let s=0;s<e.length;s++){let e=0!==t?l[s]/t*100:0;i[s]={holding_id:r.ids[s],symbol:r.symbols[s],name:r.names[s],sector:r.sectors[s],asset_class:r.assetClasses[s],weight:a[s],return:n[s],contribution:l[s],contribution_percent:isNaN(e)?0:e,value_start:r.currentValues[s]/(1+n[s]/100),value_end:r.currentValues[s],value_change:r.unrealizedPnls[s],avg_weight:a[s]}}return i.sort((e,t)=>t.contribution-e.contribution),i}function ev(e,t=0){let r=ey(e,t),s=e.reduce((e,t)=>e+t.current_value,0),a=new Map,n=new Map,l=new Map,i=new Map,o=new Map;for(let e of r){let t=e.sector;a.has(t)||(a.set(t,[]),n.set(t,0),l.set(t,0),i.set(t,0),o.set(t,{symbol:"",contribution:-1/0,return:0})),a.get(t).push(e.contribution),n.set(t,n.get(t)+e.weight),l.set(t,l.get(t)+e.contribution),i.set(t,i.get(t)+1);let r=o.get(t);e.contribution>r.contribution&&o.set(t,{symbol:e.symbol,contribution:e.contribution,return:e.return})}let c=[];return a.forEach((e,r)=>{let a=n.get(r),d=l.get(r),m=i.get(r),x=o.get(r),u=a>0?d/(a/100):0,h=(a-10)*u*.1,p=d-h;c.push({sector:r,weight:a,return:u,contribution:d,contribution_percent:s>0?d/t*100:0,holdings_count:m,top_holding:x.symbol,top_holding_return:x.return,allocation_effect:h,selection_effect:p,total_effect:d})}),c.sort((e,t)=>t.contribution-e.contribution)}var eN=e.i(20251);let ew={Technology:"#3B82F6",Healthcare:"#10B981",Financial:"#F59E0B",Consumer:"#EC4899",Energy:"#EF4444",Industrial:"#8B5CF6",Materials:"#06B6D4","Real Estate":"#14B8A6",Utilities:"#F97316",Communication:"#6366F1",Other:"#6B7280"};function e_({data:e,type:r="bar",loading:s=!1,showBenchmark:a=!1,benchmarkReturn:n}){if(s)return(0,t.jsx)("div",{className:"h-[400px] w-full bg-muted animate-pulse rounded-lg"});if(0===e.length)return(0,t.jsx)("div",{className:"h-[400px] w-full flex items-center justify-center bg-muted/50 rounded-lg",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No attribution data available"})});let l=e=>`${e>=0?"+":""}${e.toFixed(2)}%`,i=({active:e,payload:r})=>{if(e&&r&&r.length){let e=r[0].payload,s=void 0!==n?e.return-n:void 0;return(0,t.jsxs)("div",{className:"bg-background border rounded-lg shadow-lg p-3",children:[(0,t.jsx)("p",{className:"font-medium capitalize mb-2",children:e.sector||e.name}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Weight:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.weight.toFixed(1),"%"]})]}),void 0!==e.holdings_count&&(0,t.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Holdings:"}),(0,t.jsx)("span",{className:"font-medium",children:e.holdings_count})]}),void 0!==e.contribution&&(0,t.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Contribution:"}),(0,t.jsx)("span",{className:(0,I.cn)("font-medium",e.contribution>=0?"text-green-600":"text-red-600"),children:l(e.contribution)})]}),void 0!==s&&(0,t.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"vs Benchmark:"}),(0,t.jsx)("span",{className:(0,I.cn)("font-medium",s>=0?"text-green-600":"text-red-600"),children:l(s)})]}),(0,t.jsxs)("div",{className:"flex justify-between gap-8",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Holdings:"}),(0,t.jsx)("span",{className:"font-medium",children:e.holdings_count})]})]})]})}return null};return"pie"===r?(0,t.jsx)("div",{className:"h-[400px] w-full",children:(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:"100%",children:(0,t.jsxs)(h.PieChart,{children:[(0,t.jsx)(u.Pie,{data:e,cx:"50%",cy:"45%",outerRadius:140,fill:"#8884d8",dataKey:"contribution",nameKey:"sector",label:({sector:e,percent:t})=>`${e} (${(100*t).toFixed(0)}%)`,labelLine:!1,children:e.map((e,r)=>(0,t.jsx)(p.Cell,{fill:ew[e.sector]||ew.Other},`cell-${r}`))}),(0,t.jsx)(N.Tooltip,{content:i}),(0,t.jsx)(w.Legend,{content:e=>{let{payload:r}=e;return(0,t.jsx)("ul",{className:"flex flex-wrap justify-center gap-3 mt-4",children:r.map((e,r)=>(0,t.jsxs)("li",{className:"flex items-center gap-1.5 text-sm",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"capitalize",children:e.value})]},`legend-${r}`))})}})]})})}):(0,t.jsx)("div",{className:"h-[400px] w-full",children:(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:"100%",children:(0,t.jsxs)(b.BarChart,{data:e,layout:"vertical",margin:{top:20,right:30,left:100,bottom:5},children:[(0,t.jsx)(_.CartesianGrid,{strokeDasharray:"3 3",className:"stroke-muted"}),(0,t.jsx)(y.XAxis,{type:"number",tickFormatter:e=>`${e>=0?"+":""}${e.toFixed(1)}%`,tick:{fontSize:12,fill:"#6B7280"},axisLine:{stroke:"#E5E7EB"}}),(0,t.jsx)(v.YAxis,{type:"category",dataKey:"sector",tick:{fontSize:12,fill:"#6B7280"},axisLine:!1,tickLine:!1,width:90}),(0,t.jsx)(N.Tooltip,{content:(0,t.jsx)(i,{})}),(0,t.jsx)(w.Legend,{}),a&&void 0!==n&&(0,t.jsx)(eN.ReferenceLine,{x:n,stroke:"#F59E0B",strokeDasharray:"5 5",label:{value:`Benchmark: ${l(n)}`,position:"top",fill:"#F59E0B",fontSize:11}}),(0,t.jsx)(f.Bar,{dataKey:"allocation_effect",name:"Allocation Effect",stackId:"a",fill:"#3B82F6",radius:[0,0,0,0]}),(0,t.jsx)(f.Bar,{dataKey:"selection_effect",name:"Selection Effect",stackId:"a",fill:"#10B981",radius:[0,4,4,0]})]})})})}var eC=e.i(2142),ek=e.i(68937),eS=e.i(7595),eT=e.i(95734);function eD({attribution:e,formatCurrency:s,formatPercent:n}){let[l,i]=(0,r.useState)([{id:"contribution",desc:!0}]),[o,c]=(0,r.useState)(new Set),d=(0,r.useMemo)(()=>[{id:"select",header:({table:e})=>(0,t.jsx)(eT.Checkbox,{checked:e.getIsAllPageRowsSelected(),onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t),"aria-label":"Select all"}),cell:({row:e})=>(0,t.jsx)(eT.Checkbox,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),"aria-label":"Select row"}),enableSorting:!1,size:40},{accessorKey:"symbol",header:({column:e})=>(0,t.jsxs)(a.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Symbol",(0,t.jsx)(eS.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.getValue("symbol")}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:e.original.name})]}),size:120},{accessorKey:"sector",header:"Sector",cell:({row:e})=>{let r=e.getValue("sector");return(0,t.jsx)(ee.Badge,{variant:"outline",style:{borderColor:ew[r]||ew.Other,color:ew[r]||ew.Other},children:r})},size:120},{accessorKey:"weight",header:({column:e})=>(0,t.jsxs)(a.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Weight",(0,t.jsx)(eS.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let r=e.getValue("weight");return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:`${Math.min(4*r,100)}%`}})}),(0,t.jsxs)("span",{className:"text-sm",children:[r.toFixed(1),"%"]})]})},size:140},{accessorKey:"return",header:({column:e})=>(0,t.jsxs)(a.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Return",(0,t.jsx)(eS.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let r=e.getValue("return");return(0,t.jsx)("span",{className:(0,I.cn)("font-medium",r>=0?"text-green-600":"text-red-600"),children:n(r)})},size:100},{accessorKey:"contribution",header:({column:e})=>(0,t.jsxs)(a.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"p-0 hover:bg-transparent",children:["Contribution",(0,t.jsx)(eS.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let r=e.getValue("contribution");return(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsx)("span",{className:(0,I.cn)("font-semibold",r>=0?"text-green-600":"text-red-600"),children:n(r)}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:s(1e3*e.original.contribution)})]})},size:140},{accessorKey:"value_change",header:"Value Change",cell:({row:e})=>{let r=e.getValue("value_change");return(0,t.jsx)("span",{className:(0,I.cn)("font-medium",r>=0?"text-green-600":"text-red-600"),children:s(r)})},size:120}],[s,n]),m=(0,eC.useReactTable)({data:e,columns:d,getCoreRowModel:(0,ek.getCoreRowModel)(),getSortedRowModel:(0,ek.getSortedRowModel)(),onSortingChange:i,state:{sorting:l},initialState:{pagination:{pageSize:10}}});return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.length," holdings • Click column headers to sort"]})}),(0,t.jsx)("div",{className:"border rounded-lg",children:(0,t.jsxs)(en.Table,{children:[(0,t.jsx)(en.TableHeader,{children:m.getHeaderGroups().map(e=>(0,t.jsx)(en.TableRow,{children:e.headers.map(e=>(0,t.jsx)(en.TableHead,{style:{width:e.getSize()},children:e.isPlaceholder?null:(0,eC.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,t.jsx)(en.TableBody,{children:m.getRowModel().rows?.length?m.getRowModel().rows.map(e=>(0,t.jsx)(en.TableRow,{"data-state":e.getIsSelected()&&"selected",className:"cursor-pointer",onClick:()=>e.toggleSelected(),children:e.getVisibleCells().map(e=>(0,t.jsx)(en.TableCell,{children:(0,eC.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(en.TableRow,{children:(0,t.jsx)(en.TableCell,{colSpan:d.length,className:"h-24 text-center",children:"No attribution data available"})})})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",m.getState().pagination.pageIndex*m.getState().pagination.pageSize+1," to"," ",Math.min((m.getState().pagination.pageIndex+1)*m.getState().pagination.pageSize,e.length)," ","of ",e.length," holdings"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>m.previousPage(),disabled:!m.getCanPreviousPage(),children:"Previous"}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>m.nextPage(),disabled:!m.getCanNextPage(),children:"Next"})]})]})]})}function eA({summary:e,sectorAttribution:r,assetClassAttribution:a}){let n=e=>`${e>=0?"+":""}${e.toFixed(2)}%`,l=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)(s.Card,{className:"border-green-200 bg-green-50/50 dark:bg-green-900/20 dark:border-green-800",children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(el.ArrowUpRight,{className:"h-4 w-4 text-green-600"}),"Top Contributors"]})}),(0,t.jsx)(s.CardContent,{children:e.top_contributor?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-lg",children:e.top_contributor.symbol}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.top_contributor.name})]}),(0,t.jsx)(ee.Badge,{className:"bg-green-100 text-green-700",children:n(e.top_contributor.contribution)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Weight"}),(0,t.jsxs)("p",{className:"font-medium",children:[e.top_contributor.weight.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Return"}),(0,t.jsx)("p",{className:"font-medium text-green-600",children:n(e.top_contributor.return)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Value"}),(0,t.jsx)("p",{className:"font-medium",children:l(e.top_contributor.value_end)})]})]})]}):(0,t.jsx)("p",{className:"text-muted-foreground",children:"No data available"})})]}),(0,t.jsxs)(s.Card,{className:"border-red-200 bg-red-50/50 dark:bg-red-900/20 dark:border-red-800",children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(ei.ArrowDownRight,{className:"h-4 w-4 text-red-600"}),"Bottom Contributors"]})}),(0,t.jsx)(s.CardContent,{children:e.bottom_contributor?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-lg",children:e.bottom_contributor.symbol}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.bottom_contributor.name})]}),(0,t.jsx)(ee.Badge,{className:"bg-red-100 text-red-700",children:n(e.bottom_contributor.contribution)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Weight"}),(0,t.jsxs)("p",{className:"font-medium",children:[e.bottom_contributor.weight.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Return"}),(0,t.jsx)("p",{className:"font-medium text-red-600",children:n(e.bottom_contributor.return)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Value"}),(0,t.jsx)("p",{className:"font-medium",children:l(e.bottom_contributor.value_end)})]})]})]}):(0,t.jsx)("p",{className:"text-muted-foreground",children:"No data available"})})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(ex.PieChart,{className:"h-5 w-5"}),"Sector Performance"]}),(0,t.jsx)(s.CardDescription,{children:"How each sector contributed to overall returns"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:r.slice(0,6).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ew[e.sector]||"#6B7280"}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.sector}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.holdings_count," holding",1!==e.holdings_count?"s":""]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Weight"}),(0,t.jsxs)("p",{className:"font-medium",children:[e.weight.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Return"}),(0,t.jsx)("p",{className:(0,I.cn)("font-medium",e.return>=0?"text-green-600":"text-red-600"),children:n(e.return)})]}),(0,t.jsxs)("div",{className:"text-right w-20",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Contribution"}),(0,t.jsx)("p",{className:(0,I.cn)("font-semibold",e.contribution>=0?"text-green-600":"text-red-600"),children:n(e.contribution)})]})]})]},e.sector))})})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(eh.Layers,{className:"h-5 w-5"}),"Asset Class Breakdown"]}),(0,t.jsx)(s.CardDescription,{children:"Performance by asset class"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("p",{className:"font-medium capitalize",children:e.asset_class.replace("_"," ")}),(0,t.jsxs)(ee.Badge,{variant:"secondary",children:[e.holdings_count," holding",1!==e.holdings_count?"s":""]})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Weight"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.weight.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Return"}),(0,t.jsx)("span",{className:(0,I.cn)("font-medium",e.return>=0?"text-green-600":"text-red-600"),children:n(e.return)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Contribution"}),(0,t.jsx)("span",{className:(0,I.cn)("font-semibold",e.contribution>=0?"text-green-600":"text-red-600"),children:n(e.contribution)})]})]})]},e.asset_class))})})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(M.TrendingUp,{className:"h-5 w-5"}),"Attribution Effect Analysis"]}),(0,t.jsx)(s.CardDescription,{children:"Breakdown of allocation vs selection effects"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Allocation Effect"}),(0,t.jsx)("p",{className:(0,I.cn)("text-2xl font-bold",e.allocation_effect>=0?"text-blue-600":"text-red-600"),children:n(e.allocation_effect)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Impact of weight differences vs benchmark"})]}),(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Selection Effect"}),(0,t.jsx)("p",{className:(0,I.cn)("text-2xl font-bold",e.selection_effect>=0?"text-green-600":"text-red-600"),children:n(e.selection_effect)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Impact of security selection within sectors"})]}),(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Effect"}),(0,t.jsx)("p",{className:(0,I.cn)("text-2xl font-bold",e.total_effect>=0?"text-purple-600":"text-red-600"),children:n(e.total_effect)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Combined allocation + selection effects"})]})]})})]})]})}function eR({holdings:e,loading:i=!1,onPeriodChange:o,initialBenchmark:c="sp500"}){let[d,m]=(0,r.useState)("1m"),[x,u]=(0,r.useState)("summary"),[h,p]=(0,r.useState)(c),[g,j]=(0,r.useState)(!1),[f,b]=(0,r.useState)(["us_indices","etf"]),y=(0,r.useMemo)(()=>ef.filter(e=>f.includes(e.category)),[f]),v=(0,r.useMemo)(()=>{let t=function(e,t=0){let r=ey(e,t),s=ev(e,t),a=r.reduce((e,t)=>e+t.contribution,0),n=s.reduce((e,t)=>e+t.allocation_effect,0),l=s.reduce((e,t)=>e+t.selection_effect,0),i=r.filter(e=>e.contribution>0).length,o=r.filter(e=>e.contribution<0).length,c=r.filter(e=>0===e.contribution).length;return{total_return:t,total_contribution:a,allocation_effect:n,selection_effect:l,total_effect:a,top_contributor:r[0]||null,bottom_contributor:r[r.length-1]||null,best_sector:s[0]||null,worst_sector:s[s.length-1]||null,positive_holdings:i,negative_holdings:o,neutral_holdings:c}}(e),r=ef.find(e=>e.type===h);if(r){let s,a,n,l,i,o,c,m,x,u;return s=(r.annualized_return||.1)*(({"1d":365,"1w":52,"1m":12,"3m":4,"6m":2,"1y":1,"2y":.5,"3y":.333,"5y":.2,ytd:1.5,all:.5})[d]||1),a=t.total_return-s,n=0!==s?a/Math.abs(s)*100:0,l=.8*Math.abs(a),i=(r.volatility||.15)>0?1+(.2*Math.random()-.1):1,o=.85+.1*Math.random(),m=(c=ev(e,t.total_return)).filter(e=>e.return>s),x=c.filter(e=>e.return<s),u={benchmark_type:r.type,benchmark_return:s,portfolio_return:t.total_return,excess_return:a,excess_return_percent:n,tracking_error:l,information_ratio:0!==l?a/l:0,beta:i,correlation:o,sector_outperformance:m.slice(0,3),sector_underperformance:x.slice(0,3)},{...t,benchmark_comparison:u}}return t},[e,h,d]),N=(0,r.useMemo)(()=>ey(e),[e]),w=(0,r.useMemo)(()=>ev(e),[e]),_=(0,r.useMemo)(()=>(function(e,t=0){let r=ey(e,t),s=e.reduce((e,t)=>e+t.current_value,0),a=new Map;for(let e of r){let t=e.asset_class;a.has(t)||a.set(t,{weight:0,contribution:0,holdings:0,sectors:new Set});let r=a.get(t);r.weight+=e.weight,r.contribution+=e.contribution,r.holdings++,r.sectors.add(e.sector)}let n=[];return a.forEach((e,r)=>{let a=e.weight>0?e.contribution/(e.weight/100):0;n.push({asset_class:r,weight:e.weight,return:a,contribution:e.contribution,contribution_percent:s>0?e.contribution/t*100:0,holdings_count:e.holdings,sectors_count:e.sectors.size})}),n.sort((e,t)=>t.contribution-e.contribution)})(e),[e]),C=e=>`${e>=0?"+":""}${e.toFixed(2)}%`,k=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),S=ef.find(e=>e.type===h),T=v.benchmark_comparison?.excess_return??0;return i?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(l.Skeleton,{className:"h-8 w-64"}),(0,t.jsx)(l.Skeleton,{className:"h-10 w-64"})]}),(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(e=>(0,t.jsx)(l.Skeleton,{className:"h-32"},e))}),(0,t.jsx)(l.Skeleton,{className:"h-96"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Performance Attribution"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Analyze how each holding, sector, and asset class contributed to your returns"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(ed.Popover,{open:g,onOpenChange:j,children:[(0,t.jsx)(ed.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{variant:"outline",className:"min-w-[180px]",children:[(0,t.jsx)(ep.Target,{className:"w-4 h-4 mr-2"}),(0,t.jsx)("span",{className:"truncate",children:S?.name||"Select Benchmark"})]})}),(0,t.jsx)(ed.PopoverContent,{className:"w-80",align:"end",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Benchmark Settings"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Compare your portfolio performance against market indices, ETFs, or custom benchmarks."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(em.Label,{className:"text-xs",children:"Categories"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:eb.map(e=>(0,t.jsx)(ee.Badge,{variant:f.includes(e.value)?"default":"outline",className:"cursor-pointer",onClick:()=>{f.includes(e.value)?b(t=>t.filter(t=>t!==e.value)):b(t=>[...t,e.value])},children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[(0,t.jsx)(em.Label,{className:"text-xs",children:"Select Benchmark"}),y.map(e=>(0,t.jsxs)("div",{className:(0,I.cn)("flex items-center gap-2 p-2 rounded cursor-pointer transition-colors",h===e.type?"bg-primary/10":"hover:bg-muted"),onClick:()=>{p(e.type),j(!1)},children:[(0,t.jsx)("div",{className:(0,I.cn)("w-3 h-3 rounded-full",h===e.type?"bg-primary":"border border-muted-foreground")}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.type))]})]})})]}),(0,t.jsxs)(ec.Select,{value:d,onValueChange:e=>{m(e),o?.(e)},children:[(0,t.jsx)(ec.SelectTrigger,{className:"w-[120px]",children:(0,t.jsx)(ec.SelectValue,{placeholder:"Period"})}),(0,t.jsx)(ec.SelectContent,{children:ej.map(e=>(0,t.jsx)(ec.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),v.benchmark_comparison&&(0,t.jsx)(s.Card,{className:"bg-muted/50",children:(0,t.jsx)(s.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ep.Target,{className:"w-5 h-5 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"vs"}),(0,t.jsx)("span",{className:"font-semibold",children:S?.name})]}),(0,t.jsx)("div",{className:"h-8 w-px bg-border"}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Portfolio: "}),(0,t.jsx)("span",{className:(0,I.cn)("font-semibold",v.total_return>=0?"text-green-600":"text-red-600"),children:C(v.total_return)})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-muted-foreground",children:[S?.name,": "]}),(0,t.jsx)("span",{className:(0,I.cn)("font-semibold",v.benchmark_comparison.benchmark_return>=0?"text-green-600":"text-red-600"),children:C(v.benchmark_comparison.benchmark_return)})]}),(0,t.jsx)("div",{className:"h-4 w-px bg-border"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Excess Return: "}),(0,t.jsx)("span",{className:(0,I.cn)("font-semibold",T>=0?"text-green-600":"text-red-600"),children:C(T)})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[void 0!==v.benchmark_comparison.information_ratio&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(U.Activity,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:["IR: ",v.benchmark_comparison.information_ratio.toFixed(2)]})]}),void 0!==v.benchmark_comparison.beta&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(eg.Zap,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:["β: ",v.benchmark_comparison.beta.toFixed(2)]})]})]})]})})}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Total Return"}),v.total_return>=0?(0,t.jsx)(M.TrendingUp,{className:"h-4 w-4 text-green-600"}):(0,t.jsx)(V.TrendingDown,{className:"h-4 w-4 text-red-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:(0,I.cn)("text-2xl font-bold",v.total_return>=0?"text-green-600":"text-red-600"),children:C(v.total_return)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[k(v.total_contribution)," contribution"]})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Top Contributor"}),(0,t.jsx)(el.ArrowUpRight,{className:"h-4 w-4 text-green-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:v.top_contributor?.symbol||"-"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:v.top_contributor?`${C(v.top_contributor.contribution)} contribution`:"No data"})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Worst Performer"}),(0,t.jsx)(ei.ArrowDownRight,{className:"h-4 w-4 text-red-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:v.bottom_contributor?.symbol||"-"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:v.bottom_contributor?`${C(v.bottom_contributor.contribution)} contribution`:"No data"})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Allocation vs Selection"}),(0,t.jsx)(ex.PieChart,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Allocation"}),(0,t.jsx)("span",{className:(0,I.cn)("font-medium",v.allocation_effect>=0?"text-green-600":"text-red-600"),children:C(v.allocation_effect)})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Selection"}),(0,t.jsx)("span",{className:(0,I.cn)("font-medium",v.selection_effect>=0?"text-green-600":"text-red-600"),children:C(v.selection_effect)})]})]})})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Attribution Breakdown"}),(0,t.jsxs)(s.CardDescription,{children:[v.positive_holdings," holdings positive, ",v.negative_holdings," negative"]})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)(n.Tabs,{value:x,onValueChange:u,children:[(0,t.jsxs)(n.TabsList,{className:"mb-4",children:[(0,t.jsxs)(n.TabsTrigger,{value:"summary",children:[(0,t.jsx)(eh.Layers,{className:"w-4 h-4 mr-2"}),"Summary"]}),(0,t.jsxs)(n.TabsTrigger,{value:"holdings",children:[(0,t.jsx)(eu.BarChart3,{className:"w-4 h-4 mr-2"}),"By Holding"]}),(0,t.jsxs)(n.TabsTrigger,{value:"sectors",children:[(0,t.jsx)(ex.PieChart,{className:"w-4 h-4 mr-2"}),"By Sector"]}),(0,t.jsxs)(n.TabsTrigger,{value:"assets",children:[(0,t.jsx)(eh.Layers,{className:"w-4 h-4 mr-2"}),"By Asset Class"]})]}),(0,t.jsx)(n.TabsContent,{value:"summary",children:(0,t.jsx)(eA,{summary:v,sectorAttribution:w,assetClassAttribution:_})}),(0,t.jsx)(n.TabsContent,{value:"holdings",children:(0,t.jsx)(eD,{attribution:N,formatCurrency:k,formatPercent:C})}),(0,t.jsx)(n.TabsContent,{value:"sectors",children:(0,t.jsx)(e_,{data:w,type:"bar",showBenchmark:!!v.benchmark_comparison,benchmarkReturn:v.benchmark_comparison?.benchmark_return})}),(0,t.jsx)(n.TabsContent,{value:"assets",children:(0,t.jsx)(e_,{data:w,type:"pie"})})]})})]})]})}var eF=e.i(30977),eB=e.i(73099),eP=e.i(35601);let ez={"1d":"3m","7d":"3m","30d":"3m","90d":"6m","180d":"6m","1y":"1y","3y":"1y","5y":"1y",ytd:"1y",all:"1y"},eM=(0,eF.create)()((0,eB.persist)((e,t)=>({selectedPortfolioId:null,selectedPeriod:"1y",selectedBenchmark:"sp500",data:null,loading:!1,error:null,lastUpdated:null,setSelectedPortfolio:r=>{e({selectedPortfolioId:r}),r&&t().fetchAnalytics()},setSelectedPeriod:r=>{e({selectedPeriod:r}),t().fetchAnalytics()},setSelectedBenchmark:r=>{e({selectedBenchmark:r}),t().fetchAnalytics()},fetchAnalytics:async()=>{let{selectedPortfolioId:r,selectedPeriod:s,selectedBenchmark:a}=t();if(!r)return void e({error:"No portfolio selected",loading:!1});e({loading:!0,error:null});try{let t=ez[s],[a,n,l,i]=await Promise.all([eP.portfolioAnalyticsApi.getPortfolioSummary(r),eP.portfolioAnalyticsApi.getPerformanceMetrics(r,t),eP.portfolioAnalyticsApi.getRiskAnalysis(r),eP.portfolioAnalyticsApi.getHoldingsAnalysis(r)]),o={total_return:n.total_return||0,total_value:a.total_value,total_value_change:a.total_pnl,total_value_change_percent:a.total_pnl_percent,summary:{...a},performance:{portfolio_id:r,time_period:s,cagr:n.annualized_return||0,total_return:n.total_return,total_return_percent:n.total_return_percent,annualized_return:n.annualized_return,volatility:n.volatility,sharpe_ratio:n.sharpe_ratio,sortino_ratio:null,max_drawdown:n.max_drawdown||null,max_drawdown_percent:n.max_drawdown_percent||null,max_drawdown_date:null,recovery_time:null,best_day:n.best_day,worst_day:n.worst_day,win_rate:n.win_rate,alpha_vs_sp500:n.alpha_vs_sp500,beta_vs_sp500:n.beta_vs_sp500,var_95:null,var_99:null,avg_win:null,avg_loss:null,profit_factor:null},performance_by_asset:[],risk_metrics:{volatility:l.volatility_exposure||0,beta:l.volatility_exposure||0,sharpe_ratio:n.sharpe_ratio||0},period_start:new Date(Date.now()-31536e6).toISOString(),period_end:new Date().toISOString(),total_transactions:0};e({data:o,loading:!1,lastUpdated:new Date().toISOString()})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch analytics",loading:!1})}},clearAnalytics:()=>{e({data:null,error:null,lastUpdated:null})}}),{name:"analytics-storage",partialize:e=>({selectedPortfolioId:e.selectedPortfolioId,selectedPeriod:e.selectedPeriod,selectedBenchmark:e.selectedBenchmark})}));function eV(e,t){let r,s,a,n=function(e,t){let{format:r}=t,s=e.summary||{name:"Unknown Portfolio",total_value:e.total_value,total_invested:0,total_pnl:0,total_pnl_percent:0},a=e.performance||{cagr:0,total_return:0,total_return_percent:0,annualized_return:0,best_day:0,worst_day:0,win_rate:0},n=e.risk_metrics||{volatility:0,beta:1,sharpe_ratio:0},l={summary:{portfolio:s.name,totalValue:s.total_value,totalReturn:a.total_return_percent,periodStart:e.period_start,periodEnd:e.period_end},performance:{cagr:a.cagr,totalReturn:a.total_return_percent,annualizedReturn:a.annualized_return,bestDay:a.best_day,worstDay:a.worst_day,winRate:a.win_rate},risk:{volatility:n.volatility,beta:n.beta,sharpeRatio:n.sharpe_ratio},allocation:e.performance_by_asset,exportedAt:new Date().toISOString(),period:t.period||"1y"};if("json"===r)return JSON.stringify(l,null,2);if("csv"===r){let t=[];return t.push("Summary"),t.push("Portfolio,Total Value,Total Return,Period Start,Period End"),t.push(`${l.summary.portfolio},${l.summary.totalValue},${l.summary.totalReturn}%,${l.summary.periodStart},${l.summary.periodEnd}`),t.push(""),t.push("Performance"),t.push("CAGR,Total Return,Annualized Return,Win Rate"),t.push(`${l.performance.cagr}%,${l.performance.totalReturn}%,${l.performance.annualizedReturn}%,${l.performance.winRate}%`),t.push(""),t.push("Risk Metrics"),t.push("Volatility,Beta,Sharpe Ratio"),t.push(`${l.risk.volatility}%,${l.risk.beta},${l.risk.sharpeRatio}`),t.push(""),t.push("Allocation"),t.push("Asset Type,Value,Return"),e.performance_by_asset.forEach(e=>{t.push(`${e.asset_type},${e.value},${e.return}%`)}),t.join("\n")}return null}(e,t);if(!n)return;let l=new Date().toISOString().split("T")[0],i=`portfolio-analytics-${t.period||"1y"}-${l}.${t.format}`;r=new Blob([n],{type:"json"===t.format?"application/json":"text/csv"}),s=URL.createObjectURL(r),(a=document.createElement("a")).href=s,a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}let e$=[{value:"1d",label:"1D"},{value:"7d",label:"7D"},{value:"30d",label:"30D"},{value:"90d",label:"90D"},{value:"180d",label:"6M"},{value:"1y",label:"1Y"},{value:"3y",label:"3Y"},{value:"5y",label:"5Y"},{value:"all",label:"All"}],eI=[{value:"sp500",label:"S&P 500"},{value:"nasdaq",label:"NASDAQ"},{value:"dow",label:"Dow Jones"}];function eE(){let{selectedPortfolioId:e,selectedPeriod:i,selectedBenchmark:u,data:h,loading:p,error:g,lastUpdated:f,setSelectedPortfolio:b,setSelectedPeriod:y,setSelectedBenchmark:v,fetchAnalytics:N}=eM(),[w,_]=(0,r.useState)("overview"),[k,S]=(0,r.useState)("30d"),[R,F]=(0,r.useState)([]);(0,r.useEffect)(()=>{N(),(async()=>{try{let e=await Q.portfoliosApi.list();F(e.portfolios)}catch(e){console.error("Failed to fetch portfolios:",e)}})()},[i,u,N]);let P=h?.performance_by_asset?.map(e=>({name:e.asset_type,value:e.value,percentage:(e.value/(h?.total_value||1)*100).toFixed(1)}))||[],M=h?.performance_by_asset?.map(e=>({symbol:e.asset_type,return:e.return,current_value:e.value}))||[],V=[{symbol:"AAPL",name:"Apple Inc.",weight:15.2,return:18.5,contribution:2.81,value:15200,sector:"Technology"},{symbol:"MSFT",name:"Microsoft Corp.",weight:14.8,return:22.3,contribution:3.3,value:14800,sector:"Technology"},{symbol:"GOOGL",name:"Alphabet Inc.",weight:12.5,return:15.2,contribution:1.9,value:12500,sector:"Technology"},{symbol:"AMZN",name:"Amazon.com Inc.",weight:10.3,return:28.7,contribution:2.96,value:10300,sector:"Consumer"},{symbol:"NVDA",name:"NVIDIA Corp.",weight:8.7,return:45.2,contribution:3.93,value:8700,sector:"Technology"},{symbol:"JPM",name:"JPMorgan Chase",weight:6.5,return:12.3,contribution:.8,value:6500,sector:"Finance"},{symbol:"V",name:"Visa Inc.",weight:5.8,return:8.5,contribution:.49,value:5800,sector:"Finance"},{symbol:"JNJ",name:"Johnson & Johnson",weight:5.2,return:-2.3,contribution:-.12,value:5200,sector:"Healthcare"},{symbol:"WMT",name:"Walmart Inc.",weight:4.8,return:15.8,contribution:.76,value:4800,sector:"Consumer"},{symbol:"XOM",name:"Exxon Mobil",weight:4.2,return:-8.5,contribution:-.36,value:4200,sector:"Energy"}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Portfolio Analytics"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Detailed portfolio performance analysis"})]}),(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,t.jsx)(et,{selectedPortfolioId:e,onSelectPortfolio:b}),(0,t.jsxs)(a.Button,{variant:"outline",onClick:N,disabled:p,children:[(0,t.jsx)(o.RefreshCw,{className:(0,I.cn)("w-4 h-4 mr-2",p&&"animate-spin")}),"Refresh"]}),(0,t.jsxs)(Z.DropdownMenu,{children:[(0,t.jsx)(Z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{variant:"outline",disabled:!h||p,children:[(0,t.jsx)(c.Download,{className:"w-4 h-4 mr-2"}),"Export"]})}),(0,t.jsxs)(Z.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(Z.DropdownMenuItem,{onClick:()=>{h&&eV(h,{format:"json",period:i})},children:[(0,t.jsx)(d.FileJson,{className:"w-4 h-4 mr-2"}),"Export as JSON"]}),(0,t.jsxs)(Z.DropdownMenuItem,{onClick:()=>{h&&eV(h,{format:"csv",period:i})},children:[(0,t.jsx)(m.FileSpreadsheet,{className:"w-4 h-4 mr-2"}),"Export as CSV"]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap items-center",children:[e$.map(e=>(0,t.jsx)(a.Button,{variant:i===e.value?"default":"outline",size:"sm",onClick:()=>y(e.value),disabled:p,children:e.label},e.value)),(0,t.jsx)("div",{className:"w-px h-6 bg-border mx-2"}),(0,t.jsx)("select",{value:u,onChange:e=>v(e.target.value),className:"px-3 py-1 border rounded-md text-sm",disabled:p,children:eI.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),g&&(0,t.jsxs)("div",{className:"bg-destructive/10 text-destructive p-4 rounded-lg",children:[(0,t.jsx)("p",{className:"font-semibold",children:"Error"}),(0,t.jsx)("p",{children:g})]}),p?(0,t.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsx)(l.Skeleton,{className:"h-6 w-32"})}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)(l.Skeleton,{className:"h-12"})})]},e))}):h?(0,t.jsxs)(n.Tabs,{value:w,onValueChange:e=>_(e),className:"space-y-6",children:[(0,t.jsxs)(n.TabsList,{className:"grid w-full grid-cols-5",children:[(0,t.jsx)(n.TabsTrigger,{value:"overview",children:"Overview"}),(0,t.jsx)(n.TabsTrigger,{value:"performance",children:"Performance"}),(0,t.jsx)(n.TabsTrigger,{value:"risk",children:"Risk"}),(0,t.jsx)(n.TabsTrigger,{value:"attribution",children:"Attribution"}),(0,t.jsx)(n.TabsTrigger,{value:"comparison",children:"Comparison"})]}),(0,t.jsxs)(n.TabsContent,{value:"overview",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsx)(E,{value:h.performance?.total_return_percent||0}),(0,t.jsx)(L,{value:h.summary?.total_value||0,change:h.summary?.total_pnl}),(0,t.jsx)(Y,{cagr:h.performance?.cagr||0,annualizedReturn:h.performance?.annualized_return||0}),(0,t.jsx)(G,{maxDrawdown:h.performance?.max_drawdown_percent||0,maxDrawdownDate:h.performance?.max_drawdown_date||void 0,recoveryTime:h.performance?.recovery_time||void 0})]}),(0,t.jsx)(K,{volatility:h.risk_metrics.volatility,beta:h.risk_metrics.beta,sharpeRatio:h.risk_metrics.sharpe_ratio}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsx)(x,{title:"Asset Allocation",description:"Portfolio distribution by asset type",children:(0,t.jsx)(j,{data:P})}),(0,t.jsx)(x,{title:"Performance by Asset",description:"Return breakdown by asset",children:(0,t.jsx)(C,{data:M})})]})]}),(0,t.jsxs)(n.TabsContent,{value:"performance",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsx)(x,{title:"Rolling Returns",description:"7-day, 30-day, and 90-day rolling returns",children:(0,t.jsx)(B,{data:[{date:"2024-01-01","7d":2.5,"30d":8.2,"90d":15.5},{date:"2024-01-02","7d":2.8,"30d":8.5,"90d":15.8},{date:"2024-01-03","7d":3.1,"30d":8.8,"90d":16},{date:"2024-01-04","7d":2.9,"30d":8.6,"90d":15.7},{date:"2024-01-05","7d":3.2,"30d":9,"90d":16.2},{date:"2024-01-06","7d":3.5,"30d":9.2,"90d":16.5},{date:"2024-01-07","7d":3.3,"30d":9.1,"90d":16.3}],selectedPeriod:k,onPeriodChange:S})}),(0,t.jsx)(x,{title:"Performance Attribution",description:"Sector contribution to returns",children:(0,t.jsx)(D,{data:[{symbol:"Technology",contribution:2.5,value:45e3},{symbol:"Healthcare",contribution:1.2,value:28e3},{symbol:"Finance",contribution:.8,value:22e3},{symbol:"Consumer",contribution:.5,value:18e3},{symbol:"Energy",contribution:-.3,value:12e3}]})})]}),(0,t.jsx)(eo,{holdings:V}),(0,t.jsx)(x,{title:"Benchmark Comparison",description:"Portfolio vs benchmark performance",children:(0,t.jsx)(T,{data:[{date:"2024-01-01",portfolio:0,benchmark:0},{date:"2024-01-02",portfolio:1.2,benchmark:.8},{date:"2024-01-03",portfolio:2.5,benchmark:1.5},{date:"2024-01-04",portfolio:1.8,benchmark:1.2},{date:"2024-01-05",portfolio:3.2,benchmark:2.1},{date:"2024-01-06",portfolio:4.1,benchmark:2.8},{date:"2024-01-07",portfolio:3.8,benchmark:2.5}]})})]}),(0,t.jsxs)(n.TabsContent,{value:"risk",className:"space-y-6",children:[(0,t.jsx)(K,{volatility:h.risk_metrics.volatility,beta:h.risk_metrics.beta,sharpeRatio:h.risk_metrics.sharpe_ratio}),(0,t.jsx)(x,{title:"Risk Metrics History",description:"Volatility and Sharpe ratio over time",children:(0,t.jsx)(A,{data:[{date:"2024-01-01",volatility:15,sharpeRatio:1.2},{date:"2024-01-02",volatility:16,sharpeRatio:1.1},{date:"2024-01-03",volatility:14,sharpeRatio:1.3},{date:"2024-01-04",volatility:15,sharpeRatio:1.2},{date:"2024-01-05",volatility:17,sharpeRatio:1},{date:"2024-01-06",volatility:16,sharpeRatio:1.1},{date:"2024-01-07",volatility:15,sharpeRatio:1.2}]})})]}),(0,t.jsx)(n.TabsContent,{value:"attribution",className:"space-y-6",children:(0,t.jsx)(eR,{holdings:V.map(t=>({id:t.symbol,portfolio_id:e||"",symbol:t.symbol,name:t.name,asset_class:"stocks",quantity:100,average_cost:t.value/(1+t.return/100),current_price:t.value/100,current_value:t.value,unrealized_pnl:t.value*t.return/100,unrealized_pnl_percent:t.return,day_change:0,day_change_percent:0,weight:t.weight,sector:t.sector,exchange:"",currency:"USD",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),loading:p,initialBenchmark:"sp500"})}),(0,t.jsxs)(n.TabsContent,{value:"comparison",className:"space-y-6",children:[(0,t.jsx)(ea,{portfolios:R.map(e=>({id:e.id,name:e.name,return:e.total_pnl_percent,volatility:15,sharpeRatio:1.2,maxDrawdown:5})),selectedId:e||"",onSelect:b}),(0,t.jsx)(x,{title:"Sector Breakdown",description:"Performance by economic sector",children:(0,t.jsx)(z,{data:[{name:"Technology",value:45e3,percentage:35.5,return:12.5},{name:"Healthcare",value:28e3,percentage:22.1,return:8.2},{name:"Finance",value:22e3,percentage:17.3,return:6.5},{name:"Consumer",value:18e3,percentage:14.2,return:4.8},{name:"Energy",value:12e3,percentage:10.9,return:-2.3}]})})]})]}):(0,t.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:(0,t.jsx)("p",{children:"No analytics data available. Select a portfolio to view analytics."})})]})}function eH(){return(0,t.jsx)(i.PageErrorBoundary,{onError:(e,t)=>{console.error("Analytics page error:",e,t)},children:(0,t.jsx)(eE,{})})}e.s(["default",()=>eH],76965)}]);